<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><link rel=manifest href=/manifest.json><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>博客笔记 | Shelter</title><meta name="author" content="Shelter"><meta name="copyright" content="Shelter"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="live2d对于live2d，ai告诉我一个比原版更聪明的看板娘，安装方法是： 方案二：利用 Butterfly 的 inject 功能（最优雅） Butterfly 专门提供了一个 inject 配置项，允许你把代码插入到页面的特定位置，而不用去翻找复杂的 HTML 文件。  打开 _config.butterfly.yml。 找到 inject: 部分，在 bottom: 下面添加那行脚本：">
<meta property="og:type" content="article">
<meta property="og:title" content="博客笔记">
<meta property="og:url" content="http://localhost:4000/posts/eedaddf.html">
<meta property="og:site_name" content="Shelter">
<meta property="og:description" content="live2d对于live2d，ai告诉我一个比原版更聪明的看板娘，安装方法是： 方案二：利用 Butterfly 的 inject 功能（最优雅） Butterfly 专门提供了一个 inject 配置项，允许你把代码插入到页面的特定位置，而不用去翻找复杂的 HTML 文件。  打开 _config.butterfly.yml。 找到 inject: 部分，在 bottom: 下面添加那行脚本：">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.dreamshelter.cn/blog/source/img/cover/12.jpg">
<meta property="article:published_time" content="2026-02-03T02:50:00.000Z">
<meta property="article:modified_time" content="2026-02-11T17:39:39.522Z">
<meta property="article:author" content="Shelter">
<meta property="article:tag" content="Hexo">
<meta property="article:tag" content="博客">
<meta property="article:tag" content="教程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.dreamshelter.cn/blog/source/img/cover/12.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "博客笔记",
  "url": "http://localhost:4000/posts/eedaddf.html",
  "image": "https://cdn.dreamshelter.cn/blog/source/img/cover/12.jpg",
  "datePublished": "2026-02-03T02:50:00.000Z",
  "dateModified": "2026-02-11T17:39:39.522Z",
  "author": [
    {
      "@type": "Person",
      "name": "Shelter",
      "url": "https://github.com/Shelter67"
    }
  ]
}</script><link rel="shortcut icon" href="https://cdn.dreamshelter.cn/blog/source/img/favicon.png"><link rel="canonical" href="http://localhost:4000/posts/eedaddf.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#49b1f5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/128.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="mask-icon" href="/img/siteicon/128.png" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":3,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '博客笔记',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><style>#waifu { left: auto !important; right: 20px !important; }</style><!-- hexo injector head_end start --><link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/clock-min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.1"></head><body><div class="bg-animation" id="web_bg" style="background-image: url(https://cdn.dreamshelter.cn/blog/source/img/background.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/touxiang.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuifan.html"><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuiju.html"><i class="fa-fw fas fa-video"></i><span> 追剧</span></a></div><div class="menus_item"><a class="site-page" href="/gongxianban"><i class="fa-fw fab fa-github-alt"></i><span> 贡献板</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.dreamshelter.cn/blog/source/img/cover/12.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Shelter</span></a><a class="nav-page-title" href="/"><span class="site-name">博客笔记</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuifan.html"><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuiju.html"><i class="fa-fw fas fa-video"></i><span> 追剧</span></a></div><div class="menus_item"><a class="site-page" href="/gongxianban"><i class="fa-fw fab fa-github-alt"></i><span> 贡献板</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">博客笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-11T17:39:39.522Z" title="更新于 2026-02-12 01:39:39">2026-02-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">9.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>46分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2026-02-12 01:39:39&quot;}" hidden></div><h1 id="live2d"><a href="#live2d" class="headerlink" title="live2d"></a>live2d</h1><p>对于live2d，ai告诉我一个比原版更聪明的看板娘，安装方法是：</p>
<p>方案二：利用 Butterfly 的 <code>inject</code> 功能（最优雅）</p>
<p>Butterfly 专门提供了一个 <code>inject</code> 配置项，允许你把代码插入到页面的特定位置，而不用去翻找复杂的 HTML 文件。</p>
<ol>
<li>打开 <strong><code>_config.butterfly.yml</code></strong>。</li>
<li>找到 <code>inject:</code> 部分，在 <code>bottom:</code> 下面添加那行脚本：</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># 可以在这里加 CSS</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="看板娘"><a href="#看板娘" class="headerlink" title="看板娘"></a>看板娘</h1><p>看板娘的这个我应该怎么变成右下角固定  </p>
<p>如果你使用的是这个 <code>autoload.js</code> 脚本，它默认通常会出现在左下角。要将其固定到<strong>右下角</strong>，最直接的方法是通过 <strong>CSS 覆盖</strong>。</p>
<p>由于这个脚本在运行时会自动往页面注入一个 ID 为 <code>waifu</code>（或者类似的容器）的 HTML 元素，我们可以直接在 Hexo 中添加样式来强制改变它的位置。</p>
<p>方案一：通过 Butterfly 的 Inject 功能（最推荐）</p>
<p>不需要改动 JS 脚本，直接在 <code>_config.butterfly.yml</code> 中添加一行 CSS 注入即可：</p>
<ol>
<li>打开 <strong><code>_config.butterfly.yml</code></strong>。</li>
<li>找到 <code>inject</code> -&gt; <code>head</code> 部分。</li>
<li>添加以下代码：</li>
</ol>
<p>YAML</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">    - &lt;style&gt;#waifu &#123; left: auto !important; right: 0 !important; &#125;&lt;/style&gt;</span><br><span class="line">  bottom:</span><br><span class="line">    - &lt;script src=&quot;https://fastly.jsdelivr.net/npm/live2d-widgets@1.0.0/dist/autoload.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><strong>代码解释：</strong></p>
<ul>
<li><code>left: auto !important;</code>：取消默认的左侧定位。</li>
<li><code>right: 0 !important;</code>：将其固定到右侧。你可以把 <code>0</code> 改成 <code>20px</code> 让它离边缘有一点距离。</li>
</ul>
<hr>
<p>方案二：如果你使用的是本地文件</p>
<p>如果你已经把 <code>waifu.css</code> 下载到了本地（例如放在 <code>source/live2d-widget/waifu.css</code>）：</p>
<ol>
<li><p>打开该 <strong><code>waifu.css</code></strong> 文件。</p>
</li>
<li><p>搜索 <code>#waifu</code>。</p>
</li>
<li><p>将其中的 <code>left: 0;</code> 修改为：</p>
<p>CSS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#waifu &#123;</span><br><span class="line">    right: 20px; /* 距离右边 20 像素 */</span><br><span class="line">    bottom: 0;</span><br><span class="line">    /* 确保没有 left 属性，如果有，请删掉或改为 left: auto; */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<p>方案三：针对不同插件容器名的通用补救</p>
<p>如果你发现上面的 <code>#waifu</code> 没起作用，说明你这个版本的插件可能用了不同的 ID。你可以按以下步骤查找：</p>
<ol>
<li>在浏览器打开你的博客，按 <strong>F12</strong> 打开开发者工具。</li>
<li>点击左上角的“小箭头”图标，去页面上点击那个看板娘。</li>
<li>查看右侧面板中该元素的 <code>id</code> 是什么（可能是 <code>landlord</code> 或 <code>live2d-widget</code>）。</li>
<li>将方案一代码中的 <code>#waifu</code> 替换为那个 ID 即可。</li>
</ol>
<hr>
<p>⚠️ 可能存在的冲突</p>
<p>由于你在右下角可能还有：</p>
<ol>
<li><strong>Butterfly 的“回到顶部”按钮</strong>。</li>
<li><strong>APlayer 播放器</strong>（如果你也把它设在了右边）。</li>
</ol>
<p><strong>建议：</strong> 如果右下角太挤了，你可以微调位置，比如： <code>right: 50px !important; bottom: 20px !important;</code> 这样看板娘会往左边和上方挪一点，避免挡住功能按钮。</p>
<p><strong>改完后记得执行 <code>hexo clean</code> 和 <code>hexo g</code>。看板娘现在成功“瞬移”到右边了吗？</strong></p>
<h1 id="pwa"><a href="#pwa" class="headerlink" title="pwa"></a>pwa</h1><p>安装完后右上角会有个安装按钮，可以离线看博客，然后有缓存可以加快访问速度，右上角会有个通知博客更新</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">npm install --global gulp-cli #全局安装gulp命令集</span><br><span class="line">npm install workbox-build gulp --save#安装workbox和gulp扬件</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">压缩html插件</span></span><br><span class="line">npm install gulp-htmlclean --save-dev</span><br><span class="line">npm install --save gulp-htmlmin</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">压缩css播件</span></span><br><span class="line">npm install gulp-clean-css --save-dev</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">压缩js播件</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使用babel压缩js，与terser二选一</span></span><br><span class="line">npm install --save-dev gulpuglify</span><br><span class="line">npm install --save-dev gulp-babel @babel/core @babel/preset-env</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使用terser压缩js，与babel二选一（推荐）</span></span><br><span class="line">npm install gulp-terser --save-dev</span><br><span class="line">npm install --save-dev gulp-babel @babel/core @babel/preset-env</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩图片播件（没啥用）</span></span><br><span class="line">npm install --save-dev gulp-imagcmin</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">压缩字体播件(font-min仅支持压缩ttf格式的字体包)</span></span><br><span class="line">npm install gulp-fontmin --save-dev</span><br></pre></td></tr></table></figure>

<p>关于font-min的补充说明，在本文中，是通过读取所有编译好的html文件(.&#x2F;public&#x2F;“.html)中的字符，然后匹配原有字体包内.&#x2F;public&#x2F;fonts&#x2F;.ttf字体样式，输出压缩后的字体包到 &#x2F;public&#x2F;fontsdest&#x2F;目录。所以最终引用字体的相对路径应读是&#x2F;fontsdes&#x2F;.ttf。而本地测试时，如果没有运行gulp，自然也就不会输出压缩字体包到public目录，也就看不到字体样式。</p>
<p>julp-terser只会直接压缩js代码，所以不存在因为语法变动导致的错误。事实上，当我们使用jsdelivr的CDN服务时，只需要在css或者js的后级前添加加.min,例如example.js-&gt;example.min.js,JsDelivr就会自动使用terser帮我们压缩好代码,</p>
<p>在package.json添加</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;module&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>创建gulpfile.js，在hexo的根目录创建这个文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gulp <span class="keyword">from</span> <span class="string">&#x27;gulp&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> cleanCSS <span class="keyword">from</span> <span class="string">&#x27;gulp-clean-css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> htmlmin <span class="keyword">from</span> <span class="string">&#x27;gulp-htmlmin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> htmlclean <span class="keyword">from</span> <span class="string">&#x27;gulp-htmlclean&#x27;</span>;</span><br><span class="line"><span class="comment">// import imagemin from &#x27;gulp-imagemin&#x27;;</span></span><br><span class="line"><span class="keyword">import</span> workbox <span class="keyword">from</span> <span class="string">&#x27;workbox-build&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> fontmin <span class="keyword">from</span> <span class="string">&#x27;gulp-fontmin&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//若使用babel压缩js，则取消下方注释，并注释terser的代码</span></span><br><span class="line"><span class="comment">// var uglify = require(&#x27;gulp-uglify&#x27;);</span></span><br><span class="line"><span class="comment">// var babel = require(&#x27;gulp-babel&#x27;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//若使用terser压缩js</span></span><br><span class="line"><span class="keyword">import</span> terser <span class="keyword">from</span> <span class="string">&#x27;gulp-terser&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//pwa</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;generate-service-worker&#x27;</span>, <span class="function">()=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> workbox.<span class="title function_">injectManifest</span>(&#123;</span><br><span class="line">        <span class="attr">swSrc</span>: <span class="string">&#x27;./sw-template.js&#x27;</span>,</span><br><span class="line">        <span class="attr">swDest</span>: <span class="string">&#x27;./public/sw.js&#x27;</span>,</span><br><span class="line">        <span class="attr">globDirectory</span>: <span class="string">&#x27;./public&#x27;</span>,</span><br><span class="line">        <span class="attr">globPatterns</span>: [</span><br><span class="line">            <span class="comment">// 缓存所有以下类型的文件，极端不推荐</span></span><br><span class="line">            <span class="comment">// &quot;**/*.&#123;html,css,js,json,woff2,xml&#125;&#x27;</span></span><br><span class="line">            <span class="comment">// 推荐只缓存404，主页和主要样式和脚本，</span></span><br><span class="line">            <span class="string">&#x27;404.html&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;js/main.js&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;css/index.css&#x27;</span>,</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">modifyURLPrefix</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;&#x27;</span>: <span class="string">&#x27;./&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//minify js babel</span></span><br><span class="line"><span class="comment">// 若使用babel压缩js，取消下方注释，并注释terser的代码</span></span><br><span class="line"><span class="comment">// gulp.task(&#x27;compress&#x27;,()=&gt;</span></span><br><span class="line"><span class="comment">// gulp.src([&#x27;./public/**/*.js&#x27;,&#x27;!./public/*e*/*.min.js&#x27;)</span></span><br><span class="line"><span class="comment">// .pipe(babel(&#123;</span></span><br><span class="line"><span class="comment">// 888888963</span></span><br><span class="line"><span class="comment">// presets: [&#x27;@babel/preset-env&#x27;]</span></span><br><span class="line"><span class="comment">// &#125;))</span></span><br><span class="line"><span class="comment">// .pipe(uglify().on(&#x27;error&#x27;, function(e)&#123;</span></span><br><span class="line"><span class="comment">// console.log(e);</span></span><br><span class="line"><span class="comment">// &#125;))</span></span><br><span class="line"><span class="comment">// .pipe(gulp.dest(&#x27;./public&#x27;))</span></span><br><span class="line"><span class="comment">// );</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// minify js - gulp-tester</span></span><br><span class="line"><span class="comment">// 若使用terser压编js</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;compress&#x27;</span>, <span class="function">()=&gt;</span></span><br><span class="line">    gulp</span><br><span class="line">        .<span class="title function_">src</span>([</span><br><span class="line">            <span class="string">&#x27;./public/**/*.js&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;!./public/**/*.min.js&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;!./public/js/custom/galmenu.js&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;!./public/js/custom/gitcalendar.js&#x27;</span>,</span><br><span class="line">        ])</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">terser</span>())</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>))</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">//css</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-css&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp</span><br><span class="line">        .<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.css&#x27;</span>)</span><br><span class="line">        .<span class="title function_">pipe</span>(</span><br><span class="line">            <span class="title function_">cleanCSS</span>(&#123;</span><br><span class="line">                <span class="attr">compatibility</span>: <span class="string">&#x27;ie11&#x27;</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">        )</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//压缩字体</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">minifyFont</span>(<span class="params">text, cb</span>) &#123;</span><br><span class="line">    gulp</span><br><span class="line">        .<span class="title function_">src</span>(<span class="string">&#x27;./public/fonts/*.ttf&#x27;</span>)<span class="comment">//原字体所在目录</span></span><br><span class="line">        .<span class="title function_">pipe</span>(</span><br><span class="line">            <span class="title function_">fontmin</span>(&#123;</span><br><span class="line">                <span class="attr">text</span>: text,</span><br><span class="line">            &#125;)</span><br><span class="line">        )</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public/fonts/&#x27;</span>))<span class="comment">//压缩后的输出目录</span></span><br><span class="line">        .<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, cb);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;mini-font&#x27;</span>, <span class="function"><span class="params">cb</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> buffers = [];</span><br><span class="line">    gulp</span><br><span class="line">        .<span class="title function_">src</span>([<span class="string">&#x27;./public/**/*.html&#x27;</span>])<span class="comment">//HTML文件所在目录请根据自身情况修改</span></span><br><span class="line">        .<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="keyword">function</span> (<span class="params">file</span>)&#123;</span><br><span class="line">            <span class="comment">// 将读取到的 HTML 文件内容存入数组</span></span><br><span class="line">            buffers.<span class="title function_">push</span>(file.<span class="property">contents</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// 1. 将所有 HTML 的 Buffer 合并，并转为字符串</span></span><br><span class="line">            <span class="keyword">var</span> text = <span class="title class_">Buffer</span>.<span class="title function_">concat</span>(buffers).<span class="title function_">toString</span>(<span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 2. 这里的逻辑是安知鱼/大部分教程的思路：</span></span><br><span class="line">            <span class="comment">// 将全站文字进行去重处理，减少 fontmin 的负担</span></span><br><span class="line">            <span class="keyword">var</span> uniqueText = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; text.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (uniqueText.<span class="title function_">indexOf</span>(text[i]) === -<span class="number">1</span>) &#123;</span><br><span class="line">                    uniqueText += text[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 3. 调用上面定义的压缩函数，传入提取到的“字符全集”</span></span><br><span class="line">            <span class="title function_">minifyFont</span>(uniqueText, cb);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压缩 public 目录内 html</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-html&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp</span><br><span class="line">        .<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.html&#x27;</span>)</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">htmlclean</span>())</span><br><span class="line">        .<span class="title function_">pipe</span>(</span><br><span class="line">            <span class="title function_">htmlmin</span>(&#123;</span><br><span class="line">                <span class="attr">removeComments</span>:<span class="literal">true</span>,<span class="comment">//清除 HTML 註释</span></span><br><span class="line">                <span class="attr">collapseWhitespace</span>:<span class="literal">true</span>,<span class="comment">//压缩HTML</span></span><br><span class="line">                <span class="attr">collapseBooleanAttributes</span>: <span class="literal">true</span>,<span class="comment">//省略布尔属性的值 &lt;input checked=&quot;true&quot;/&gt; ==&gt; &lt;input /&gt;</span></span><br><span class="line">                <span class="attr">removeEmptyAttributes</span>:<span class="literal">true</span>,<span class="comment">//删除所有空格作属性值&lt;input id=&quot;&quot;/&gt;==&gt; &lt;input /&gt;</span></span><br><span class="line">                <span class="attr">removeScriptTypeAttributes</span>: <span class="literal">true</span>,<span class="comment">//删除 &lt;script&gt;的 type=&quot;text/javascript&quot;</span></span><br><span class="line">                <span class="attr">removeStyleLinkTypeAttributes</span>: <span class="literal">true</span>, <span class="comment">//删除 &lt;style&gt;和&lt;Link&gt; 的 ype=&quot;text/css&quot;</span></span><br><span class="line">                <span class="attr">minifyJS</span>: <span class="literal">true</span>,<span class="comment">//压缩页面 JS</span></span><br><span class="line">                <span class="attr">minifyCSS</span>: <span class="literal">true</span>,<span class="comment">//压缩页面CS5</span></span><br><span class="line">                <span class="attr">minifyURLs</span>: <span class="literal">true</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">        )</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 压缩 public/uploads 目录内图片</span></span><br><span class="line"><span class="comment">// gulp.task(&#x27;minify-images&#x27;, async() =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     gulp</span></span><br><span class="line"><span class="comment">//         .src(&#x27;./public/img/**/*.*&#x27;)</span></span><br><span class="line"><span class="comment">//         .pipe(</span></span><br><span class="line"><span class="comment">//             imagemin(&#123;</span></span><br><span class="line"><span class="comment">//             optimizationLevel: 5,//类型:Number  预设: 3 取值範围:0-7(优化等级)</span></span><br><span class="line"><span class="comment">//             progressive: true,//类型:Boolean    预设:   false无失真压缩jpg图片</span></span><br><span class="line"><span class="comment">//             interlaced: false,//类型:Boolean 预设:   false 隔行扫描gif进行渲染</span></span><br><span class="line"><span class="comment">//             multipass: false,//类型:Boolean 预设:   false 多次优化svg直到完全优化</span></span><br><span class="line"><span class="comment">//             &#125;)</span></span><br><span class="line"><span class="comment">//         )</span></span><br><span class="line"><span class="comment">//         .pipe(gulp.dest(&#x27;./public/img&#x27;));</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//执行 gulp 命令时执行的任务</span></span><br><span class="line">gulp.<span class="title function_">task</span>(</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>,</span><br><span class="line">    gulp.<span class="title function_">series</span>(</span><br><span class="line">        <span class="string">&#x27;generate-service-worker&#x27;</span>,</span><br><span class="line">        gulp.<span class="title function_">parallel</span>(<span class="string">&#x27;compress&#x27;</span>, <span class="string">&#x27;minify-html&#x27;</span>, <span class="string">&#x27;minify-css&#x27;</span>, <span class="string">&#x27;mini-font&#x27;</span>))</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>创建sw-template.js文件，然后输入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> workboxVersion = <span class="string">&#x27;5.1.3&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入 Workbox</span></span><br><span class="line"><span class="title function_">importScripts</span>(<span class="string">`https://storage.googleapis.com/workbox-cdn/releases/<span class="subst">$&#123;workboxVersion&#125;</span>/workbox-sw.js`</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置缓存名称前缀</span></span><br><span class="line">workbox.<span class="property">core</span>.<span class="title function_">setCacheNameDetails</span>(&#123;</span><br><span class="line">  <span class="attr">prefix</span>:<span class="string">&#x27;shelter&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 强制等待激活与更新</span></span><br><span class="line">workbox.<span class="property">core</span>.<span class="title function_">skipWaiting</span>();</span><br><span class="line">workbox.<span class="property">core</span>.<span class="title function_">clientsClaim</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册成功后要立即缓存的资源列表</span></span><br><span class="line"><span class="comment">// 具体缓存列表在gulpfile.js中配置，见下文</span></span><br><span class="line">workbox.<span class="property">precaching</span>.<span class="title function_">precacheAndRoute</span>(self.<span class="property">__WB_MANIFEST</span>,&#123;</span><br><span class="line">  <span class="attr">directoryIndex</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清空过期缓存</span></span><br><span class="line">workbox.<span class="property">precaching</span>.<span class="title function_">cleanupOutdatedCaches</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 字体缓存 (修复了你代码中的正则错误)</span></span><br><span class="line">workbox.<span class="property">routing</span>.<span class="title function_">registerRoute</span>(</span><br><span class="line">  <span class="regexp">/\.(?:eot|ttf|woff|woff2)$/</span>,</span><br><span class="line">  <span class="keyword">new</span> workbox.<span class="property">strategies</span>.<span class="title class_">CacheFirst</span>(&#123;</span><br><span class="line">    <span class="attr">cacheName</span>: <span class="string">&#x27;fonts&#x27;</span>,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">      <span class="keyword">new</span> workbox.<span class="property">expiration</span>.<span class="title class_">ExpirationPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">maxEntries</span>: <span class="number">1000</span>,</span><br><span class="line">        <span class="attr">maxAgeSeconds</span>: <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span>, <span class="comment">// 缓存 30 天</span></span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="keyword">new</span> workbox.<span class="property">cacheableResponse</span>.<span class="title class_">CacheableResponsePlugin</span>(&#123;</span><br><span class="line">        <span class="attr">statuses</span>: [<span class="number">0</span>, <span class="number">200</span>],</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 图片缓存 (安知鱼博客通常包含大量图片)</span></span><br><span class="line">workbox.<span class="property">routing</span>.<span class="title function_">registerRoute</span>(</span><br><span class="line">  <span class="regexp">/\.(?:png|jpg|jpeg|svg|gif|webp)$/</span>,</span><br><span class="line">  <span class="keyword">new</span> workbox.<span class="property">strategies</span>.<span class="title class_">StaleWhileRevalidate</span>(&#123;</span><br><span class="line">    <span class="attr">cacheName</span>: <span class="string">&#x27;images&#x27;</span>,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">      <span class="keyword">new</span> workbox.<span class="property">expiration</span>.<span class="title class_">ExpirationPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">maxEntries</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">maxAgeSeconds</span>: <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 谷歌字体缓存</span></span><br><span class="line">workbox.<span class="property">routing</span>.<span class="title function_">registerRoute</span>(</span><br><span class="line">  <span class="regexp">/^https:\/\/fonts\.googleapis\.com/</span>,</span><br><span class="line">  <span class="keyword">new</span> workbox.<span class="property">strategies</span>.<span class="title class_">StaleWhileRevalidate</span>(&#123;</span><br><span class="line">    <span class="attr">cacheName</span>: <span class="string">&#x27;google-fonts-stylesheets&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 谷歌统计 (如果你使用了 Google Analytics)</span></span><br><span class="line">workbox.<span class="property">googleAnalytics</span>.<span class="title function_">initialize</span>();</span><br></pre></td></tr></table></figure>

<p>在[Blogroot]\themes\butterfly\layout\includes\third-party\目录下新建pwanotice.pug文件，打开 [Blogroot]\themes\butterfly\layout\includes\third-party\pwanotice.pug ,输入:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#app-refresh(style=&#x27;position: fixed; top: -2.2rem; left: 0; right: 0; z-index: 99999; padding: 0 1rem; font-size: 15px; height: 2.2rem; transition: all 0.3s ease;&#x27;)</span><br><span class="line">  .app-refresh-wrap(style=&#x27;display: flex; color: #fff; height: 100%; align-items: center; justify-content: center;&#x27;)</span><br><span class="line">    label 🚀 有新内容发布啦！</span><br><span class="line">    a(href=&#x27;javascript:void(0)&#x27; onclick=&#x27;location.reload()&#x27;)</span><br><span class="line">      span(style=&#x27;color: #fff; text-decoration: underline; cursor: pointer; margin-left: 8px;&#x27;) 点击刷新</span><br><span class="line">script.</span><br><span class="line">  if (&#x27;serviceWorker&#x27; in navigator) &#123;</span><br><span class="line">    // 如果当前页面受 Service Worker 控制，监听控制权变化</span><br><span class="line">    if (navigator.serviceWorker.controller) &#123;</span><br><span class="line">      navigator.serviceWorker.addEventListener(&#x27;controllerchange&#x27;, function() &#123;</span><br><span class="line">        showNotification();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 页面加载完成后注册 sw.js</span><br><span class="line">    window.addEventListener(&#x27;load&#x27;, function() &#123;</span><br><span class="line">      navigator.serviceWorker.register(&#x27;/sw.js&#x27;).catch(err =&gt; &#123;</span><br><span class="line">        console.error(&#x27;PWA 注册失败:&#x27;, err);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function showNotification() &#123;</span><br><span class="line">    // 优先使用主题自带的 Snackbar 弹窗</span><br><span class="line">    if (window.GLOBAL_CONFIG &amp;&amp; GLOBAL_CONFIG.Snackbar) &#123;</span><br><span class="line">      var snackbarBg = document.documentElement.getAttribute(&#x27;data-theme&#x27;) === &#x27;light&#x27; ?</span><br><span class="line">        GLOBAL_CONFIG.Snackbar.bgLight :</span><br><span class="line">        GLOBAL_CONFIG.Snackbar.bgDark;</span><br><span class="line">      </span><br><span class="line">      var snackbarPos = GLOBAL_CONFIG.Snackbar.position;</span><br><span class="line"></span><br><span class="line">      Snackbar.show(&#123;</span><br><span class="line">        text: &#x27;🚀 有新文章发布啦！&#x27;,</span><br><span class="line">        backgroundColor: snackbarBg,</span><br><span class="line">        duration: 10000, // 持续 10 秒</span><br><span class="line">        pos: snackbarPos,</span><br><span class="line">        actionText: &#x27;点击刷新&#x27;,</span><br><span class="line">        actionTextColor: &#x27;#fff&#x27;,</span><br><span class="line">        onActionClick: function(e) &#123;</span><br><span class="line">          location.reload();</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      // 如果没有 Snackbar，则显示顶部的 app-refresh 栏</span><br><span class="line">      var showBg = document.documentElement.getAttribute(&#x27;data-theme&#x27;) === &#x27;light&#x27; ? &#x27;#49b1f5&#x27; : &#x27;#1f1f1f&#x27;;</span><br><span class="line">      var appRefresh = document.getElementById(&#x27;app-refresh&#x27;);</span><br><span class="line">      if (appRefresh) &#123;</span><br><span class="line">        appRefresh.style.cssText = &#x27;top: 0; background: &#x27; + showBg + &#x27;;&#x27;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>修改[Blogroot]\themes\butterfly\layout\includes\additional-js.pug<br>,在文件底部添加以下内容，注意缩进。 butterfly_v3.6.0取消了缓存配置，转为完全默认，需要将{cache:theme.fragment_cache} 改为{cache: true}，现在使用的是高版本，使用最后两行就行，注意pug是严格缩进模式，第一行一定是一个空格，第二行两个</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if theme.pjax.enable</span><br><span class="line">	!=partial(&#x27;includes/third-party/pjax&#x27;,&#123;&#125;,&#123;cache:theme.fragment_cache&#125;)</span><br><span class="line"><span class="addition">!=partial(&#x27;includes/third-party/baidu_push&#x27;, &#123;&#125;,&#123;cache:theme.fragment_cache&#125;)</span></span><br><span class="line">  if theme.pwa.enable</span><br><span class="line">    != partial(&#x27;includes/third-party/pwanotice&#x27;, &#123;&#125; , &#123;cache: true&#125;)</span><br></pre></td></tr></table></figure>

<p>将你的图标包移入相应的目录，例如我是(img&#x2F;siteicon&#x2F;，所以放到[Blogroot]&#x2F;source&#x2F;img&#x2F;siteicon&#x2F;目录下。没有的话新建，site icon就是站点图标，可以去阿里的iconfont网站找资源</p>
<p>新建文件名为 manifest.json 并将其放到 [Blogroot]&#x2F;source 目录下，此时还不能直接用，需要添加一些内容，以下是我的 manifest.json 配置内容，权且作为参考，其中的 theme_color 建议用取色器取设计的图标的主色调，同时务必配置 start_url和 name的配置项，这关系到你之后能否看到浏览器的应用安装按钮。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Shelter的博客&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;short_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Shelter&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;theme_color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#49b1f5&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;background _color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#49b1f5&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;display&quot;</span><span class="punctuation">:</span> <span class="string">&quot;standalone&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;start_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;icons&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span><span class="string">&quot;/img/siteicon/16.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16x16&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/32.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;32x32&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/img/siteicon/64.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;64x64&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span><span class="string">&quot;/img/siteicon/128.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span><span class="string">&quot;128x128&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span><span class="string">&quot;/img/siteicon/144.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span><span class="string">&quot;144x144&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;image/png&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span><span class="string">&quot;/img/siteicon/512.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span><span class="string">&quot;512x512&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;splash_pages&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>打开主题配置文件 [Blogroot]&#x2F;_config.butterfly.yml,找到 PWA 配置项。添加图标路径。这里的 theme_color，建议改成你图标的主色调，包括 manifest.json 中的 theme_color 也是如此。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pwa:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">manifest:</span> <span class="string">/manifest.json</span></span><br><span class="line">  <span class="attr">theme_color:</span> <span class="string">&quot;#49b1f5&quot;</span><span class="string">,</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">/img/siteicon/128.png</span></span><br><span class="line">  <span class="attr">favicon_32_32:</span> <span class="string">/img/siteicon/32/png</span></span><br><span class="line">  <span class="attr">favicon_16_16:</span> <span class="string">/img/siteicon/16.png</span></span><br><span class="line">  <span class="attr">mask_icon:</span> <span class="string">/img/siteicon/128.png</span></span><br></pre></td></tr></table></figure>

<h1 id="一图流"><a href="#一图流" class="headerlink" title="一图流"></a>一图流</h1><p>新建文件[Blogroot]&#x2F;source&#x2F;css&#x2F;custom.css在custom.css中填入以下内容</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* font-face &#123;</span></span><br><span class="line"><span class="comment">  font-family: Candyhome;</span></span><br><span class="line"><span class="comment">  src:url(https://cdn.cbd.int/anzhiyu-blog@latest/fonts/Candyhome.ttf);</span></span><br><span class="line"><span class="comment">  font-display: swap;</span></span><br><span class="line"><span class="comment">  font-weight: lighter;</span></span><br><span class="line"><span class="comment">&#125; */</span></span><br><span class="line"> <span class="comment">/* 谷歌字体 */</span></span><br><span class="line">  <span class="keyword">@import</span> url(<span class="attribute">https</span>://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&amp;display=swap);</span><br><span class="line">  <span class="keyword">@font-face</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: ZhuZiAYuanJWD;</span><br><span class="line">    <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/fonts/ZhuZiAWan.woff2&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;woff2&#x27;</span>);</span><br><span class="line">    <span class="attribute">font-display</span>: swap;</span><br><span class="line">    <span class="attribute">font-weight</span>: lighter;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 这里应该是站点最上面那个字体 */</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#menus</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>:<span class="string">&#x27;ZhuZiAYuanJWD&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">h1</span><span class="selector-id">#site-title</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: ZhuZiAYuanJWD;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">3em</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">a</span><span class="selector-class">.article-title</span>,</span><br><span class="line">  <span class="selector-tag">a</span><span class="selector-class">.blog-slider__title</span>,</span><br><span class="line">  <span class="selector-tag">a</span><span class="selector-class">.categoryBar-list-link</span>,</span><br><span class="line">  <span class="selector-tag">h1</span><span class="selector-class">.post-title</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: ZhuZiAYuanJWD; </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.iconfont</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>:<span class="string">&#x27;iconfont&#x27;</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">3em</span>;</span><br><span class="line">    <span class="comment">/*可以定义图标大小 */</span></span><br><span class="line">    <span class="attribute">font-style</span>: normal;</span><br><span class="line">    -webkit-<span class="attribute">font-smoothing</span>:antialiased;</span><br><span class="line">    -moz-osx-<span class="attribute">font-smoothing</span>:grayscale;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*时间轴生肖icon */</span></span><br><span class="line">  <span class="selector-tag">svg</span><span class="selector-class">.icon</span> &#123;</span><br><span class="line">    <span class="comment">/* 这里定义svg.icon，避免和Butterfly自带的note标签冲突 */</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">    <span class="comment">/* width和height定义图标的默认宽度和高度*/</span></span><br><span class="line">    <span class="attribute">vertical-align</span>:-<span class="number">0.15em</span>;</span><br><span class="line">    <span class="attribute">fill</span>: currentColor;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.icon-zhongbiao</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f7c768</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* bilibli番剧插件 */</span></span><br><span class="line">  <span class="selector-class">.bangumi-active</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="number">#dbecfe</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">a</span><span class="selector-class">.bangumi-tab</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.bangumi-button</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="number">#dbecfe</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">a</span><span class="selector-class">.bangumi-button</span><span class="selector-class">.bangumi-nextpage</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.bangumi-button</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">a</span><span class="selector-class">.bangumi-tab</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">svg</span><span class="selector-class">.icon</span><span class="selector-class">.faa-tada</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.1em</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 解决artitalk的图标问题 */</span></span><br><span class="line">  <span class="selector-id">#uploadSource</span> &gt; <span class="selector-tag">svg</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">1.19em</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1.5em</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*top-img黑色透明玻璃效果移除，不建议加，除非你执着于完全一图流或者背景图对比色明显 */</span></span><br><span class="line">  <span class="selector-id">#page-header</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.not-top-img</span>)<span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 首页文章卡片 */</span></span><br><span class="line">  <span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 首页侧栏卡片 */</span></span><br><span class="line">  <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 文章页面正文背景 **/</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#post</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*分页页面 */</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#page</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 归档页面 */</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#archive</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:■<span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 标签页面 */</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#tag</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*分类页面 */</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#category</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>:<span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*夜间模式伪类遮罩层透明*/</span></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span><span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#121212</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-class">.card-widget</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#121212</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#post</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#121212</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#tag</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#121212</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#archive</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#121212</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#page</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#121212</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#category</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#121212</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#category</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 页脚透明 */</span></span><br><span class="line">  <span class="selector-id">#footer</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 头图透明 */</span></span><br><span class="line">  <span class="selector-id">#page-header</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#rightside</span> &gt; <span class="selector-tag">div</span> &gt; <span class="selector-tag">button</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 滚动条的一些设置 */</span></span><br><span class="line">  ::-webkit-scrollbar &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">2em</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ::-webkit-scrollbar-corner &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: transparent;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ::-moz-selection &#123;</span><br><span class="line">    <span class="attribute">color</span>: ■<span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#49b1f5</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 音乐播放器 */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* .aplayer .aplayer-lrc &#123;</span></span><br><span class="line"><span class="comment">    display: none !important;</span></span><br><span class="line"><span class="comment">  &#125;*/</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.aplayer</span><span class="selector-class">.aplayer-fixed</span><span class="selector-class">.aplayer-narrow</span> <span class="selector-class">.aplayer-body</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">66px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">    <span class="comment">/* 默认情况下缩进左侧66px，只留一点箭头部分 */</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.aplayer</span><span class="selector-class">.aplayer-fixed</span><span class="selector-class">.aplayer-narrow</span> <span class="selector-class">.aplayer-body</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">    <span class="comment">/* 鼠标悬停是左侧缩进归零，完全显示按钮 */</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.aplayer</span><span class="selector-class">.aplayer-fixed</span> &#123;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">999999</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 评论框</span></span><br><span class="line"><span class="comment">  .vwrap &#123;</span></span><br><span class="line"><span class="comment">    box-shadow:2px2px5px #bbb;</span></span><br><span class="line"><span class="comment">    background:口rgba(255,255,255，0.3);</span></span><br><span class="line"><span class="comment">    border-radius: 8px;</span></span><br><span class="line"><span class="comment">    padding: 30px;</span></span><br><span class="line"><span class="comment">    margin:30px 0px 30px px;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  /* 设置评论框 */</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.vcard</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">2px</span> <span class="number">2px</span> <span class="number">5px</span> <span class="number">#bbb</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">30px</span> <span class="number">0px</span> <span class="number">0px</span> <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 鼠标图标 */</span></span><br><span class="line">  <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: <span class="built_in">url</span>(<span class="string">&#x27;/img/x1.cur&#x27;</span>), auto;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="selector-tag">a</span>,</span><br><span class="line">    <span class="selector-attr">[type=<span class="string">&#x27;button&#x27;</span>]</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:disabled</span>),</span><br><span class="line">    <span class="selector-attr">[type=<span class="string">&#x27;reset&#x27;</span>]</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:disabled</span>),</span><br><span class="line">    <span class="selector-attr">[type=<span class="string">&#x27;submit&#x27;</span>]</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:disabled</span>),</span><br><span class="line">    <span class="selector-tag">button</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:disabled</span>) &#123;</span><br><span class="line">      <span class="attribute">cursor</span>: <span class="built_in">url</span>(<span class="string">&#x27;/img/x2.cur&#x27;</span>), auto <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* md网站下划线 */</span></span><br><span class="line">    <span class="selector-id">#article-container</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">text-decoration</span>: none <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#article-container</span> <span class="selector-id">#hpp_talk</span> <span class="selector-tag">p</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: inline;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 404页面 */</span></span><br><span class="line">  <span class="selector-id">#error-wrap</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">40%</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">0</span> <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">1000px</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0</span>, -<span class="number">50%</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#error-wrap</span> <span class="selector-class">.error-content</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">0</span> <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">18rem</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>:<span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--card-bg);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--card-box-shadow);</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#error-wrap</span> <span class="selector-class">.error-content</span> <span class="selector-class">.error-img</span> &#123;</span><br><span class="line">    <span class="attribute">box-flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">border-top-left-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">border-bottom-left-radius</span>:<span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: 口<span class="number">#49b1f5</span>;</span><br><span class="line">    <span class="attribute">background-position</span>:center;</span><br><span class="line">    <span class="attribute">background-size</span>: cover;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#error-wrap</span> <span class="selector-class">.error-content</span> <span class="selector-class">.error-info</span> &#123;</span><br><span class="line">    <span class="attribute">box-flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.5rem</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">font-family</span>: Titillium Web, <span class="string">&#x27;PingFang SC&#x27;</span>, <span class="string">&#x27;Hiragino Sans GB&#x27;</span>, <span class="string">&#x27;Microsoft JhengHei&#x27;</span>, <span class="string">&#x27;Microsoft YaHei&#x27;</span>,</span><br><span class="line">    sans-serif;</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="selector-id">#error-wrap</span> <span class="selector-class">.error-content</span> <span class="selector-class">.error-info</span> <span class="selector-class">.error_title</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>:-<span class="number">4rem</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">9em</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#error-wrap</span> <span class="selector-class">.error-content</span> <span class="selector-class">.error-info</span> <span class="selector-class">.error_subtitle</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>:-<span class="number">3.5rem</span>;</span><br><span class="line">    <span class="attribute">word-break</span>: break-word;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.6em</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#error-wrap</span> <span class="selector-class">.error-content</span> <span class="selector-class">.error-info</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">0.5rem</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.3rem</span> <span class="number">1.5rem</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--btn-bg);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--btn-color);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#body-wrap</span><span class="selector-class">.error</span> <span class="selector-class">.aside-list</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: nowrap;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: scroll;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#body-wrap</span><span class="selector-class">.error</span> <span class="selector-class">.aside-list</span> <span class="selector-class">.aside-list-group</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: nowrap;</span><br><span class="line">    <span class="attribute">max-width</span>:<span class="number">1200px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#body-wrap</span><span class="selector-class">.error</span> <span class="selector-class">.aside-list</span> <span class="selector-class">.aside-list-item</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#body-wrap</span><span class="selector-class">.error</span> <span class="selector-class">.aside-list</span> <span class="selector-class">.aside-list-item</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">object-fit</span>: cover;</span><br><span class="line">    <span class="attribute">border-radius</span>:<span class="number">12px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#body-wrap</span><span class="selector-class">.error</span> <span class="selector-class">.aside-list</span> <span class="selector-class">.aside-list-item</span> <span class="selector-class">.thumbnail</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">230px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">143px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--heo-card-bg);</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#body-wrap</span><span class="selector-class">.error</span> <span class="selector-class">.aside-list</span> <span class="selector-class">.aside-list-item</span> <span class="selector-class">.content</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">    -webkit-<span class="selector-tag">line</span>-clamp:<span class="number">2</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    -webkit-<span class="attribute">box-orient</span>: vertical;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: flex-end;</span><br><span class="line">    <span class="attribute">align-content</span>:center;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">0.5rem</span>;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-id">#body-wrap</span><span class="selector-class">.error</span> <span class="selector-class">.aside-list</span> <span class="selector-class">.aside-list-item</span> <span class="selector-class">.content</span> <span class="selector-tag">time</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* 代码框主题 */</span></span><br><span class="line">  <span class="selector-id">#article-container</span> <span class="selector-tag">figure</span><span class="selector-class">.highlight</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>:<span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1. 外层容器：设置【不透明】边框 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-clock</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>; <span class="comment">/* 必须透明，否则会遮挡背景图 */</span></span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#ffffff</span> <span class="meta">!important</span>; <span class="comment">/* 这里是你的不透明边框，颜色可改 */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>) <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden; <span class="comment">/* 确保内部半透明层不超出边框 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2. 内层背景：保持【半透明】和毛玻璃效果 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-clock</span> <span class="selector-class">.card-background</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.4</span>) <span class="meta">!important</span>; </span><br><span class="line">  <span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">10px</span>); </span><br><span class="line">  -webkit-<span class="attribute">backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">10px</span>);</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="meta">!important</span>; <span class="comment">/* 填满外层边框内部 */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="meta">!important</span>; <span class="comment">/* 边框由外层容器提供，内层无需重复圆角 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="number">0</span> <span class="number">0</span> <span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3. 夜间模式适配 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-clock</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#333333</span> <span class="meta">!important</span>; <span class="comment">/* 暗色模式下的不透明边框 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&#x27;dark&#x27;</span>]</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-clock</span> <span class="selector-class">.card-background</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>) <span class="meta">!important</span>; </span><br><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="number">0</span> <span class="number">0</span> <span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 4. 字体颜色修正 */</span></span><br><span class="line"><span class="selector-id">#aside-content</span> <span class="selector-class">.card-clock</span> <span class="selector-class">.clock-row</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--font-color) <span class="meta">!important</span>; </span><br><span class="line">  <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不需要一图流就删除下面代码</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 页脚透明 */</span></span><br><span class="line"><span class="selector-id">#footer</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 头图透明 */</span></span><br><span class="line"><span class="selector-id">#page-header</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在butterfly配置文件里找到inject添加下面代码</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># - &lt;link rel=&quot;stylesheet&quot; href=&quot;/xxx.css&quot;&gt;</span></span><br><span class="line">    <span class="comment"># 自定义css</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后在这个配置文件里找background添加路径</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">background:</span> <span class="string">/img/background.png</span></span><br></pre></td></tr></table></figure>

<p>如果本地部署没问题但是服务器有问题，就在config里设置url，设置成自己的github.io</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/blog/%E5%8D%9A%E5%AE%A2/image-20260203005249715.png" alt="image-20260203005249715"></p>
<h1 id="字数统计"><a href="#字数统计" class="headerlink" title="字数统计"></a>字数统计</h1><p>安装插件：在你的博客根目录，打开cmd命令窗口执行<code>npm install hexo-wordcount --save</code></p>
<p>开启配置：修改主题配置文件<code>_config.butterfly.yml</code>中的<code>wordcount</code></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">wordcount:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_wordcount:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">min2read:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_wordcount:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h1 id="留言板"><a href="#留言板" class="headerlink" title="留言板"></a>留言板</h1><p>下载好插件然后在_config.butterfly.yml粘贴这些</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># envelope_comment</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/e2d3c450/</span></span><br><span class="line"><span class="attr">envelope_comment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#控制开关</span></span><br><span class="line">  <span class="attr">custom_pic:</span>      </span><br><span class="line">    <span class="attr">cover:</span> <span class="string">/img/envelope-cover.png</span> <span class="comment">#信笺头部图片</span></span><br><span class="line">    <span class="attr">line:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/line.png</span> <span class="comment">#信笺底部图片</span></span><br><span class="line">    <span class="attr">beforeimg:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/before.png</span> <span class="comment"># 信封前半部分</span></span><br><span class="line">    <span class="attr">afterimg:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-envelope/lib/after.png</span> <span class="comment"># 信封后半部分</span></span><br><span class="line">  <span class="attr">message:</span> <span class="comment">#信笺正文，多行文本，写法如下</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想问的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想说的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想吐槽的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">哪怕是有什么想吃的，都可以告诉我哦~</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">自动书记人偶竭诚为您服务！</span> <span class="comment">#仅支持单行文本</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">950px</span> <span class="comment">#1050px，信封划出的高度</span></span><br><span class="line">  <span class="attr">path:</span> <span class="comment">#【可选】comments 的路径名称。默认为 comments，生成的页面为 comments/index.html</span></span><br><span class="line">  <span class="attr">front_matter:</span> <span class="comment">#【可选】comments页面的 front_matter 配置</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">留言板</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h1 id="github-action自动部署"><a href="#github-action自动部署" class="headerlink" title="github action自动部署"></a>github action自动部署</h1><p>在github的设置里选择Developer Settings，然后点击Personal access tokens，选Tokens (classic)，Generate new token(classic)新建一个，他会给个token，这个要复制下来，然后再新建个私人仓库，名字随意，放上博客源码</p>
<p>在博客文件里的.github新建一个workflows文件夹，新建一个autodeploy.yml文件，里面输入以下配置</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">自动部署</span></span><br><span class="line">  <span class="comment"># 当有改动推送到master分支时，启动Action</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line">    <span class="comment">#2020年10月后github新建仓库默认分支改为main，注意更改</span></span><br><span class="line">  <span class="attr">release:</span></span><br><span class="line">    <span class="attr">types:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">published</span></span><br><span class="line"><span class="attr">jobs :</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">检查分支</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">ref:</span> <span class="string">main</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;12.x&#x27;</span></span><br><span class="line">  </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          export TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">          npm install hexo-cli -g</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">缓存</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v1</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">cache</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node</span> <span class="string">modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;runner.0S&#125;&#125;-$&#123;&#123;hashFiles(&#x27;**/package-lock.json&#x27;)&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装依赖</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm install gulp-cli -g #全局安装gulp</span></span><br><span class="line"><span class="string">          npm install --save</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">生成静态文件</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo bangumi -u #bilibili番剧更新</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string">          gulp</span></span><br><span class="line"><span class="string"></span>    </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">部署到Github</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">token:</span>  <span class="comment"># token换上自己的</span></span><br><span class="line">          <span class="attr">repository-name:</span> <span class="string">Shelter67/Shelter67.github.io</span></span><br><span class="line"></span><br><span class="line">          <span class="attr">folder:</span> <span class="string">public</span></span><br><span class="line">          <span class="attr">commit-message:</span> <span class="string">&#x27;$&#123;&#123; github,event.head_commit.message &#125;&#125; $(date +&quot;%Z %Y-%m-%d %A %H:%M:%$&quot;) Updated By Github Actions&#x27;</span></span><br></pre></td></tr></table></figure>

<p>然后在.gitignore里输入以下内容</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br><span class="line">.deploy_git*/</span><br><span class="line">.idea</span><br><span class="line">themes/butterfly/.git</span><br><span class="line">_multiconfig.yml</span><br></pre></td></tr></table></figure>

<p>然后在butterfly文件夹里有个.git文件夹（隐藏的），可以给删掉</p>
<p>然后在博客根目录输入以下指令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin git@github-shelter67:Shelter67/hexo-SourceCode-Repo.git <span class="comment">#这里后面的链接是新创建的源码仓库的ssh</span></span><br><span class="line">git checkout -b main#切换到main分支</span><br></pre></td></tr></table></figure>

<p>然后再运行git提交指令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;github action update&quot;</span></span><br><span class="line">git push origin main</span><br></pre></td></tr></table></figure>

<p>查看提交情况要进入到源码仓库，然后点击action，可以看到一个自动部署的东西，点进去点deploy就可以看到正在执行的hexo缓存</p>
<h1 id="电子钟"><a href="#电子钟" class="headerlink" title="电子钟"></a>电子钟</h1><p>先卸载店长的侧边栏电子钟</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-butterfly-clock</span><br></pre></td></tr></table></figure>

<p>然后安装安知鱼的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-clock-anzhiyu --save</span><br></pre></td></tr></table></figure>

<p>配置：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># electric clock</span></span><br><span class="line"><span class="comment"># see https://anzhiy.cn/posts/fc18.html</span></span><br><span class="line"><span class="attr">electric_clock:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span> <span class="comment">#应用页面</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="comment">#-/posts/</span></span><br><span class="line">    <span class="comment">#- /about/</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">class</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">sticky_layout</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">loading:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu@1.0.5/lib/loading.gif</span> <span class="comment">#加载动画自定义</span></span><br><span class="line"><span class="attr">clock_css:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu@1.0.5/lib/clock.min.css</span></span><br><span class="line"><span class="attr">clock_js:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu@1.0.5/lib/clock.min.js</span></span><br><span class="line"><span class="attr">ip_api:</span> <span class="string">https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0</span></span><br><span class="line"><span class="attr">qweather_key:</span>  <span class="comment"># 和风天气key</span></span><br><span class="line"><span class="attr">gaud_map_key:</span>  <span class="comment">#高德地图web服务key</span></span><br></pre></td></tr></table></figure>

<p>和风天气key：<a target="_blank" rel="noopener" href="https://id.qweather.com/#/login">https://id.qweather.com/#/login</a></p>
<p>进入后点击开发服务控制台</p>
<p>高德地图：<a target="_blank" rel="noopener" href="https://lbs.amap.com/%EF%BC%8C%E8%BF%9B%E5%85%A5%E6%8E%A7%E5%88%B6%E5%8F%B0%EF%BC%8C%E7%82%B9%E5%87%BB%E6%88%91%E7%9A%84%E5%BA%94%E7%94%A8%EF%BC%8C%E7%84%B6%E5%90%8E%E5%88%9B%E5%BB%BA%EF%BC%8C%E5%90%8D%E7%A7%B0%E9%9A%8F%E6%84%8F%EF%BC%8C%E7%B1%BB%E5%9E%8B%E9%80%89%E5%85%B6%E4%BB%96%EF%BC%8C%E7%82%B9%E5%87%BB%E6%B7%BB%E5%8A%A0key%EF%BC%8C%E5%90%8D%E7%A7%B0%E9%9A%8F%E6%84%8F%EF%BC%8C%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0%E9%80%89web%E6%9C%8D%E5%8A%A1%EF%BC%8C%E7%84%B6%E5%90%8E%E6%8F%90%E4%BA%A4">https://lbs.amap.com/，进入控制台，点击我的应用，然后创建，名称随意，类型选其他，点击添加key，名称随意，服务平台选web服务，然后提交</a></p>
<p>近期，和风天气官方彻底关闭了旧版简易天气接口：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0</span><br></pre></td></tr></table></figure>

<p>为了解决时钟组件完全不可用的问题，将旧方案彻底移除，并迁移了新的插件：</p>
<p><strong>hexo-butterfly-clock-remake</strong>，整体视觉和功能与原版一致，同时使用了和风天气最新接口，兼容性与稳定性更好</p>
<p>地址：<a target="_blank" rel="noopener" href="https://github.com/hoochanlon/hexo-butterfly-clock-remake?utm_source=chatgpt.com">https://github.com/hoochanlon/hexo-butterfly-clock-remake</a></p>
<h3 id="一、卸载旧插件"><a href="#一、卸载旧插件" class="headerlink" title="一、卸载旧插件"></a>一、卸载旧插件</h3><p>如果你使用过旧版时钟方案，务必先卸载它们</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-butterfly-clock</span><br><span class="line">npm uninstall hexo-butterfly-clock-anzhiyu </span><br><span class="line">npm uninstall hexo-butterfly-clock-anzhiyu-yang</span><br><span class="line">npm uninstall hexo-butterfly-clock-remake</span><br></pre></td></tr></table></figure>

<h3 id="二、安装新版插件"><a href="#二、安装新版插件" class="headerlink" title="二、安装新版插件"></a>二、安装新版插件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-clock-veeink</span><br></pre></td></tr></table></figure>

<p>注意：<br>该插件依赖 <strong>和风天气开发者 API</strong>。你需要前往注册并获取自己的：</p>
<ul>
<li>API Host（需手动在前面加 <code>https://</code>）<strong>注意这里，作者并没有提到，但不加会报错</strong></li>
<li>API Key</li>
</ul>
<h3 id="三、配置使用（站点配置或主题配置均可）"><a href="#三、配置使用（站点配置或主题配置均可）" class="headerlink" title="三、配置使用（站点配置或主题配置均可）"></a>三、配置使用（站点配置或主题配置均可）</h3><p>在 <code>_config.yml</code> 或 <code>_config.butterfly.yml</code> 中加入以下内容</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># electric_clock</span></span><br><span class="line"><span class="comment"># see: https://github.com/hoochanlon/hexo-butterfly-clock-remake</span></span><br><span class="line"><span class="attr">electric_clock:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span>           </span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span>      </span><br><span class="line">  <span class="attr">exclude:</span>              </span><br><span class="line">    <span class="comment"># - /posts/</span></span><br><span class="line">    <span class="comment"># - /about/</span></span><br><span class="line">  <span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">class</span>          </span><br><span class="line">    <span class="attr">name:</span> <span class="string">aside-content</span>  </span><br><span class="line">    <span class="comment"># insert_before: user-countdown</span></span><br><span class="line">    <span class="attr">insert_after:</span> <span class="string">card-announcement</span>  </span><br><span class="line">  <span class="attr">loading:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/loading.gif</span></span><br><span class="line">  <span class="attr">clock_css:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/clock-min.css</span></span><br><span class="line">  <span class="attr">clock_js:</span> <span class="string">https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/clock-min.js</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">qweather_api_host:</span> &#123;<span class="string">YOUR</span> <span class="string">API</span> <span class="string">HOST</span>&#125;  <span class="comment"># 注意要写成 https://xxx.qweatherapi.com</span></span><br><span class="line">  <span class="attr">qweather_key:</span> &#123;<span class="string">YOUR</span> <span class="string">KEY</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># default_city: &quot;资兴&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="四、关键参数说明"><a href="#四、关键参数说明" class="headerlink" title="四、关键参数说明"></a>四、关键参数说明</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/blog/%E5%8D%9A%E5%AE%A2/image-20260207173945077.png" alt="image-20260207173945077"></p>
<h1 id="关于博客上传服务器"><a href="#关于博客上传服务器" class="headerlink" title="关于博客上传服务器"></a>关于博客上传服务器</h1><p>可以强制执行这个触发钩子</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> git --work-tree=/www/wwwroot/blog.dreamshelter.cn --git-dir=/home/git/repos/xxx.git checkout -f</span><br></pre></td></tr></table></figure>

<h1 id="音乐播放"><a href="#音乐播放" class="headerlink" title="音乐播放"></a>音乐播放</h1><p>新加了页面自动播放功能，但是要开启pjax，不然会换个页面就重新播放</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pjax:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>以下是代码</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bottom:</span></span><br><span class="line">  <span class="comment"># - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">  <span class="comment"># aplayer音乐</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&lt;div</span> <span class="string">class=&quot;aplayer</span> <span class="literal">no</span><span class="string">-destroy&quot;</span> <span class="string">data-id=&quot;17745883873&quot;</span> <span class="string">data-server=&quot;netease&quot;</span> <span class="string">data-type=&quot;playlist&quot;</span></span><br><span class="line">    <span class="string">data-order=&quot;list&quot;</span> <span class="string">data-fixed=&quot;true&quot;</span> <span class="string">data-preload=&quot;auto&quot;</span> <span class="string">data-autoplay=&quot;true&quot;</span> <span class="string">data-mutex=&quot;true&quot;</span> <span class="string">&gt;&lt;/div&gt;</span></span><br><span class="line">  <span class="comment"># 2. 初始音量脚本（执行一次后立即自毁）</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&lt;script&gt;var</span> <span class="string">checkAP=setInterval(function()&#123;var</span> <span class="string">m=document.querySelector(&quot;.aplayer&quot;);if(m&amp;&amp;m.aplayer)&#123;m.aplayer.volume(0.1,true);console.log(&quot;初始音量已设为10%&quot;);clearInterval(checkAP)&#125;&#125;,200);&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="页脚计时器和github徽标"><a href="#页脚计时器和github徽标" class="headerlink" title="页脚计时器和github徽标"></a>页脚计时器和github徽标</h1><p>安装指令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-footer-beautify --save</span><br></pre></td></tr></table></figure>

<p><strong>问题：</strong> 很多 Butterfly 的新版本或魔改版本，页脚的容器 ID 可能叫 <code>footer</code> 而不是 <code>footer-wrap</code>。 <strong>验证方法：</strong> 1. 在浏览器打开你的博客。 2. 按 <strong>F12</strong>，点击左上角的“小箭头”图标，点一下你的页脚。 3. 查看右侧代码，看看包围页脚内容的最外层 <code>&lt;div&gt;</code> 的 <code>id</code> 到底是什么。如果叫 <code>footer</code>，你必须把配置里的 <code>name</code> 改成 <code>footer</code></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">layout:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">footer-wrap</span></span><br></pre></td></tr></table></figure>

<p>而我这里的是footer-other，在 HTML 中，<code>id</code> 和 <code>class</code> 是不一样的。</p>
<ul>
<li><strong>ID</strong> 选择器在代码中写做 <code>id=&quot;footer&quot;</code>，配置里直接写名字。</li>
<li><strong>Class</strong> 选择器在代码中写做 <code>class=&quot;footer-other&quot;</code>。</li>
</ul>
<p>就要改成</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">class</span>      <span class="comment"># 改为 class</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">footer-other</span> <span class="comment"># 对应你看到的那个标签</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>最终配置：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">~~~</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># github贡献图</span></span><br><span class="line"></span><br><span class="line"><span class="string">参考文章：https://www.cnblogs.com/an-shiguang/p/18269053</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装依赖：</span></span><br><span class="line"></span><br><span class="line"><span class="string">~~~bash</span></span><br><span class="line"><span class="string">npm</span> <span class="string">i</span> <span class="string">@barry-flynn/hexo-github-calendar</span> <span class="string">--save</span></span><br></pre></td></tr></table></figure>

<h2 id="添加配置："><a href="#添加配置：" class="headerlink" title="添加配置："></a>添加配置：</h2><p>在 Hexo 项目根目录的 <code>_config.yml</code> 文件最后面添加如下配置（注意是在 Hexo 的配置文件中添加，而不是主题的配置文件）</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-github-canlendar</span></span><br><span class="line"><span class="comment"># 贡献度热力图插件 https://github.com/Barry-Flynn/hexo-github-calendar</span></span><br><span class="line"><span class="attr">githubcalendar:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span>        <span class="comment"># 是否启用本插件</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">/</span>      <span class="comment"># 要生效的页面，如 / 首页，/about/ 介绍页等</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">shiguang-coding</span>   <span class="comment"># GitHub 用户名</span></span><br><span class="line">  <span class="attr">layout:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">recent-posts</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">githubcalendar_html:</span> <span class="string">&#x27;&lt;div class=&quot;recent-post-item&quot; style=&quot;width:100%;height:auto;padding:10px;&quot;&gt;&lt;div id=&quot;github_loading&quot; style=&quot;width:10%;height:100%;margin:0 auto;display: block&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;  viewBox=&quot;0 0 50 50&quot; style=&quot;enable-background:new 0 0 50 50&quot; xml:space=&quot;preserve&quot;&gt;&lt;path fill=&quot;#d0d0d0&quot; d=&quot;M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z&quot; transform=&quot;rotate(275.098 25 25)&quot;&gt;&lt;animateTransform attributeType=&quot;xml&quot; attributeName=&quot;transform&quot; type=&quot;rotate&quot; from=&quot;0 25 25&quot; to=&quot;360 25 25&quot; dur=&quot;0.6s&quot; repeatCount=&quot;indefinite&quot;&gt;&lt;/animateTransform&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/div&gt;&lt;div id=&quot;github_container&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line">  <span class="attr">pc_minheight:</span> <span class="string">280px</span></span><br><span class="line">  <span class="attr">mobile_minheight:</span> <span class="string">0px</span></span><br><span class="line">  <span class="comment"># 贡献统计的梯度色卡值，可自行调整</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;[&#x27;#ebedf0&#x27;, &#x27;#a2f7af&#x27;, &#x27;#6ce480&#x27;, &#x27;#54ad63&#x27;, &#x27;#469252&#x27;, &#x27;#31753c&#x27;, &#x27;#1f5f2a&#x27;, &#x27;#13531f&#x27;, &#x27;#084111&#x27;, &#x27;#032b09&#x27;, &#x27;#000000&#x27;]&quot;</span></span><br><span class="line">  <span class="comment"># 推荐填写你自建的API接口，公用api随时可能会失效</span></span><br><span class="line">  <span class="comment"># api: https://github-calendar-api.meta-code.top/api</span></span><br><span class="line">  <span class="attr">api:</span> <span class="string">https://githubcalendarapi.shiguang666.eu.org/api</span></span><br><span class="line">  <span class="comment"># 推荐下载后使用本地文件</span></span><br><span class="line">  <span class="comment"># calendar_js: https://cdn.jsdelivr.net/gh/barry-flynn/hexo-github-calendar/hexo_githubcalendar.js # 在线文件，容易加载失败</span></span><br><span class="line">  <span class="attr">calendar_js:</span> <span class="string">/js/hexo_githubcalendar.js</span> <span class="comment"># 本地文件，请下载到主题文件夹的source目录下</span></span><br><span class="line">  <span class="attr">plus_style:</span> <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>下载 <a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/barry-flynn/hexo-github-calendar/hexo_githubcalendar.js">hexo_githubcalendar.js</a> 到主题文件夹 source目录，例如 <code>themes\butterfly\source\js</code></p>
<p>然后执行三连命令即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure>

<h2 id="自建API"><a href="#自建API" class="headerlink" title="自建API"></a>自建API</h2><p>由于我以及其他博主提供的公共API随时可能失效，所以推荐自建API接口，使用<a target="_blank" rel="noopener" href="https://vercel.com/">Vercel</a>部署完全免费喔。</p>
<p>新用户可以直接用Github登录，建议重新用google账号或者其他国外账号重新注册个Github账号，因为我之前使用自己的Github账号登录时好像被拒绝了，可能是绑定了国内的邮箱，有地域限制之类的。</p>
<p>先将 <a target="_blank" rel="noopener" href="https://github.com/Barry-Flynn/python_github_calendar_api">python_github_calendar_api By Barry-Flynn</a> Fork 到自己的Github</p>
<p>登录 Vercel <code>Add New.. =&gt; Project</code></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2023.cnblogs.com/blog/2233039/202406/2233039-20240619121456348-30826774.png"></p>
<p>搜索刚才导入的项目，当然如果仓库不是很多的话可以直接看到最近创建的仓库，点击 import导入</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2023.cnblogs.com/blog/2233039/202406/2233039-20240619121724078-500658209.png"></p>
<p>然后点击Deploy 进行部署</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2023.cnblogs.com/blog/2233039/202406/2233039-20240619121850293-910169080.png"></p>
<p>等待部署成功</p>
<p>然后可以绑定自己的域名，否则服务可能会因为DNS污染导致被墙无法正常使用</p>
<p>可直接点击 <code>Add Domain</code></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2023.cnblogs.com/blog/2233039/202406/2233039-20240619122207345-284517898.png"></p>
<p>或者到 <code>Settings =&gt; Domains</code> 添加域名</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2023.cnblogs.com/blog/2233039/202406/2233039-20240619122446838-1361272774.png"></p>
<p>例如此处我要添加的域名为<a target="_blank" rel="noopener" href="https://vercelapi.dreamshelter.cn,当然这里我在腾讯与服务器先创建了这个二级域名,添加后提示需要添加一条cname记录指向`cname.vercel-dns.com`,进入到腾讯云dnspod管理界面,添加vercel给你的cname那些,ttl600,然后等待部署成功/">https://vercelapi.dreamshelter.cn，当然这里我在腾讯与服务器先创建了这个二级域名，添加后提示需要添加一条CNAME记录指向`cname.vercel-dns.com`，进入到腾讯云dnspod管理界面，添加vercel给你的cname那些，ttl600，然后等待部署成功</a></p>
<p>如果依然提示 <code>INTERNAL_SERVER_ERROR</code> 500错误，错误码 <code>FUNCTION_INVOCATION_FAILED</code>则说明当前</p>
<p>Node的版本不支持。将默认Node版本从20.x 改为 18.x</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img2023.cnblogs.com/blog/2233039/202406/2233039-20240619131454709-2042273534.png"></p>
<p>这是自己优化后的js代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">GithubCalendar</span>(<span class="params">git_githubapiurl, git_color, git_user</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;github_container&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title function_">github_canlendar</span> = (<span class="params">git_user, git_githubapiurl, git_color</span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">var</span> git_fixed = <span class="string">&#x27;fixed&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> git_px = <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> git_month = [<span class="string">&#x27;一月&#x27;</span>, <span class="string">&#x27;二月&#x27;</span>, <span class="string">&#x27;三月&#x27;</span>, <span class="string">&#x27;四月&#x27;</span>, <span class="string">&#x27;五月&#x27;</span>, <span class="string">&#x27;六月&#x27;</span>, <span class="string">&#x27;七月&#x27;</span>, <span class="string">&#x27;八月&#x27;</span>, <span class="string">&#x27;九月&#x27;</span>, <span class="string">&#x27;十月&#x27;</span>, <span class="string">&#x27;十一月&#x27;</span>, <span class="string">&#x27;十二月&#x27;</span>];</span><br><span class="line">            <span class="keyword">var</span> git_monthchange = [];</span><br><span class="line">            <span class="keyword">var</span> git_oneyearbeforeday = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> git_thisday = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> git_amonthago = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> git_aweekago = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> git_weekdatacore = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> git_datacore = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> git_total = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> git_datadate = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> git_git_data = [];</span><br><span class="line">            <span class="keyword">var</span> git_positionplusdata = []; <span class="comment">// 提示框坐标数组</span></span><br><span class="line">            <span class="keyword">var</span> git_firstweek = [];</span><br><span class="line">            <span class="keyword">var</span> git_lastweek = [];</span><br><span class="line">            <span class="keyword">var</span> git_beforeweek = [];</span><br><span class="line">            <span class="keyword">var</span> git_thisweekdatacore = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> git_mounthbeforeday = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> git_mounthfirstindex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> git_crispedges = <span class="string">&#x27;crispedges&#x27;</span>;</span><br><span class="line">            <span class="keyword">var</span> git_thisdayindex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> git_amonthagoindex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> git_amonthagoweek = [];</span><br><span class="line">            <span class="keyword">var</span> git_firstdate = [];</span><br><span class="line">            <span class="keyword">var</span> git_first2date = [];</span><br><span class="line">            <span class="keyword">var</span> git_montharrbefore = [];</span><br><span class="line">            <span class="keyword">var</span> git_monthindex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">retinaCanvas</span> = (<span class="params">canvas, context, ratio</span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (ratio &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">var</span> canvasWidth = canvas.<span class="property">width</span>;</span><br><span class="line">                    <span class="keyword">var</span> canvasHeight = canvas.<span class="property">height</span>;</span><br><span class="line">                    canvas.<span class="property">width</span> = canvasWidth * ratio;</span><br><span class="line">                    canvas.<span class="property">height</span> = canvasHeight * ratio;</span><br><span class="line">                    canvas.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;100%&#x27;</span>;</span><br><span class="line">                    canvas.<span class="property">style</span>.<span class="property">height</span> = canvasHeight + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">                    context.<span class="title function_">scale</span>(ratio, ratio);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">responsiveChart</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;gitcanvas&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">var</span> git_tooltip_container = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;git_tooltip_container&#x27;</span>);</span><br><span class="line">                    <span class="keyword">var</span> ratio = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> || <span class="number">1</span></span><br><span class="line">                    <span class="keyword">var</span> git_x = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">var</span> git_y = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">var</span> git_span1 = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">var</span> git_span2 = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">var</span> github_calendar_c = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;gitcanvas&quot;</span>);</span><br><span class="line">                    github_calendar_c.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;100%&#x27;</span>;</span><br><span class="line">                    github_calendar_c.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">var</span> github_calendar_ctx = github_calendar_c.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">var</span> box = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;gitcalendarcanvasbox&quot;</span>);</span><br><span class="line">                    width = github_calendar_c.<span class="property">width</span> = box.<span class="property">offsetWidth</span>;</span><br><span class="line">                    <span class="comment">// 稍微增加高度比例，为日期留出垂直空间</span></span><br><span class="line">                    height = github_calendar_c.<span class="property">height</span> = <span class="number">10</span> * <span class="number">0.96</span> * github_calendar_c.<span class="property">width</span> / git_data.<span class="property">length</span>;</span><br><span class="line">                    </span><br><span class="line">                    <span class="title function_">retinaCanvas</span>(github_calendar_c, github_calendar_ctx, ratio)</span><br><span class="line">                    <span class="keyword">var</span> linemaxwitdh = height / <span class="number">10</span>;</span><br><span class="line">                    <span class="keyword">var</span> lineminwitdh = <span class="number">0.8</span> * linemaxwitdh;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 【优化1】调整起始位置，Y轴预留更多空间给月份</span></span><br><span class="line">                    <span class="keyword">var</span> startY = <span class="number">0.05</span> * width; </span><br><span class="line">                    <span class="keyword">var</span> setposition = &#123; <span class="attr">x</span>: <span class="number">0.02</span> * width, <span class="attr">y</span>: startY &#125;;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// 【优化2】核心：每次重绘前必须清空旧坐标，否则鼠标检测会乱跳</span></span><br><span class="line">                    git_positionplusdata = []; </span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> week <span class="keyword">in</span> git_data) &#123;</span><br><span class="line">                        weekdata = git_data[week];</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">var</span> day <span class="keyword">in</span> weekdata) &#123;</span><br><span class="line">                            <span class="keyword">var</span> dataitem = &#123; <span class="attr">date</span>: weekdata[day].<span class="property">date</span>, <span class="attr">count</span>: weekdata[day].<span class="property">count</span>, <span class="attr">x</span>: setposition.<span class="property">x</span>, <span class="attr">y</span>: setposition.<span class="property">y</span> &#125;;</span><br><span class="line">                            git_positionplusdata.<span class="title function_">push</span>(dataitem);</span><br><span class="line"></span><br><span class="line">                            github_calendar_ctx.<span class="property">fillStyle</span> = <span class="title function_">git_thiscolor</span>(git_color, weekdata[day].<span class="property">count</span>);</span><br><span class="line">                            <span class="comment">// 绘制格子</span></span><br><span class="line">                            github_calendar_ctx.<span class="title function_">fillRect</span>(setposition.<span class="property">x</span>, setposition.<span class="property">y</span>, lineminwitdh, lineminwitdh);</span><br><span class="line">                            setposition.<span class="property">y</span> = setposition.<span class="property">y</span> + linemaxwitdh</span><br><span class="line">                        &#125;</span><br><span class="line">                        setposition.<span class="property">y</span> = startY;</span><br><span class="line">                        setposition.<span class="property">x</span> = setposition.<span class="property">x</span> + linemaxwitdh;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 【优化3】月份与周几文字的精准定位</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span> &gt; <span class="number">700</span>) &#123;</span><br><span class="line">                        github_calendar_ctx.<span class="property">font</span> = <span class="string">&quot;500 12px -apple-system, sans-serif&quot;</span>;</span><br><span class="line">                        github_calendar_ctx.<span class="property">fillStyle</span> = <span class="string">&#x27;#999&#x27;</span>;</span><br><span class="line">                        github_calendar_ctx.<span class="property">textBaseline</span> = <span class="string">&quot;top&quot;</span>;</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">// 周几</span></span><br><span class="line">                        github_calendar_ctx.<span class="title function_">fillText</span>(<span class="string">&quot;日&quot;</span>, <span class="number">0</span>, startY + <span class="number">0</span> * linemaxwitdh);</span><br><span class="line">                        github_calendar_ctx.<span class="title function_">fillText</span>(<span class="string">&quot;二&quot;</span>, <span class="number">0</span>, startY + <span class="number">2</span> * linemaxwitdh);</span><br><span class="line">                        github_calendar_ctx.<span class="title function_">fillText</span>(<span class="string">&quot;四&quot;</span>, <span class="number">0</span>, startY + <span class="number">4</span> * linemaxwitdh);</span><br><span class="line">                        github_calendar_ctx.<span class="title function_">fillText</span>(<span class="string">&quot;六&quot;</span>, <span class="number">0</span>, startY + <span class="number">6</span> * linemaxwitdh);</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// 月份文字位置上移，避免被格子挡住</span></span><br><span class="line">                        <span class="keyword">var</span> monthindexlist = github_calendar_c.<span class="property">width</span> / <span class="number">24</span>;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> git_monthchange) &#123;</span><br><span class="line">                            github_calendar_ctx.<span class="title function_">fillText</span>(git_monthchange[index], monthindexlist, <span class="number">0.1</span> * linemaxwitdh);</span><br><span class="line">                            monthindexlist = monthindexlist + github_calendar_c.<span class="property">width</span> / <span class="number">12.5</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 【优化4】鼠标交互检测逻辑</span></span><br><span class="line">                    <span class="keyword">var</span> <span class="title function_">getMousePos</span> = (<span class="params">canvas, event</span>) =&gt; &#123;</span><br><span class="line">                        <span class="keyword">var</span> rect = canvas.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line">                        <span class="comment">// 修正 Canvas 缩放后的坐标转换</span></span><br><span class="line">                        <span class="keyword">var</span> x = (event.<span class="property">clientX</span> - rect.<span class="property">left</span>) * (canvas.<span class="property">width</span> / rect.<span class="property">width</span>) / ratio;</span><br><span class="line">                        <span class="keyword">var</span> y = (event.<span class="property">clientY</span> - rect.<span class="property">top</span>) * (canvas.<span class="property">height</span> / rect.<span class="property">height</span>) / ratio;</span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> git_positionplusdata) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (x &gt; item.<span class="property">x</span> &amp;&amp; x &lt; item.<span class="property">x</span> + lineminwitdh &amp;&amp; y &gt; item.<span class="property">y</span> &amp;&amp; y &lt; item.<span class="property">y</span> + lineminwitdh) &#123;</span><br><span class="line">                                git_span1 = item.<span class="property">date</span>;</span><br><span class="line">                                git_span2 = item.<span class="property">count</span>;</span><br><span class="line">                                git_x = event.<span class="property">clientX</span> - <span class="number">100</span>;</span><br><span class="line">                                git_y = event.<span class="property">clientY</span> - <span class="number">70</span>;</span><br><span class="line">                                <span class="keyword">var</span> html = <span class="title function_">tooltip_html</span>(git_x, git_y, git_span1, git_span2);</span><br><span class="line">                                <span class="title function_">append_div_gitcalendar</span>(git_tooltip_container, html);</span><br><span class="line">                                <span class="keyword">return</span>; <span class="comment">// 找到后立即退出循环</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    github_calendar_c.<span class="property">onmousemove</span> = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">                        git_tooltip_container.<span class="property">innerHTML</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                        <span class="title function_">getMousePos</span>(github_calendar_c, event);</span><br><span class="line">                    &#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// --- 核心逻辑函数保持插件原始结构 ---</span></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">addlastmonth</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (git_thisdayindex === <span class="number">0</span>) &#123;</span><br><span class="line">                    [<span class="number">52</span>, <span class="number">51</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">48</span>].<span class="title function_">forEach</span>(<span class="function"><span class="params">idx</span> =&gt;</span> <span class="title function_">thisweekcore</span>(idx));</span><br><span class="line">                    git_thisweekdatacore += git_firstdate[<span class="number">6</span>].<span class="property">count</span>;</span><br><span class="line">                    git_amonthago = git_firstdate[<span class="number">6</span>].<span class="property">date</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    [<span class="number">52</span>, <span class="number">51</span>, <span class="number">50</span>, <span class="number">49</span>].<span class="title function_">forEach</span>(<span class="function"><span class="params">idx</span> =&gt;</span> <span class="title function_">thisweekcore</span>(idx));</span><br><span class="line">                    <span class="title function_">thisweek2core</span>();</span><br><span class="line">                    git_amonthago = git_first2date[git_thisdayindex - <span class="number">1</span>].<span class="property">date</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">thisweek2core</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = git_thisdayindex - <span class="number">1</span>; i &lt; git_first2date.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                    git_thisweekdatacore += git_first2date[i].<span class="property">count</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">thisweekcore</span> = (<span class="params">index</span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span>(git_data[index]) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> git_data[index]) &#123;</span><br><span class="line">                        git_thisweekdatacore += item.<span class="property">count</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">addlastweek</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> git_lastweek) &#123;</span><br><span class="line">                    git_weekdatacore += item.<span class="property">count</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">addbeforeweek</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = git_thisdayindex; i &lt; git_beforeweek.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                    git_weekdatacore += git_beforeweek[i].<span class="property">count</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">addweek</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (git_thisdayindex === <span class="number">6</span>) &#123;</span><br><span class="line">                    git_aweekago = git_lastweek[<span class="number">0</span>].<span class="property">date</span>;</span><br><span class="line">                    <span class="title function_">addlastweek</span>()</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> lastweek_data = data.<span class="property">contributions</span>[<span class="number">51</span>];</span><br><span class="line">                    git_aweekago = lastweek_data[git_thisdayindex + <span class="number">1</span>].<span class="property">date</span>;</span><br><span class="line">                    <span class="title function_">addlastweek</span>();</span><br><span class="line">                    <span class="title function_">addbeforeweek</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="title function_">fetch</span>(git_githubapiurl).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;github_loading&#x27;</span>)) &#123;</span><br><span class="line">                    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;github_loading&#x27;</span>).<span class="title function_">remove</span>()</span><br><span class="line">                &#125;;</span><br><span class="line">                git_data = data.<span class="property">contributions</span>;</span><br><span class="line">                git_total = data.<span class="property">total</span>;</span><br><span class="line">                git_first2date = git_data[<span class="number">48</span>];</span><br><span class="line">                git_firstdate = git_data[<span class="number">47</span>];</span><br><span class="line">                git_firstweek = data.<span class="property">contributions</span>[<span class="number">0</span>];</span><br><span class="line">                git_lastweek = data.<span class="property">contributions</span>[<span class="number">52</span>];</span><br><span class="line">                git_beforeweek = data.<span class="property">contributions</span>[<span class="number">51</span>];</span><br><span class="line">                git_thisdayindex = git_lastweek.<span class="property">length</span> - <span class="number">1</span>;</span><br><span class="line">                git_thisday = git_lastweek[git_thisdayindex].<span class="property">date</span>;</span><br><span class="line">                git_oneyearbeforeday = git_firstweek[<span class="number">0</span>].<span class="property">date</span>;</span><br><span class="line">                git_monthindex = <span class="built_in">parseInt</span>(git_thisday.<span class="title function_">substring</span>(<span class="number">5</span>, <span class="number">7</span>));</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">var</span> tempMonth = [...git_month];</span><br><span class="line">                git_montharrbefore = tempMonth.<span class="title function_">splice</span>(git_monthindex % <span class="number">12</span>, <span class="number">12</span>);</span><br><span class="line">                git_monthchange = git_montharrbefore.<span class="title function_">concat</span>(tempMonth).<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">12</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="title function_">addweek</span>(data);</span><br><span class="line">                <span class="title function_">addlastmonth</span>();</span><br><span class="line">                <span class="keyword">var</span> html = <span class="title function_">github_main_box</span>(git_monthchange, git_data, git_user, git_color, git_total, git_thisweekdatacore, git_weekdatacore, git_oneyearbeforeday, git_thisday, git_aweekago, git_amonthago);</span><br><span class="line">                <span class="title function_">append_div_gitcalendar</span>(github_container, html);</span><br><span class="line">                <span class="title function_">responsiveChart</span>()</span><br><span class="line">            &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(e));</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">onresize</span> = <span class="function">() =&gt;</span> <span class="title function_">responsiveChart</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">git_thiscolor</span> = (<span class="params">color, x</span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (x === <span class="number">0</span>) <span class="keyword">return</span> color[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (x &lt; <span class="number">2</span>) <span class="keyword">return</span> color[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span> (x &lt; <span class="number">20</span>) <span class="keyword">return</span> color[<span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="built_in">parseInt</span>(x / <span class="number">2</span>), <span class="number">9</span>)];</span><br><span class="line">                <span class="keyword">return</span> color[<span class="number">9</span>];</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">tooltip_html</span> = (<span class="params">x, y, span1, span2</span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`&lt;div class=&quot;gitmessage&quot; style=&quot;top:<span class="subst">$&#123;y&#125;</span>px;left:<span class="subst">$&#123;x&#125;</span>px;position:fixed;z-index:10000&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;angle-wrapper&quot;&gt;&lt;span&gt;<span class="subst">$&#123;span1&#125;</span>&amp;nbsp;&lt;/span&gt;&lt;span&gt;<span class="subst">$&#123;span2&#125;</span> 次上传&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span>;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">github_canvas_box</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&lt;div id=&quot;gitcalendarcanvasbox&quot;&gt;&lt;canvas id=&quot;gitcanvas&quot;&gt;&lt;/canvas&gt;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">github_info_box</span> = (<span class="params">user, color</span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`&lt;div id=&quot;git_tooltip_container&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;contrib-footer clearfix mt-1 mx-3 px-3 pb-1&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;float-left text-gray&quot;&gt;数据来源 &lt;a href=&quot;https://github.com/<span class="subst">$&#123;user&#125;</span>&quot; target=&quot;blank&quot;&gt;@<span class="subst">$&#123;user&#125;</span>&lt;/a&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;contrib-legend text-gray&quot;&gt;Less &lt;ul class=&quot;legend&quot;&gt;</span></span><br><span class="line"><span class="string">                        <span class="subst">$&#123;[<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>].map(i =&gt; <span class="string">`&lt;li style=&quot;background-color:<span class="subst">$&#123;color[i]&#125;</span>&quot;&gt;&lt;/li&gt;`</span>).join(<span class="string">&#x27;&#x27;</span>)&#125;</span></span></span><br><span class="line"><span class="string">                    &lt;/ul&gt; More &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span>;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">github_main_box</span> = (<span class="params">monthchange, git_data, user, color, total, thisweek, week, start, end, aweek, amonth</span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">var</span> style = <span class="title function_">github_main_style</span>();</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`&lt;div class=&quot;position-relative&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;border py-2 graph-before-activity-overview&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;js-gitcalendar-graph mx-md-2 mx-3 d-flex flex-column pt-1 graph-canvas gitcalendar-graph text-center&quot;&gt;</span></span><br><span class="line"><span class="string">                            <span class="subst">$&#123;github_canvas_box()&#125;</span></span></span><br><span class="line"><span class="string">                        &lt;/div&gt;</span></span><br><span class="line"><span class="string">                        <span class="subst">$&#123;github_info_box(user, color)&#125;</span></span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;contrib-stats-box&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;contrib-column table-column&quot;&gt;&lt;span class=&quot;text-muted&quot;&gt;过去一年提交&lt;/span&gt;&lt;span class=&quot;contrib-number&quot;&gt;<span class="subst">$&#123;total&#125;</span>&lt;/span&gt;&lt;span class=&quot;text-muted&quot;&gt;<span class="subst">$&#123;start&#125;</span> - <span class="subst">$&#123;end&#125;</span>&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;contrib-column table-column&quot;&gt;&lt;span class=&quot;text-muted&quot;&gt;最近一月提交&lt;/span&gt;&lt;span class=&quot;contrib-number&quot;&gt;<span class="subst">$&#123;thisweek&#125;</span>&lt;/span&gt;&lt;span class=&quot;text-muted&quot;&gt;<span class="subst">$&#123;amonth&#125;</span> - <span class="subst">$&#123;end&#125;</span>&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;contrib-column table-column&quot;&gt;&lt;span class=&quot;text-muted&quot;&gt;最近一周提交&lt;/span&gt;&lt;span class=&quot;contrib-number&quot;&gt;<span class="subst">$&#123;week&#125;</span>&lt;/span&gt;&lt;span class=&quot;text-muted&quot;&gt;<span class="subst">$&#123;aweek&#125;</span> - <span class="subst">$&#123;end&#125;</span>&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;<span class="subst">$&#123;style&#125;</span>`</span>;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="title function_">github_main_style</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`&lt;style&gt;</span></span><br><span class="line"><span class="string">                    #github_container&#123;text-align:center;width:100%;font-family:-apple-system,BlinkMacSystemFont,&quot;Segoe UI&quot;,Arial,sans-serif;&#125;</span></span><br><span class="line"><span class="string">                    .contrib-legend&#123;float:right;font-size:11px;&#125;</span></span><br><span class="line"><span class="string">                    .legend&#123;display:inline-block;list-style:none;margin:0 5px;padding:0;&#125;</span></span><br><span class="line"><span class="string">                    .legend li&#123;display:inline-block;width:10px;height:10px;border-radius:2px;margin:0 1px;&#125;</span></span><br><span class="line"><span class="string">                    .contrib-stats-box&#123;display:flex;width:100%;padding-top:10px;border-top:1px solid #eee;&#125;</span></span><br><span class="line"><span class="string">                    .contrib-column&#123;flex:1;padding:15px 10px;text-align:center;position:relative;&#125;</span></span><br><span class="line"><span class="string">                    .contrib-column::before&#123;content:&quot;&quot;;position:absolute;top:20%;left:0;height:60%;width:1px;background:linear-gradient(to bottom, transparent, #d1d5da, transparent);&#125;</span></span><br><span class="line"><span class="string">                    .contrib-column:first-child::before&#123;display:none;&#125;</span></span><br><span class="line"><span class="string">                    .contrib-number&#123;font-weight:600;font-size:22px;display:block;color:#24292e;margin:2px 0;&#125;</span></span><br><span class="line"><span class="string">                    .text-muted&#123;font-size:11px;color:#6a737d;display:block;&#125;</span></span><br><span class="line"><span class="string">                    .angle-wrapper&#123;background:rgba(255,255,255,0.98);box-shadow:0 4px 12px rgba(0,0,0,0.15);border:1px solid #e1e4e8;border-radius:6px;padding:8px 12px;color:#24292e;font-size:12px;&#125;</span></span><br><span class="line"><span class="string">                &lt;/style&gt;`</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> <span class="title function_">append_div_gitcalendar</span> = (<span class="params">parent, text</span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">var</span> temp = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">            temp.<span class="property">innerHTML</span> = text;</span><br><span class="line">            <span class="keyword">while</span> (temp.<span class="property">firstChild</span>) parent.<span class="title function_">appendChild</span>(temp.<span class="property">firstChild</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">github_canlendar</span>(git_user, git_githubapiurl, git_color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Twikoo评论"><a href="#Twikoo评论" class="headerlink" title="Twikoo评论"></a>Twikoo评论</h1><p>链接：<a target="_blank" rel="noopener" href="https://twikoo.js.org/backend.html#%E7%A7%81%E6%9C%89%E9%83%A8%E7%BD%B2">https://twikoo.js.org/backend.html#%E7%A7%81%E6%9C%89%E9%83%A8%E7%BD%B2</a></p>
<ol>
<li><p>服务端下载安装 <a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/">Node.js</a></p>
</li>
<li><p>安装 Twikoo server: <code>npm i -g tkserver</code></p>
</li>
<li><p>根据需要配置环境变量，所有的环境变量都是可选的</p>
</li>
<li><p>启动 Twikoo server: <code>tkserver</code></p>
</li>
<li><p>访问 <code>http://服务端IP:8080</code> 测试服务是否启动成功</p>
</li>
<li><p>配置前置代理实现 HTTPS 访问（可以用 Nginx、负载均衡或 Cloudflare 等）<br>我这里直接在宝塔面板的html域名管理里设置配置文件，在最后一个}之前添加以下代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># TWIKOO 反向代理配置</span><br><span class="line">   location /twikooapi/ &#123;</span><br><span class="line">       proxy_pass http://127.0.0.1:8080/; # 注意末尾有斜杠，8080换成你的twikoo端口</span><br><span class="line">       proxy_set_header Host $host;</span><br><span class="line">       proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">       proxy_set_header REMOTE-HOST $remote_addr;</span><br><span class="line">       add_header X-Cache $upstream_cache_status;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>到博客配置文件中配置 envId 为 <code>&#39;https://blog.dreamshelter.cn/twikooapi/&#39;</code></p>
</li>
</ol>
<p>我之前弄了个pm2管理twikoo，持续化管理，但是一直没能启动，本地查看的时候却没事，不知道这个pm2不配置会不会影响，这里懒得写上了</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/Shelter67">Shelter</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://localhost:4000/posts/eedaddf.html">http://localhost:4000/posts/eedaddf.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://localhost:4000" target="_blank">Shelter</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hexo/">Hexo</a><a class="post-meta__tags" href="/tags/%E5%8D%9A%E5%AE%A2/">博客</a><a class="post-meta__tags" href="/tags/%E6%95%99%E7%A8%8B/">教程</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.dreamshelter.cn/blog/source/img/cover/12.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/e25feb6e.html" title="黑马程序员SSM"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/4.png" onerror="onerror=null;src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">黑马程序员SSM</div></div><div class="info-2"><div class="info-item-1"> spring核心概念   目标:充分解耦 使用IoC容器管理bean(IoC) 在IoC容器内将有依赖关系的bean进行关系绑定(DI)   最终效果 使用对象时不仅可以直接从IoC容器中获取，并且获取到的bean已经绑定了所有的依赖关系    IoC入门案例思路分析 管理什么?(Service与Dao) 如何将被管理的对象告知IoC容器?(配置) 被管理的对象交给IoC容器，如何获取到IoC容器?(接口) IoC容器得到后，如何从容器中获取bean?(接口方法) 使用Spring导入哪些坐标?(pom.xm1)  先导入spring依赖，然后新建 这个就是spring的配置文件，取名applicationContext.xml 123456&lt;!--1.导入spring的坐标spring-context，对应版本是5.2.10.RELEASE--&gt;&lt;!--2.配置bean，id随便写，class对应要管理的对象--&gt;&lt;bean id=&quot;bookDao&quot; class=&quot;com.itheima.dao.impl.BookD...</div></div></div></a><a class="pagination-related" href="/posts/2821e645.html" title="饱了么后端"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/27.jpg" onerror="onerror=null;src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">饱了么后端</div></div><div class="info-2"><div class="info-item-1">项目效果前端是小程序，后端是商家管理界面，管理界面需要登录才可以使用，右上角可以切换营业状态，其他都是一些增删改查，然后里面是有真正的支付功能，支付后会告诉商家订单信息，可以选择拒单或者接单，用户会有个等待商户接单界面，也可以进行催单，接单成功后就进入到待派送状态，商家点击派送就进入到派送中状态，如果派送到就可以点击完成按钮进入已完成状态 然后也有数据统计，工作台里记录当天的一些数据 开发准备软件开发流程需求分析需要需求规格说明书   产品原型，一般是静态网页展示   设计： ui设计：会讲这个项目做完后最终的效果是什么样子，小到一个按钮，大到整个页面布局 数据库设计：把类型和数据库有什么关系都设计好 接口设计：比如一个登录功能的接口，请求方式什么样子的，参数路径是什么样子的 编码： 项目代码、单元测试 测试： 测试用例、测试报告 上线运维： 软件环境安装、配置 角色分工 项目经理：对整个项目负责，任务分配、把控进度 产品经理：进行需求调研，输出需求调研文档、产品原型等 UI设计师：根据产品原型输出界面效果图 架构师：项目整体架构设计、技术选型等 开发工程师：代码实现 测试工程师...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/touxiang.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Shelter</div><div class="author-info-description">记录自己的成长日志</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Shelter67"><i class="fab fa-github"></i><span>没有什么star的github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Shelter67" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1830191738@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/8416212" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #fb7299;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的小小博客！都是基于hexo框架使用，魔改了一些地方，表现得有些二次元，有个博客希望能在未来工作简历上成为加分项吧，但是弄起来还真的挺好玩的</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#live2d"><span class="toc-number">1.</span> <span class="toc-text">live2d</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9C%8B%E6%9D%BF%E5%A8%98"><span class="toc-number">2.</span> <span class="toc-text">看板娘</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pwa"><span class="toc-number">3.</span> <span class="toc-text">pwa</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E5%9B%BE%E6%B5%81"><span class="toc-number">4.</span> <span class="toc-text">一图流</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%97%E6%95%B0%E7%BB%9F%E8%AE%A1"><span class="toc-number">5.</span> <span class="toc-text">字数统计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%95%99%E8%A8%80%E6%9D%BF"><span class="toc-number">6.</span> <span class="toc-text">留言板</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#github-action%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2"><span class="toc-number">7.</span> <span class="toc-text">github action自动部署</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%B5%E5%AD%90%E9%92%9F"><span class="toc-number">8.</span> <span class="toc-text">电子钟</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%8D%B8%E8%BD%BD%E6%97%A7%E6%8F%92%E4%BB%B6"><span class="toc-number">8.1.</span> <span class="toc-text">一、卸载旧插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85%E6%96%B0%E7%89%88%E6%8F%92%E4%BB%B6"><span class="toc-number">8.2.</span> <span class="toc-text">二、安装新版插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8%EF%BC%88%E7%AB%99%E7%82%B9%E9%85%8D%E7%BD%AE%E6%88%96%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE%E5%9D%87%E5%8F%AF%EF%BC%89"><span class="toc-number">8.3.</span> <span class="toc-text">三、配置使用（站点配置或主题配置均可）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">8.4.</span> <span class="toc-text">四、关键参数说明</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2%E4%B8%8A%E4%BC%A0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">9.</span> <span class="toc-text">关于博客上传服务器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE"><span class="toc-number">10.</span> <span class="toc-text">音乐播放</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B5%E8%84%9A%E8%AE%A1%E6%97%B6%E5%99%A8%E5%92%8Cgithub%E5%BE%BD%E6%A0%87"><span class="toc-number">11.</span> <span class="toc-text">页脚计时器和github徽标</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE%EF%BC%9A"><span class="toc-number">11.1.</span> <span class="toc-text">添加配置：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%BB%BAAPI"><span class="toc-number">11.2.</span> <span class="toc-text">自建API</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Twikoo%E8%AF%84%E8%AE%BA"><span class="toc-number">12.</span> <span class="toc-text">Twikoo评论</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/da77c56c.html" title="MVC架构设计模式"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/23.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="MVC架构设计模式"/></a><div class="content"><a class="title" href="/posts/da77c56c.html" title="MVC架构设计模式">MVC架构设计模式</a><time datetime="2026-11-14T16:24:00.000Z" title="发表于 2026-11-15 00:24:00">2026-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e25feb6e.html" title="黑马程序员SSM"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/4.png" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="黑马程序员SSM"/></a><div class="content"><a class="title" href="/posts/e25feb6e.html" title="黑马程序员SSM">黑马程序员SSM</a><time datetime="2026-02-03T03:14:00.000Z" title="发表于 2026-02-03 11:14:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/eedaddf.html" title="博客笔记"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/5.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="博客笔记"/></a><div class="content"><a class="title" href="/posts/eedaddf.html" title="博客笔记">博客笔记</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5764bc58.html" title="饱了么前端"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/23.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="饱了么前端"/></a><div class="content"><a class="title" href="/posts/5764bc58.html" title="饱了么前端">饱了么前端</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2821e645.html" title="饱了么后端"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/27.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="饱了么后端"/></a><div class="content"><a class="title" href="/posts/2821e645.html" title="饱了么后端">饱了么后端</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Shelter</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><script src="/js/tw_cn.js?v=5.5.4"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://blog.dreamshelter.cn/twikooapi/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://blog.dreamshelter.cn/twikooapi/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script src="https://fastly.jsdelivr.net/npm/live2d-widgets@1.0.0/dist/autoload.js"></script><div class="aplayer no-destroy" data-id="17745883873" data-server="netease" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-autoplay="true" data-mutex="true" ></div><script id="canvas_nest" defer="defer" color="255,192,203" opacity="0" zIndex="-1" count="80" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"]):not([href=".aside-content"]):not([href="#aside-content"]):not([href=".card-clock
# Inject the css and script (aplayer/meting) aplayerInject: enable: true per_page: true
# 通知弹窗 # Snackbar - Toast Notification # https://github.com/polonel/SnackBar # position: top-left / top-center / top-right / bottom-left / bottom-center / bottom-right snackbar: enable: true position: top-right # The background color of Toast Notification in light mode and dark mode bg_light: "])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      false
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><div id="app-refresh" style="position: fixed; top: -2.2rem; left: 0; right: 0; z-index: 99999; padding: 0 1rem; font-size: 15px; height: 2.2rem; transition: all 0.3s ease;"><div class="app-refresh-wrap" style="display: flex; color: #fff; height: 100%; align-items: center; justify-content: center;"><label>🚀 有新内容发布啦！</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color: #fff; text-decoration: underline; cursor: pointer; margin-left: 8px;">点击刷新</span></a></div></div><script>if ('serviceWorker' in navigator) {
  // 如果当前页面受 Service Worker 控制，监听控制权变化
  if (navigator.serviceWorker.controller) {
    navigator.serviceWorker.addEventListener('controllerchange', function() {
      showNotification();
    });
  }

  // 页面加载完成后注册 sw.js
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js').catch(err => {
      console.error('PWA 注册失败:', err);
    });
  });
}

function showNotification() {
  // 优先使用主题自带的 Snackbar 弹窗
  if (window.GLOBAL_CONFIG && GLOBAL_CONFIG.Snackbar) {
    var snackbarBg = document.documentElement.getAttribute('data-theme') === 'light' ?
      GLOBAL_CONFIG.Snackbar.bgLight :
      GLOBAL_CONFIG.Snackbar.bgDark;
    
    var snackbarPos = GLOBAL_CONFIG.Snackbar.position;

    Snackbar.show({
      text: '🚀 有新文章发布啦！',
      backgroundColor: snackbarBg,
      duration: 10000, // 持续 10 秒
      pos: snackbarPos,
      actionText: '点击刷新',
      actionTextColor: '#fff',
      onActionClick: function(e) {
        location.reload();
      },
    });
  } else {
    // 如果没有 Snackbar，则显示顶部的 app-refresh 栏
    var showBg = document.documentElement.getAttribute('data-theme') === 'light' ? '#49b1f5' : '#1f1f1f';
    var appRefresh = document.getElementById('app-refresh');
    if (appRefresh) {
      appRefresh.style.cssText = 'top: 0; background: ' + showBg + ';';
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索点什么呢………" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://vercelapi.dreamshelter.cn/api?user=shelter67";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="shelter67";
            var parent_div_git = document.getElementsByClassName('layout')[0];
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/gongxianban/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementsByClassName('layout')[0]){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementsByClassName('footer-other')[0];
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v8.1.1" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v5.5.4" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://cloud.tencent.com/" style="margin-inline:5px" data-title="本站由腾讯云提供服务器支持" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Server-Tencent%20Cloud-00A4FF?style=flat&amp;logo=qq&amp;logoColor=white" alt=""/></a><a class="github-badge" target="_blank" href="https://edgeone.ai/" style="margin-inline:5px" data-title="本站由腾讯云 EdgeOne 提供安全加速" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-EdgeOne-00A4FF?style=flat&amp;logo=iCloud&amp;logoColor=white" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn/" style="margin-inline:5px" data-title="工业和信息化部ICP备案管理系统" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E9%B2%81ICP%E5%A4%87-2025199346%E5%8F%B7--1-ba9132?style=flat&amp;labelColor=443d38" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="https://www.fomal.cc/static/js/runtime.js"></script><script data-pjax>
function hexo_butterfly_clock_remake_injector_config(){
  var parent_div_git;
  var item_html = `<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>`;

  // 按类型获取容器
  if ('class' === 'class') {
    parent_div_git = document.getElementsByClassName('aside-content')[0];
  } else if ('class' === 'id') {
    parent_div_git = document.getElementById('aside-content');
  } else {
    parent_div_git = document.getElementById('aside-content');
  }

  if(parent_div_git){
    var reference_el_before = null;
    var reference_el_after = parent_div_git.querySelector('.card-announcement');

    if(reference_el_before){
      parent_div_git.insertBefore(
        (function(){var temp = document.createElement('div'); temp.innerHTML = item_html; return temp;}()),
        reference_el_before
      );
    } else if(reference_el_after){
      reference_el_after.insertAdjacentHTML('afterend', item_html);
    } else {
      parent_div_git.insertAdjacentHTML('afterbegin', item_html);
    }
  }
}

console.log('已挂载 butterfly_clock_anzhiyu-yang 修复版');

// ---------- 全局变量声明 ----------
var cpage = location.pathname;
var epage = 'all';
var qweather_key = '0df3cf714a324957b16f3201e86fe931';
var qweather_api_host = 'https://p65ctvhqy4.re.qweatherapi.com';
var default_city = '';
var gaud_map_key = '296709bdb591a3523a2cf60e8e8f0ba3';

// ---------- 页面过滤 ----------
var elist = 'null'.split(',');
var flag = 0;
for(var i=0;i<elist.length;i++){
  if(cpage.includes(elist[i])) flag++;
}

if((epage === 'all') && (flag == 0)){
  hexo_butterfly_clock_remake_injector_config();
} else if(epage === cpage){
  hexo_butterfly_clock_remake_injector_config();
}
</script><script data-pjax src="/js/clock-min.js"></script><!-- hexo injector body_end end --></body></html>