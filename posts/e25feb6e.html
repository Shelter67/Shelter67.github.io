<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><link rel=manifest href=/manifest.json><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>黑马程序员SSM | Shelter</title><meta name="author" content="Shelter"><meta name="copyright" content="Shelter"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="spring核心概念   目标:充分解耦 使用IoC容器管理bean(IoC) 在IoC容器内将有依赖关系的bean进行关系绑定(DI)   最终效果 使用对象时不仅可以直接从IoC容器中获取，并且获取到的bean已经绑定了所有的依赖关系    IoC入门案例思路分析 管理什么?(Service与Dao) 如何将被管理的对象告知IoC容器?(配置) 被管理的对象交给IoC容器，如何获取到IoC容">
<meta property="og:type" content="article">
<meta property="og:title" content="黑马程序员SSM">
<meta property="og:url" content="http://localhost:4000/posts/e25feb6e.html">
<meta property="og:site_name" content="Shelter">
<meta property="og:description" content="spring核心概念   目标:充分解耦 使用IoC容器管理bean(IoC) 在IoC容器内将有依赖关系的bean进行关系绑定(DI)   最终效果 使用对象时不仅可以直接从IoC容器中获取，并且获取到的bean已经绑定了所有的依赖关系    IoC入门案例思路分析 管理什么?(Service与Dao) 如何将被管理的对象告知IoC容器?(配置) 被管理的对象交给IoC容器，如何获取到IoC容">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.dreamshelter.cn/blog/source/img/cover/26.jpg">
<meta property="article:published_time" content="2026-02-03T03:14:00.000Z">
<meta property="article:modified_time" content="2026-02-09T10:05:53.841Z">
<meta property="article:author" content="Shelter">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="SSM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.dreamshelter.cn/blog/source/img/cover/26.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "黑马程序员SSM",
  "url": "http://localhost:4000/posts/e25feb6e.html",
  "image": "https://cdn.dreamshelter.cn/blog/source/img/cover/26.jpg",
  "datePublished": "2026-02-03T03:14:00.000Z",
  "dateModified": "2026-02-09T10:05:53.841Z",
  "author": [
    {
      "@type": "Person",
      "name": "Shelter",
      "url": "https://github.com/Shelter67"
    }
  ]
}</script><link rel="shortcut icon" href="https://cdn.dreamshelter.cn/blog/source/img/favicon.png"><link rel="canonical" href="http://localhost:4000/posts/e25feb6e.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#49b1f5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/128.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="mask-icon" href="/img/siteicon/128.png" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":3,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '黑马程序员SSM',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><style>#waifu { left: auto !important; right: 20px !important; }</style><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/clock-min.css" /><link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.1"></head><body><div class="bg-animation" id="web_bg" style="background-image: url(https://cdn.dreamshelter.cn/blog/source/img/background.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/touxiang.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuifan.html"><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuiju.html"><i class="fa-fw fas fa-video"></i><span> 追剧</span></a></div><div class="menus_item"><a class="site-page" href="/gongxianban"><i class="fa-fw fab fa-github-alt"></i><span> 贡献板</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.dreamshelter.cn/blog/source/img/cover/26.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Shelter</span></a><a class="nav-page-title" href="/"><span class="site-name">黑马程序员SSM</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuifan.html"><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuiju.html"><i class="fa-fw fas fa-video"></i><span> 追剧</span></a></div><div class="menus_item"><a class="site-page" href="/gongxianban"><i class="fa-fw fab fa-github-alt"></i><span> 贡献板</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">黑马程序员SSM</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-03T03:14:00.000Z" title="发表于 2026-02-03 11:14:00">2026-02-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-09T10:05:53.841Z" title="更新于 2026-02-09 18:05:53">2026-02-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">37k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>144分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2026-02-09 18:05:53&quot;}" hidden></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251117154216907.png" alt="image-20251117154216907"></p>
<h1 id="spring"><a href="#spring" class="headerlink" title="spring"></a>spring</h1><h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251117154611993.png" alt="image-20251117154611993"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251117155539816.png" alt="image-20251117155539816"></p>
<ul>
<li>目标:充分解耦<ul>
<li>使用IoC容器管理bean(IoC)</li>
<li>在IoC容器内将有依赖关系的bean进行关系绑定(DI)</li>
</ul>
</li>
<li>最终效果<ul>
<li>使用对象时不仅可以直接从IoC容器中获取，并且获取到的bean已经绑定了所有的依赖关系</li>
</ul>
</li>
</ul>
<h2 id="IoC入门案例思路分析"><a href="#IoC入门案例思路分析" class="headerlink" title="IoC入门案例思路分析"></a>IoC入门案例思路分析</h2><ol>
<li>管理什么?(Service与Dao)</li>
<li>如何将被管理的对象告知IoC容器?(配置)</li>
<li>被管理的对象交给IoC容器，如何获取到IoC容器?(接口)</li>
<li>IoC容器得到后，如何从容器中获取bean?(接口方法)</li>
<li>使用Spring导入哪些坐标?(pom.xm1)</li>
</ol>
<p>先导入spring依赖，然后新建<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251117160116095.png" alt="image-20251117160116095"></p>
<p>这个就是spring的配置文件，取名applicationContext.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--1.导入spring的坐标spring-context，对应版本是5.2.10.RELEASE--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--2.配置bean，id随便写，class对应要管理的对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.BookServiceImpl&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App2</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[]args)</span>&#123;</span><br><span class="line">	<span class="comment">//3.获取ToC容器</span></span><br><span class="line">		<span class="type">Applicationcontext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">classPathXmlApplicationcontext</span>( configLocation: <span class="string">&quot;applicationcontext.xml&quot;</span>),</span><br><span class="line">	<span class="comment">//4.获取bean</span></span><br><span class="line">		<span class="type">BqokDao</span> <span class="variable">bookDao</span> <span class="operator">=</span>(BookDao)ctx.getBean( s:<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">		bookDao.save();</span><br></pre></td></tr></table></figure>

<h2 id="DI入门案例思路分析"><a href="#DI入门案例思路分析" class="headerlink" title="DI入门案例思路分析"></a>DI入门案例思路分析</h2><ol>
<li>基于IoC管理bean</li>
<li>Service中使用new形式创建的Dao对象是否保留?(否)</li>
<li>Service中需要的Dao对象如何进入到Service中?(提供方法)</li>
<li>Service与Dao间的关系如何描述?(配置)</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">Bookservice</span> &#123;</span><br><span class="line">    <span class="comment">//5.删除业务层中使用new的方式创建的dao对象</span></span><br><span class="line">	<span class="comment">//private BookDao bookDao = hew BookDaoImpl();</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">		bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//6.提供对应的set方法</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span>&#123;</span><br><span class="line">		<span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com,itheima.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--7.既置server与dao的关系--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--property标签表小配置当前bean的属性</span></span><br><span class="line"><span class="comment">	name届性表小配置哪一个具体的属性</span></span><br><span class="line"><span class="comment">	ref属性表小参照哪-个bean--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="bean"><a href="#bean" class="headerlink" title="bean"></a>bean</h2><h3 id="bean基础配置"><a href="#bean基础配置" class="headerlink" title="bean基础配置"></a>bean基础配置</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251117193854510.png" alt="image-20251117193854510"></p>
<p>以下是新的bean配置文件，可以通过name增加别名，用逗号、分号和空格分隔，但还是推荐id起名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookservice&quot;</span> <span class="attr">name</span>=<span class="string">&quot;service service2 bookEbi&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.BookseryiceImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">name</span>=<span class="string">&quot;dao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果命名出现问题，就会出现NoSuchBeanDefinitionException Create breakpoint : No bean named ‘service4’ available的报错</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251117195050515.png" alt="image-20251117195050515"></p>
<p>bean作用范围：默认创建出来的是同一个对象</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251117195227957.png" alt="image-20251117195227957"></p>
<ul>
<li>为什么bean默认为单例 ?如果不是单例就会执行一次造一次对象，但其实可以用同一个对象（也就是可复用）</li>
<li>适合交给容器进行管理的bean<ul>
<li>表现层对象</li>
<li>业务层对象</li>
<li>数据层对象</li>
<li>工具对象</li>
</ul>
</li>
<li>不适合交给容器进行管理的bean<ul>
<li>封装实体的域对象</li>
</ul>
</li>
</ul>
<h3 id="bean实例化"><a href="#bean实例化" class="headerlink" title="bean实例化"></a>bean实例化</h3><p>查看异常的方法是从下往上看，越往上越详细</p>
<p>方式有三种</p>
<p>一：构造方法（常用）</p>
<ul>
<li>提供可访问的构造方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">BookDaoImpl</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.printIn(<span class="string">&quot;book constructor is running...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span></span></span><br><span class="line"><span class="tag"><span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>无参构造方法如果不存在，将抛出异常BeancreationException</li>
</ul>
<p>二：使用静态工厂实例化bean（以前常用）</p>
<p>这里class造出来的是工厂对象，但我们需要的不是这个工厂，所以用后面那个配置工厂里面真正用来造对象的方法名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.factory.OrderDaoFactory&quot;</span> <span class="attr">Factory-method</span>=<span class="string">&quot;getOrderDao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//静态工厂</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderDaoFactory</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> orderDao <span class="title function_">getOrderDao</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OrderDaoImpl</span>();</span><br></pre></td></tr></table></figure>

<p>三：使用实例工厂实例化bean（了解）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--先配出工厂，再把工厂id放进下面bean里，实例方法写method--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.factory.UserDaoFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getUserDao&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;userFactory&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppForInstanceUser</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[] args)</span>&#123;</span><br><span class="line">        <span class="type">Applicationcontext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">classPathXmlApplicationContext</span>(<span class="string">&quot;applicationcontext.xml&quot;</span>);</span><br><span class="line">        UserDao userDao=(UserDao)ctx.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">		userDao.save();</span><br></pre></td></tr></table></figure>

<p>四:使用FactoryBean实例化bean（重点）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.factory.UserDaoFactoryBean&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//利用泛型来获取对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoFactoryBean</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;UserDao&gt; &#123;</span><br><span class="line">	<span class="comment">//代替原始实例工厂中创建对象的方法，造出来的是UserDao</span></span><br><span class="line">	<span class="keyword">public</span> UserDao <span class="title function_">getobject</span><span class="params">()</span><span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>();</span><br><span class="line">	<span class="keyword">public</span> class&lt;?&gt;getobjectType()&#123;</span><br><span class="line">		<span class="keyword">return</span> UserDao.class;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//如果是true就是单例（默认，输出内存地址一样），false变成非单例</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">issingleton</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="bean生命周期"><a href="#bean生命周期" class="headerlink" title="bean生命周期"></a>bean生命周期</h3><ul>
<li>生命周期:从创建到消亡的完整过程</li>
<li>bean生命周期:bean从创建到销毁的整体过程</li>
<li>bean生命周期控制:在bean创建后到销毁前做一些事情</li>
</ul>
<p>管理生命周期通过java代码有以下两种，但其实可以交给Tomcat管理，所以是白学</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.imp1.BookDaoImp1&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">dastroy-method</span>=<span class="string">&quot;destory&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppForLifecycle</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[]args )</span>&#123;</span><br><span class="line">    <span class="comment">//Applicationcontext没有close这个方法，但子类有，就改成它的子类</span></span><br><span class="line">	<span class="comment">//Applicationcontext ctx = new ClassPathXmlApplicationContext( configLocation: &quot;applicationcontext.xm1&quot;)</span></span><br><span class="line">    <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>( configLocation: <span class="string">&quot;applicationcontext.xm1&quot;</span>)</span><br><span class="line">	BookDao bookDao=(BookDao)ctx.getBean(s:<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">	bookDao.save();</span><br><span class="line">    <span class="comment">//这个方法是直接关闭容器，比较暴力，位置改动会影响结果</span></span><br><span class="line">    ctx.close();</span><br><span class="line">    <span class="comment">//注册关闭钩子，容器在启动之后如果虚拟机要关闭就要先把容器关闭，位置改动不影响结果</span></span><br><span class="line">    ctx.registerShutdownHook();     </span><br></pre></td></tr></table></figure>

<p>也可以通过实现接口的方式管理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span>, InitializingBean ,DisposableBean &#123;</span><br><span class="line">    <span class="comment">//然后实现里面的方法就行了</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;destroy&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//这个方法的意思是属性设置之后</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;afterPropertiesset&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>bean在整个初始化过程中经历的阶段：</p>
<ul>
<li>初始化容器</li>
</ul>
<ol>
<li>创建对象(内存分配)</li>
<li>执行构造方法</li>
<li>执行属性注入(set操作 )</li>
<li>执行bean初始化方法</li>
</ol>
<ul>
<li>使用bean</li>
</ul>
<ol>
<li>执行业务操作</li>
</ol>
<ul>
<li>关闭&#x2F;销毁容器</li>
</ul>
<ol>
<li>执行bean销毁方法</li>
</ol>
<p>bean销毁时机</p>
<ul>
<li><p>容器关闭前触发bean的销毁</p>
</li>
<li><p>关闭容器方式</p>
<ul>
<li><p>手工关闭容器：</p>
<p>ConfigurableApplicationcontext接close()操作</p>
</li>
<li><p>注册关闭钩子，在虚拟机退出前先关闭容器再退出虚拟机：</p>
<p>ConfigurableApplicationcontext接registerShutdownHook()操作</p>
</li>
</ul>
</li>
</ul>
<h2 id="依赖注入方式"><a href="#依赖注入方式" class="headerlink" title="依赖注入方式"></a>依赖注入方式</h2><ul>
<li>思考:向一个类中传递数据的方式有几种 ?<ul>
<li>普通方法(set方法)</li>
<li>构造方法</li>
</ul>
</li>
<li>思考:依赖注入描述了在容器中建立bean与bean之间依赖关系的过程,如果bean运行需要的是数字或字符串呢 ?<ul>
<li>引用类型</li>
<li>简单类型(基本数据类型与string</li>
</ul>
</li>
<li>依赖注入方式<ul>
<li>setter注入<ul>
<li>简单类型</li>
<li>引用类型</li>
</ul>
</li>
<li>构造器注入<ul>
<li>简单类型</li>
<li>引用类型</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="setter引用类型"><a href="#setter引用类型" class="headerlink" title="setter引用类型"></a>setter引用类型</h3><p>在bean中定义引用类型属性并提供可访问的set方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span>&#123;</span><br><span class="line">		<span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>配置中使用property标签ref属性注入引用类型对象</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ref后面的是下面的bean名称，用作引用bean，如果是基本类型用value，name是java里的--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="setter简单类型"><a href="#setter简单类型" class="headerlink" title="setter简单类型"></a>setter简单类型</h3><p>在bean中定义引用类型（基本数据类型也可以）属性并提供可访问的set方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> connectionNum;</span><br><span class="line">	<span class="keyword">private</span> String databaseName;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setConnectionNum</span><span class="params">(<span class="type">int</span> connectionNum)</span>&#123;</span><br><span class="line">		<span class="built_in">this</span>.connectionNum = connectionNum;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDatabaseName</span><span class="params">(string databaseName)</span></span><br><span class="line">		<span class="built_in">this</span>.databaseName =databaseName;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>配置中使用property标签value属性注入简单类型数据</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span><span class="attr">.</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;databaseName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connectionNum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="构造器注入-简单类型（了解）"><a href="#构造器注入-简单类型（了解）" class="headerlink" title="构造器注入-简单类型（了解）"></a>构造器注入-简单类型（了解）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> string databaseName;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> connectionNum;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">BookDaoImpl</span><span class="params">(string database,<span class="type">int</span> connectionNum)</span>&#123;</span><br><span class="line">		<span class="built_in">this</span>.databaseName =database;</span><br><span class="line">		<span class="built_in">this</span>.connectionNum = connectionNum;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里的property位置换成了constructor-arg，一般了解这个就行</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--标准书写--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl”&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">	&lt;constructor-arg name=&quot;</span><span class="attr">connectionNum</span>” <span class="attr">value</span>=<span class="string">”10</span>&quot;/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;databaseName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysqL&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.UserDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>把构造方法名改成了直接写类型，但是如果有重复类型就会出问题</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--解决形参名称的问题，与形参名不合--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;int” value=&quot;</span><span class="attr">10</span>&quot;/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>解决参数类型重复问题，使用下标位置解决参数匹配</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>依赖注入方式选择：</p>
<ol>
<li>强制依赖（bean运行必须要的东西）使用构造器进行，使用setter注入有概率不进行注入导致null对象出现</li>
<li>可选依赖使用setter注入进行，灵活性强</li>
<li>Spring框架倡导使用构造器，第三方框架内部大多数采用构造器注入的形式进行数据初始化，相对严谨</li>
<li>如果有必要可以两者同时使用,使用构造器注入完成强制依赖的注入，使用setter注入完成可选依赖的注入</li>
<li>实际开发过程中还要根据实际情况分析，如果受控对象没有提供setter方法就必须使用构造器注入</li>
<li>自己开发的模块推荐使用setter注入</li>
</ol>
<h3 id="自动装配"><a href="#自动装配" class="headerlink" title="自动装配"></a>自动装配</h3><ul>
<li>IoC容器根据bean所依赖的资源在容器中自动查找并注入到bean中的过程称为自动装配</li>
<li>自动装配方式<ul>
<li>按类型(常用)</li>
<li>按名称</li>
<li>按构造方法</li>
<li>不启用自动装配</li>
</ul>
</li>
</ul>
<p>这里用按类型配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookserviceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    <span class="comment">//这个set方法不可以省略</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span>&#123;</span><br><span class="line">		<span class="built_in">this</span>.bookDao = bookDao;</span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--这里的dao也需要是唯一的，如果有多个就可以使用byName--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--autowire里有五种，按需使用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.BookServiceImpl&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>依赖自动装配特征：</p>
<ul>
<li>自动装配用于引用类型依赖注入，不能对简单类型进行操作（简单类型比如数字这种，就不需要注入bean了）</li>
<li>使用按类型装配时(byType)必须保障容器中相同类型的bean唯一，推荐使用</li>
<li>使用按名称装配时(byName)必须保障容器中具有指定名称的bean，因变量名与配置耦合，不推荐使用</li>
<li>自动装配优先级低于setter注入与构造器注入，同时出现时自动装配配置失效</li>
</ul>
<h3 id="集合注入"><a href="#集合注入" class="headerlink" title="集合注入"></a>集合注入</h3><p>就学个格式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span>[] array;</span><br><span class="line">	<span class="keyword">private</span> List&lt;string&gt; list;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;string&gt; set;</span><br><span class="line">	<span class="keyword">private</span> Map&lt;string,string&gt; map;</span><br><span class="line">	<span class="keyword">private</span> Properties properties;</span><br><span class="line">	    </span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setArray</span><span class="params">(<span class="type">int</span>[]array)</span>&#123;<span class="built_in">this</span>.array = array; &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;array&quot;</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">	    	<span class="tag">&lt;<span class="name">value</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">	    	<span class="tag">&lt;<span class="name">value</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;set&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--重复的值会自动过滤--&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">	    	<span class="tag">&lt;<span class="name">value</span>&gt;</span>xxx<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--重复的值会自动过滤--&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">	    	<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;x&quot;</span> <span class="attr">value</span>=<span class="string">&quot;x&quot;</span>/&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--重复的值会自动过滤--&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">	    	<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;x&quot;</span>&gt;</span>x<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h2 id="案例-数据源对象管理"><a href="#案例-数据源对象管理" class="headerlink" title="案例:数据源对象管理"></a>案例:数据源对象管理</h2><p>管理第三方的bean</p>
<p>思考用构造方法还是set方法注入，这个的话得看这个类是怎么写的，这里是找到了set相关的方法</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--管理DruidDataSource对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverclassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://1ocalhost:3306/spring_db&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>随便输出一下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[l args)</span>&#123;</span><br><span class="line">		<span class="type">Applicationcontext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">classPathXmlApplicationcontext</span>( configLocation: <span class="string">&quot;applicationcontext.xml&quot;</span>);</span><br><span class="line">		<span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span>(DataSource)ctx.getBean( s:<span class="string">&quot;dataSource&quot;</span>);</span><br><span class="line">		System.out.println(dataSource);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="加载properties文件"><a href="#加载properties文件" class="headerlink" title="加载properties文件"></a>加载properties文件</h2><p>第一步开启context命名空间，下面的context就是新加的命名空间</p>
<p>第二步使用context空问加载properties文件</p>
<p>第三步使用属性占位待${}读取properties 文件中的属性</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--第一步开启context命名空间，下面的context就是新加的命名空间--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmIns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&#x27;</span></span></span><br><span class="line"><span class="string"><span class="tag">	xmlns:xsi=&quot;</span><span class="attr">http:</span>//<span class="attr">www.w3.org</span>/<span class="attr">2001</span>/<span class="attr">XMLSchema-instance</span>&quot;</span></span><br><span class="line"><span class="tag">    <span class="attr">下面这个xmlns:就是开了一个新的namespace</span>，<span class="attr">命名空间叫做context</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/beans       </span></span></span><br><span class="line"><span class="string"><span class="tag">    	http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">		http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       &quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--2.使用context空问加载properties文件--&gt;</span></span><br><span class="line">    这个叫属性占位符，location是指定要加载的文件</span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--3.使用属性占位待$&#123;&#125;读取properties 文件中的属性--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSpurce&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverclassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>环境变量问题：</p>
<p>​	有个需要注意的是如果value里的占位符改成username会出问题，这是因为系统中有一个环境变量叫username，会和这里要读取的username冲突，系统的环境变量比这里的优先级高</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>解决方法是在上面的context里加个参数就不会加载环境变量了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>如何加载多个配置文件：</p>
<ul>
<li>方式一(不理想)：在location的里面用逗号分隔添加多个</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties,jdbc2.properties&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>方式二（规范格式）：名称用*代替，加载所有配置文件，在前面加上类路径，但是只能读取当前工程里的配置文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;calsspath:*.properties&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>方式三（标准）：calsspath后面再加一个星号，这样可以从依赖的jar包读，也可以从自己的工程读</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;calsspath*:*.properties&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h2><p>加载配置文件有两种方法：</p>
<p>1.加载类路径下的配置文件（用这个）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Applicationcontext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">classPathXmlApplicationcortext</span>(<span class="string">&quot;applicationcontext.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>2.从文件系统下加载配置文件，用的绝对路径</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Applicationcontext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">classPathXmlApplicationcortext</span>(<span class="string">&quot;D:\\xxxx\\xxx.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>3.加载多个配置文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Applicationcontext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">classPathXmlApplicationcontext</span>(<span class="string">&quot;bean1.xml&quot;</span>, <span class="string">&quot;bean2.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>获取bean：</p>
<p>1.利用bean名称和强制转换</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BookDao bookDao=(BookDao)ctx.getBean( <span class="string">&quot;bookDao&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>2.前面获取bean的名称后面获取bean的类型，以上两种没有什么区别</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;bookDao&quot;</span>,BookDao.class);</span><br></pre></td></tr></table></figure>

<p>3.按照类型获取bean，但是这种有个问题就是容器中对应的bean只能有一个，如果有多个bean就会不唯一</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> ctx.getBean(BookDao.class);</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251122183336605.png" alt="image-20251122183336605"></p>
<p>这个是最早期的容器初始化方案（已过时）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppForBeanFactory</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[] args)</span>&#123;</span><br><span class="line">        <span class="comment">//获取资源文件</span></span><br><span class="line">		<span class="type">Resource</span> <span class="variable">resources</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">classPathResource</span>(<span class="string">&quot;applicationcontext.xml&quot;</span>),</span><br><span class="line">		BeanFactory bf=<span class="keyword">new</span> <span class="title class_">XmlBeanFactory</span>(resources);</span><br><span class="line">		BookDao bookDao=bf.getBean(BookDao.class);</span><br><span class="line">		bookDao.save();</span><br></pre></td></tr></table></figure>

<p>BeanFactory和applicationcontext的区别：BeanFactory创建完毕后，所有的bean是延迟加载，applicationcontext是立即加载，如果applicationcontext也想延迟加载可以在配置文件里添加lazy-init</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.BookDaoImpl&quot;</span> <span class="attr">lazy-init</span>=<span class="string">&#x27;true&quot;/&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="容器相关"><a href="#容器相关" class="headerlink" title="容器相关"></a>容器相关</h3><ul>
<li>BeanFactory是IoC容器的顶层接口，初始化BeanFactory对象时，加载的bean延迟加载</li>
<li>Applicationcontext接口是Spring容器的核心接口，初始化时bean立即加载</li>
<li>Applicationcontext接口提供基础的bean操作相关方法，通过其他接口扩展其功能</li>
<li>Applicationcontext接口常用初始化类<ul>
<li>ClassPathXmlApplicationContext</li>
<li>FileSystemXmlApplicationContext（几乎不用）</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251122205935752.png" alt="image-20251122205935752"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251122211918710.png" alt="image-20251122211918710"></p>
<h2 id="注解开发"><a href="#注解开发" class="headerlink" title="注解开发"></a>注解开发</h2><p>示例：这里的**@Component**是组件的意思，代表的是xml文件中的<bean>，后面就是bean的名字，这个名字可以默认不写，默认的话就是空的。加上这个注解，在xml中的<bean>标签就可以不用写了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;bookDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	publis <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">        </span><br><span class="line">有bean名用BookDao)ctx.getBean(s:<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">无bean名用ctx.getBean(BookService.class);</span><br></pre></td></tr></table></figure>

<p>但使用了这个注解也需要spring知道这个，就需要在xml里配置，context:component-scan用于扫描，base-package是指定的位置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.itheima.dao.impl&quot;</span>/&gt;</span></span><br><span class="line">com.itheima也可以，这样扫描的就是itheima下所有的</span><br></pre></td></tr></table></figure>

<h3 id="注解开发bean"><a href="#注解开发bean" class="headerlink" title="注解开发bean"></a>注解开发bean</h3><ul>
<li>Spring提供@Component注解的三个衍生注解<ul>
<li>@Controller:用于表现层bean定义</li>
<li>@service:用于业务层bean定义</li>
<li>@Repository:用于数据层bean定义</li>
</ul>
</li>
</ul>
<h3 id="纯注解开发"><a href="#纯注解开发" class="headerlink" title="纯注解开发"></a>纯注解开发</h3><ul>
<li>Spring3.0升级了纯注解开发模式，使用Java类替代配置文件，开启了Spring快速开发赛道</li>
</ul>
<p>也就是不写配置文件了，换个形式，新建一个config包下的SpringConfig类来代替配置文件，只需要用**@Configuration**就可以代表这个是配置类了，代表的是下图这些</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251122215255200.png" alt="image-20251122215255200"></p>
<p>然后用@ComponentScan代替，但是要带上包的路径</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.itheima&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>替换完是这样的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springconfig</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>但用注解的话启动程序就也要跟着改，因为原本是需要配置文件来启动的，新建一个AppForAnnotation，new的接口不一样了，剩下的都一样</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppForAnnotation</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[] args)</span>&#123;</span><br><span class="line">        <span class="comment">//换了个接口new，意思是注解配置容器，括号里是配置类</span></span><br><span class="line">		<span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationcontext</span>(springconfig.class)</span><br><span class="line">     	<span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao)ctx.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">		System.out.println(bookDao);</span><br><span class="line">		<span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> ctx.getBean(BookService.class);</span><br><span class="line">		System.out.println(bookService);   </span><br></pre></td></tr></table></figure>

<ul>
<li><p>读取Spring核心配置文件初始化容器对象切换为读取Java配置类初始化容器对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载配置文件初始化容器</span></span><br><span class="line">ApplicationContext ctx= <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationcontext.xml&quot;</span>);</span><br><span class="line"><span class="comment">//加载配置类初始化容器</span></span><br><span class="line">ApplicationContext ctx= <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br></pre></td></tr></table></figure>
</li>
<li><p>@Configuration注解用于设定当前类为配置类</p>
</li>
<li><p>@Componentscan注解用于设定扫描路径，此注解只能添加一次，多个数据请用数组格式</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Componentscan(&#123;&quot;com.itheima.service&quot;,&quot;com.itheima.dao&quot;&#125;)</span></span><br></pre></td></tr></table></figure>

<h3 id="bean管理和生命周期"><a href="#bean管理和生命周期" class="headerlink" title="bean管理和生命周期"></a>bean管理和生命周期</h3><p>注解@Scope(“singleton”)就可以让bean变成单例，prototype是非单例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="meta">@scope(&quot;singleton&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="meta">@PostConstruct</span><span class="comment">//这个意思是构造方法之后运行</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;init ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="meta">@PreDestroy</span><span class="comment">//这个是彻底销毁前运行的方法</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;destroy ...&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>上面的两个注解弹幕说java8之后就不用了，如果执行后没有销毁，就是需要在运行方法那里使用关闭容器的方式来做，ctx.close();</p>
<h3 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h3><p>比如说下面这个程序是存在dao没有注入成功的问题，需要@Autowired这个注解来注入，这个是按<strong>类型装配</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookserviceImpl</span> <span class="keyword">implements</span> <span class="title class_">Bookservice</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span>&#123;</span><br><span class="line">		<span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">		bookDao.save();</span><br></pre></td></tr></table></figure>

<p>然后发现这个@Autowired注解放在哪里都不影响结果，所以这个set方法不要了也没问题，这个是使用反射里边的暴力反射给它直接加值了</p>
<p>如果是多个dao那就用按名称装配，之前的dao类里的@Repository注解后面加上名字比如(“bookDao”)，这样用@Autowired注入bookDao时就按照上面的名字去寻找了。但这种有多个相同的bean推荐使用@Qualifier来指定名称，想注入谁就写谁，并且@Autowired不能删除。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Qualifier(&quot;bookDao2&quot;)</span><span class="comment">//找dao类里有@Repository(&quot;bookDao2&quot;)这个注解的</span></span><br><span class="line"><span class="keyword">private</span> BookDao bookDao;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>使用@Autowired注解开启自动装配模式(按类型)</p>
</li>
<li><p>注意：自动装配基于反射设计创建对象并暴力反射对应属性为私有属性初始化数据，因此无需提供setter方法</p>
</li>
<li><p>注意：自动装配建议使用无参构造方法创建对象(默认)，如果不提供对应构造方法，请提供唯一的构造方法</p>
</li>
<li><p>使用@Qualifier注解开启指定名称装配bean</p>
</li>
<li><p>注意：@Qualifier注解无法单独使用，必须配合@Autowired注解使用</p>
</li>
</ul>
<p>简单类型怎么用？@Value</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository(&quot;bookDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="meta">@Value(&quot;itheima666&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> string name;<span class="comment">//这样就把itheima666注入到name里了</span></span><br></pre></td></tr></table></figure>

<p>如果这个value值是从外部的properties文件获取，应该怎么获取</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name</span>=<span class="string">123</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;jdbc.properties&quot;)</span><span class="comment">//属性源</span></span><br><span class="line"><span class="comment">//多个的写法@PropertySource(&#123;&quot;jdbc.properties&quot;,&quot;jdbc.properties&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springconfig</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">上面的value后面改成(<span class="string">&quot;$&#123;name&#125;&quot;</span>)就行了</span><br></pre></td></tr></table></figure>

<p>注意配置文件的名字不支持通配符*</p>
<h3 id="第三方bean管理"><a href="#第三方bean管理" class="headerlink" title="第三方bean管理"></a>第三方bean管理</h3><ul>
<li>使用@Bean配置第三方bean</li>
</ul>
<p>​		这个springconfig里就不放那个扫描注解了，这里不能直接把配置写在人家的源代码里，所以要自己写，但这些三方配置都写这一个文件里就太多了，所以要拆出去</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">	<span class="comment">//1.定义一个方法获得要管理的对象</span></span><br><span class="line">	<span class="comment">//2.添加@Bean，表示当前方法的返回值是一个bean</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> Datasource <span class="title function_">datasource</span><span class="params">()</span>&#123;</span><br><span class="line">		DruidDataSource ds=<span class="keyword">new</span> <span class="title class_">DruidDatasource</span>();</span><br><span class="line">		ds.setDriverclassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">    	ds.setUrl(<span class="string">&quot;jdbc:mysq1://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">		ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">		ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> ds;</span><br></pre></td></tr></table></figure>

<p>拆出去一般就是专门的类管理，使用独立的配置类管理第三方bean，比如jdbcConfig，然后把上面的代码拿到jdbcConfig里面，但是这样会导致springconfig识别不到，解决方法有两种</p>
<ol>
<li>扫描式（不推荐使用），把这个类也加上@Configuration，然后在SpringConfig里加上扫包注解@ComponentScan，不推荐的原因是下面这个类也写了@Configuration，而且SpringConfig看不出到底加载了哪些配置类</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> Datasource <span class="title function_">datasource</span><span class="params">()</span>&#123;</span><br><span class="line">		DruidDataSource ds=<span class="keyword">new</span> <span class="title class_">DruidDatasource</span>();</span><br><span class="line">		ds.setDriverclassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">~~~</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>导入式，使用@Import注解手动加入配置类到核心配置，此注解只能添加一次，多个数据请用数组格式</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Import(JdbcConfig.java)</span>多个就是(&#123;xxx.java,xxx.java&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br></pre></td></tr></table></figure>

<h3 id="为第三方bean注入资源"><a href="#为第三方bean注入资源" class="headerlink" title="为第三方bean注入资源"></a>为第三方bean注入资源</h3><p>对于简单类型的方式：使用@Value</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Jdbcconfig</span>&#123;</span><br><span class="line">	<span class="meta">@Value(&quot;com.mysql.jdbc.Driver&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> string driver;</span><br><span class="line">	<span class="meta">@Value(&quot;jdbc:mysql:/localhost:3306/spring_db&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> string url;</span><br></pre></td></tr></table></figure>
<pre><code>@Bean
public Datasource dataSource(){
	DruidDatasource ds=new DruidDatasource();
	ds.setDriverclassName(driver);
	ds.setUr1(ur1);
 	<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">对于引用类型：引用类型注入只需要为bean定义方法设置形参即可，容器会根据类型自动装配对象</span><br><span class="line"></span><br><span class="line">假设运行需要dao，dao类写上@Repository（不写会出现NoSuchBeanDefinitionException异常），然后SpringConfig类是下面的这样，JdbcConfig里只加上个形参就可以，这是因为自动装配</span><br><span class="line"></span><br><span class="line">~~~java</span><br><span class="line">public class JdbcConfig&#123;</span><br><span class="line">    @Value(&quot;com.mysql.jdbc.Driver&quot;)</span><br><span class="line">	private string driver;</span><br><span class="line">	@Value(&quot;jdbc:mysql:/localhost:3306/spring_db&quot;)</span><br><span class="line">	private string url;</span><br></pre></td></tr></table></figure>
@Bean
public Datasource dataSource(BookDao bookDao){//这里多了个形参
</code></pre>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima.dao&quot; )</span><span class="comment">//扫描</span></span><br><span class="line"><span class="meta">@Import(JdbcConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br></pre></td></tr></table></figure>

<h3 id="XML配置与注解配置比较"><a href="#XML配置与注解配置比较" class="headerlink" title="XML配置与注解配置比较"></a>XML配置与注解配置比较</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251124031607539.png" alt="image-20251124031607539"></p>
<h2 id="Spring整合MyBatis"><a href="#Spring整合MyBatis" class="headerlink" title="Spring整合MyBatis"></a>Spring整合MyBatis</h2><ul>
<li>MyBatis程序核心对象分析</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[]args)</span><span class="keyword">throws</span> IOException &#123;</span><br><span class="line">		<span class="comment">//1.创建SqlSessionFactoryBuilder对象</span></span><br><span class="line">		<span class="type">SqlSessionfactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">sqlsessionfactoryBuilder</span>(),</span><br><span class="line">		<span class="comment">//2.加载SqlMapconfig.xml配置文件</span></span><br><span class="line">		<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;SqlMapCconfig.xml&quot;</span>);</span><br><span class="line">		<span class="comment">//3.创建sqlsessionFactory对象</span></span><br><span class="line">		<span class="comment">//获取连接，获取实现</span></span><br><span class="line">		<span class="type">SqlSessionfactory</span> <span class="variable">sqlsessionFactory</span> <span class="operator">=</span> sqlsessionfactoryBuilder.build(inputstream);</span><br><span class="line">		<span class="comment">// 4.获取sqlSession</span></span><br><span class="line">		SqlSession sqlSession=sqlsessionFactory.opensession();</span><br><span class="line">		<span class="comment">//5.执行SqlSession对象执行查询，获取结果User</span></span><br><span class="line">		<span class="comment">//获取数据层接口</span></span><br><span class="line">		<span class="type">AccountDao</span> <span class="variable">accountDao</span> <span class="operator">=</span>sqlsession.getMapper(AccountDao.class);</span><br><span class="line">		<span class="type">Account</span> <span class="variable">ac</span> <span class="operator">=</span> accountDao.findById(<span class="number">2</span>);</span><br><span class="line">		System.out.println(ac);</span><br><span class="line">		<span class="comment">// 6 、释放资源</span></span><br><span class="line">		sqlsession.close();</span><br></pre></td></tr></table></figure>

<p>依赖要添加两个新的</p>
<p>第一个包是spring里操作数据库专用的包</p>
<p>第二个包时spring整合mybatis用的包，spring提供接口规范，让被整合的按照标准开发</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>创建JdbcConfig（三方bean的管理格式）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Configuration不使用这个注解被扫描是因为可读性差，就需要手动导入</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Jdbcconfig</span>&#123;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;jdbc.driver&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> string driver;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;jdbc.url&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> string url;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> string userName;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;jdbc.password&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> string password;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> Datasource <span class="title function_">datasource</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="type">DruidDatasource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDatasource</span>();</span><br><span class="line">		ds.setDriverClassName(driver);</span><br><span class="line">		ds.setUr1(url);</span><br><span class="line">		ds.setUsername(userName);</span><br><span class="line">		ds.setPassword(password);</span><br><span class="line">		<span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建SpringConfig</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Componentscan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@ropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class,MybatisConfig.class&#125;)</span><span class="comment">//手动导入</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>写个专门做mybatis的配置类，里面写上sqlsessionfactorybean，然后在springconfig里导入。通过创建这个类来获取factory，xml配置文件里的东西都不能少，如果不在配置文件里配置，也可以通过set方法配置，只需要配置最需要的东西</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisConfig</span>&#123;</span><br><span class="line">    <span class="comment">//使用@bean想注入引用类型直接在括号的形参加上对应参数就可以</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> SqlsessionFactoryBean <span class="title function_">sqlsessionFactory</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">	<span class="type">SqlSessionFactoryBean</span> <span class="variable">ssfb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBean</span>();</span><br><span class="line">    <span class="comment">//代替了package name </span></span><br><span class="line">	ssfb.setTypeAliasesPackage(<span class="string">&quot;com.itheima.domain&quot;</span>);</span><br><span class="line">    <span class="comment">//environments就不要了</span></span><br><span class="line">    <span class="comment">//代替了datasource。spring容器里有dataSource</span></span><br><span class="line">	ssfb.setDataSource(dataSource);</span><br><span class="line">    <span class="comment">//还有个transactionManager事务处理，暂时忽略</span></span><br><span class="line">	<span class="keyword">return</span> ssfb;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//还有个mapper标签，用来造dao实现类的</span></span><br><span class="line">    <span class="comment">//这个也属于mybatis整合spring包里的，映射扫描配置器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MapperScannerConfigurer <span class="title function_">mapperScannerConfigurer</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">MapperScannerConfigurer</span> <span class="variable">msc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapperScannerConfigurer</span>();</span><br><span class="line">        <span class="comment">//设置映射的包路径</span></span><br><span class="line">        msc.setBasePackage(<span class="string">&quot;com.itheima.dao&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> msc;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>以上的只需要改包路径就可以，之前的springConfig.xml就不要了，但之前的运行方式就不能要了，新建一个app2</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App2</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[] args)</span>&#123;</span><br><span class="line">		<span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="comment">//这里getbean注意不需要拿dao，因为dao已经注入到service里了，所以直接用service的类</span></span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> ctx.getBean(AccountService.class);</span><br><span class="line">		<span class="type">Account</span> <span class="variable">ac</span> <span class="operator">=</span> accountService.findById(<span class="number">1</span>);</span><br><span class="line">		System.out.println(ac);<span class="comment">//查到数据</span></span><br><span class="line">    &#125;    </span><br></pre></td></tr></table></figure>

<h2 id="spring整合JUnit"><a href="#spring整合JUnit" class="headerlink" title="spring整合JUnit"></a>spring整合JUnit</h2><p>使用spring整合结构的这种方式来运行程序</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.设定类运行器</span></span><br><span class="line"><span class="comment">//2.设置上下文配置，配置类用calsses</span></span><br><span class="line"><span class="comment">//3.要测谁直接注入就行</span></span><br><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@ContextConfiguration(classes = SpringConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceTest</span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> AccountService accountService;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindById</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(accountservice.findById(<span class="number">1</span>));</span><br><span class="line">        </span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindA1l</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(accountService.findAll());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ul>
<li>AOP(Aspect Oriented Programming)面向切面编程，一种编程范式，指导开发者如何组织程序结构<ul>
<li>00P(0bject Oriented Programming)面向对象编程</li>
</ul>
</li>
<li>作用:在不惊动原始设计的基础上为其进行功能增强</li>
<li>Spring理念:无入侵式&#x2F;无侵入式</li>
</ul>
<p>想让蓝色部分在别的方法也拥有，就把蓝色部分抽取出来做一个单独的方法，然后原始save方法起名叫<strong>连接点</strong>；对追加功能的方法叫做<strong>切入点</strong>，这个切入点就说明了哪些方法要追加功能；让大家都有的方法是一组共性的功能，起名叫<strong>通知</strong>，但怎么就知道要在update和delete上执行这个通知呢，看来在通知和切入点之间还得有个东西把他俩绑定到一块，这样的话一个通知就对应一个切入点，这个东西叫做<strong>切面</strong>，切面描述的是这个通知的共性功能与对应的切入点的关系。然后在java中的方法需要依托<strong>通知类</strong>，不能独立存在</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251216184936360.png" alt="image-20251216184936360"></p>
<p>了解完后整体的流程就是：首先找到程序中间的共性功能，写一个通知类，在通知类中定义一个方法，这个方法叫通知，这个方法里放的是共性功能 ，把需要执行对应通知的方法找出定义成切入点，把切入点和通知绑定就得到了切面，切面描述的是在哪个切入点执行哪些通知</p>
<ul>
<li>连接点(JoinPoint):程序执行过程中的任意位置，粒度为执行方法、抛出异常、设置变量等<ul>
<li>在SpringAOP中，理解为方法的执行</li>
</ul>
</li>
<li>切入点(Pointcut):匹配连接点的式子<ul>
<li>在SpringAoP中，一个切入点可以只描述一个具体方法，也可以匹配多个方法<ul>
<li>一个具体方法:com.itheima.dao包下的BookDao接口中的无形参无返回值的save方法</li>
<li>匹配多个方法:所有的save方法，所有的get开头的方法，所有以Dao结尾的接口中的任意方法，所有带有一个参数的方法</li>
</ul>
</li>
</ul>
</li>
<li>通知(Advice):在切入点处执行的操作，也就是共性功能<ul>
<li>在springA0P中，功能最终以方法的形式呈现</li>
</ul>
</li>
<li>通知类:定义通知的类</li>
<li>切面(Aspect):描述通知与切入点的对应关系</li>
</ul>
<p>切入点范围小，连接点范围大，切入点一定在连接点中</p>
<h3 id="AOP入门案例"><a href="#AOP入门案例" class="headerlink" title="AOP入门案例"></a>AOP入门案例</h3><p>设定:在接口执行前输出当前系统时间<br>开发模式:XML or 注解</p>
<p>思路分析：</p>
<ol>
<li>导入坐标(pom.xml)</li>
<li>制作连接点方法(原始操作，Dao接口与实现类)</li>
<li>制作共性功能(通知类与通知)</li>
<li>定义切入点</li>
<li>绑定切入点与通知关系(切面 )</li>
</ol>
<p>导入坐标的话导入spring-context，aop也会被自动导入，再导入一个aspectj</p>
<p>第二步是制作连接点方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(system.currentTimeMillis());</span><br><span class="line">		System.out.println(<span class="string">&quot;book dao save ...</span></span><br><span class="line"><span class="string">	public void update()&#123;</span></span><br><span class="line"><span class="string">		System.out.println(&quot;</span>book dao update ...<span class="string">&quot;</span></span><br></pre></td></tr></table></figure>

<p>第三步是把共性功能抽出做新的类，里面写个方法叫method，这就是共性功能</p>
<p>第四步定义切入点，写个私有方法，加上@Pointcut，里面的execution是执行的意思，括号里是返回值void，类全限定名的update方法有没有参数。说明:切入点定义依托一个不具有实际意义的方法进行，即无参数，无返回值，方法体无实际逻辑</p>
<p>第五步，让method方法在切入点的什么位置执行呢，如果是前面就用@before，里面是方法名</p>
<p>第六步加上@Component让它受springbean控制，加上@Aspect让spring知道这里是aop</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line">	<span class="meta">@Pointcut(&quot;execution(void com.itheima.dao.BookDao.update())&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(System.currentTimeMillis());</span><br></pre></td></tr></table></figure>

<p>但现在spring不知道是用注解开发的aop，所以要在配置类加个@EnableAspectJAutoProxy告诉spring这里面有用注解开发的aop，也就是启动了@Aspect去识别里面的东西</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Componentscan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springcinfig</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="AOP工作流程"><a href="#AOP工作流程" class="headerlink" title="AOP工作流程"></a>AOP工作流程</h3><ol>
<li><p>Spring容器启动</p>
</li>
<li><p>读取所有切面配置中的切入点（配置在@Before的才会生效）</p>
</li>
<li><p>初始化bean，判定bean对应的类中的方法是否匹配到任意切入点</p>
<p>​    如果匹配失败，就创建对象</p>
<p>​    匹配成功，创建原始对象(<strong>目标对象)<strong>的</strong>代理</strong>对象，代理就表示可以用代理对象调用对应方法走增强的那些操作</p>
</li>
<li><p>获取bean执行方法</p>
<p>​    获取bean，拿上面匹配失败创建的对象去调用方法并执行，完成操作</p>
<p>​    获取的bean是代理对象时，根据代理对象的运行模式运行原始方法与增强的内容，完成操作，这个也就是aop用的是代理模式</p>
</li>
</ol>
<p>核心概念：</p>
<ul>
<li>目标对象(Target):原始功能去掉共性功能对应的类产生的对象，这种对象是无法直接完成最终工作的</li>
<li>代理(Proxy):目标对象无法直接完成工作，需要对其进行功能回填，通过原始对象的代理对象实现</li>
</ul>
<p>没有开启aop的时候打印对象和class类：</p>
<p>com.itheima.dao.impl.BookDaoImpl@279fedbd<br>class com.itheima.dao.impl.BookDaoImpl</p>
<p>开启aop的时候打印对象和class类：</p>
<p>com.itheima.dao.impl.BookDaoImpl@4e50c791<br>class com.sun.proxy.$Proxy19</p>
<p>因为aop会对最终的对象的toString方法进行重写，直接打印对象比如System.out.println(bookDao);就会带来一些误导</p>
<h3 id="AOP切入点表达式"><a href="#AOP切入点表达式" class="headerlink" title="AOP切入点表达式"></a>AOP切入点表达式</h3><ul>
<li>切入点:要进行增强的方法</li>
<li>切入点表达式:要进行增强的方法的描述方式</li>
</ul>
<p>比如现在有两个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;book dao update ...&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>描述方式一:执行com.itheima.dao包下的BookDao接口中的无参数update方法<ul>
<li>execution(void com.itheima.dao.BookDao.update())</li>
</ul>
</li>
<li>描述方式二:执行com.itheima.dao.impl包下的BookDaoImpl类中的无参数update方法<ul>
<li>execution(void com.itheima.dao.impl.BookDaoImpl.update())</li>
</ul>
</li>
</ul>
<p>上面两种方式都可以，描述接口或者描述实现类</p>
<p>切入点表达式标准格式：动作关键字(访问修饰符  返回值 包名.类&#x2F;接口名.方法名(参数)异常名 )</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution (<span class="keyword">public</span> User com.itheima.service.UserService.findById (<span class="type">int</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li>动作关键字:描述切入点的行为动作，例如execution表示执行到指定切入点，这个词几乎不动</li>
<li>访问修饰符:public，private等，可以省略</li>
<li>返回值</li>
<li>包名</li>
<li>类&#x2F;接口名</li>
<li>方法名</li>
<li>参数</li>
<li>异常名:方法定义中抛出指定异常，可以省略，忽略就是public</li>
</ul>
<p>可以使用通配符描述切入点，快速描述</p>
<ul>
<li><p>单个独立的任意符号，可以独立出现，也可以作为前缀或者后缀的匹配符出现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一个*是不限制返回类型，第二个是任意包的意思，第三个是范围匹配，第四个是任意参数</span></span><br><span class="line">execution(<span class="keyword">public</span> * com.itheima.*.UserService.find* (*))</span><br></pre></td></tr></table></figure>

<p>​    匹配com.itheima包下的任意包中的UserService类或接口中所有find开头的（必须）带有一个参数的方法</p>
</li>
<li><p>..：多个连续的任意符号，可以独立出现，常用于简化包名与参数的书写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(<span class="keyword">public</span> User com..UserService.findById(..))</span><br></pre></td></tr></table></figure>

<p>意思是匹配com包下的任意包中的UserService类或接口中所有名称为findByld的任意方法</p>
</li>
<li><p>+:专用于匹配子类类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* *..*Service+.*(..))</span><br></pre></td></tr></table></figure>

<p>任意返回值，任意包下面以Service结尾的子类的任意方法任意参数，括号里的是*就必须有参数才行</p>
</li>
<li><p>书写技巧：</p>
<ul>
<li>所有代码按照标准规范开发，否则以下技巧全部失效</li>
<li>描述切入点<strong>通常描述接口</strong>，而不描述实现类，因为描述实现类就紧耦合了</li>
<li>访问控制修饰符针对接口开发均采用public描述(<strong>可省略访问控制修饰符描述</strong></li>
<li>返回值类型对于增删改类使用<strong>精准</strong>类型加速匹配，对于查询类使用*<strong>通配</strong>快速描述</li>
<li><strong>包名</strong>书写<strong>尽量不使用..匹配</strong>，效率过低，常用*做单个包描述匹配，或精准匹配</li>
<li><strong>接口名</strong>&#x2F;类名书写名称与模块相关的<strong>采用*匹配</strong>，例如UserService书写成*Service,绑定业务层接口名</li>
<li><strong>方法名</strong>书写以<strong>动词</strong>进行<strong>精准匹配</strong>，名词采用*匹配，例如getByld书写成getBy*,selectAl书写成selectAll</li>
<li>参数规则较为复杂，根据业务方法灵活调整</li>
<li>通常<strong>不使用异常</strong>作为匹配规则</li>
</ul>
</li>
</ul>
<h3 id="AOP通知类型"><a href="#AOP通知类型" class="headerlink" title="AOP通知类型"></a>AOP通知类型</h3><ul>
<li>AOP通知描述了抽取的共性功能，根据共性功能抽取的位置不同，最终运行代码时要将其加入到合理的位置</li>
<li>AOP通知共分为5种类型<ul>
<li>前置通知</li>
<li>后置通知</li>
<li>环绕通知(重点)</li>
<li>返回后通知(了解 )</li>
<li>抛出异常后通知(了解)</li>
</ul>
</li>
</ul>
<p>演示：准备以下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line">	puplic iht <span class="title function_">select</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line">	<span class="meta">@Pointcut(&quot;execution(void com.itheima.dao.BookDao.update())&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span><span class="comment">//前置通知</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123; system.out.println(<span class="string">&quot;before advice ...&quot;</span>);&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@After(&quot;pt()&quot;)</span><span class="comment">//后置通知</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123; system.out.println(<span class="string">&quot;after advice ...&quot;</span>);&#125;</span><br></pre></td></tr></table></figure>

<p>环绕通知这个直接输出的话会输出<br>around before advice …<br>around after advice …，原方法没有执行，所以必须要加个东西表示对原始操作的调用，方法是在around的括号里加上ProceedingJoinPoint参数，取名pjp，然后用这个调用proceed，这个就是代表对原始操作的调用，这里有红线因为原始操作无法预期是否有异常，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line">	<span class="meta">@Pointcut(&quot;execution(int com.itheima.dao.BookDao.update())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    	<span class="meta">@Pointcut(&quot;execution(int com.itheima.dao.BookDao.select())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt2</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Around(&quot;pt()&quot;)</span><span class="comment">//环绕通知</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">around</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;around before advice ...&quot;</span>);</span><br><span class="line">        <span class="comment">//表示对原始操作的调用</span></span><br><span class="line">        pjp.proceed();</span><br><span class="line">		System.out.println(<span class="string">&quot;around after advice ...&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>但如果新弄一个select的，运行时会抛出异常AopInvocationException，后面的英文意思是空的返回值从这个advance中出来了，它不匹配原始操作调用的返回值类型，原始操作返回的是int，所以要让最后能有个返回值给抛出去，返回类型用object。原始操作其实调用的是impl方法，里面return的是100，那么这100哪去了？ pjp.proceed();其实有个返回值，这个返回值就是原本的100</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   <span class="meta">@Around(&quot;pt2()&quot;)</span></span><br><span class="line"><span class="comment">//public void aroundSelect(ProceedingJoinPoint pjp) throws Throwable&#123;要有返回值</span></span><br><span class="line">   <span class="keyword">public</span> Object <span class="title function_">aroundSelect</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;around before advice ...&quot;</span>);</span><br><span class="line">       <span class="comment">//表示对原始操作的调用</span></span><br><span class="line">       <span class="comment">//pjp.proceed();</span></span><br><span class="line">       <span class="type">Object</span> <span class="variable">proceed</span> <span class="operator">=</span>  pjp.proceed();</span><br><span class="line">       <span class="comment">//如果返回值要加点什么，就要强转类型，因为object不能做加法</span></span><br><span class="line">       <span class="comment">//Integer ret = (Integer)pjp.proceed;</span></span><br><span class="line">	System.out.println(<span class="string">&quot;around after advice ...&quot;</span>);</span><br><span class="line">       <span class="comment">//return 200;</span></span><br><span class="line">       <span class="keyword">return</span> ret;</span><br><span class="line">       <span class="comment">//return ret+666;</span></span><br><span class="line">       以上是标准写法</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>下面代表原始方法执行成功后执行这个动作，了解即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterReturning(&quot;pt2()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">()</span>&#123; </span><br><span class="line">       system.out.println(<span class="string">&quot;afterReturning advice ...&quot;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>下面是抛出异常后才运行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterThorwing(&quot;pt2()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowing</span><span class="params">()</span>&#123;</span><br><span class="line">	system.out.println(<span class="string">&quot;afterThrowing advice ...&quot;</span>);&#125;</span><br></pre></td></tr></table></figure>

<p>@Around注意事项</p>
<ol>
<li>环绕通知必须依赖形参ProceedingJoinPoint才能实现对原始方法的调用，进而实现原始方法调用前后同时添加通知</li>
<li>通知中如果未使用ProceedingjoinPoint对原始方法进行调用将跳过原始方法的执行，会产生一种对原始操作进行隔离的效果，比如做权限校验</li>
<li>对原始方法的调用可以不接收返回值，通知方法设置成void即可,如果接收返回值，必须设定为Obiect类型</li>
<li>原始方法的返回值如果是void类型，通知方法的返回值类型可以设置成void，也可以设置成Object</li>
<li>由于无法预知原始方法运行后是否会抛出异常，因此环绕通知方法必须抛出Throwable对象</li>
</ol>
<h3 id="案例：测量业务层接口万次执行效率"><a href="#案例：测量业务层接口万次执行效率" class="headerlink" title="案例：测量业务层接口万次执行效率"></a>案例：测量业务层接口万次执行效率</h3><p>需求:任意业务层接口执行均可显示其执行效率(执行时长)<br>分析：</p>
<ol>
<li>业务功能:业务层接口执行前后分别记录时间，求差值得到执行效率</li>
<li>通知类型选择前后均可以增强的类型——环绕通知</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251220160656006.png" alt="image-20251220160656006"></p>
<p>准备以上数据</p>
<p>业务层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Accountservice</span>&#123;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span>;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span>;</span><br><span class="line">	List&lt;Account&gt; <span class="title function_">findA11</span><span class="params">()</span>;</span><br><span class="line">	Account <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure>

<p>第一步，先在springConfig里把aop注解开启</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Componentscan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;Jdbcconfig.class,MybatisConfig.class&#125;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span><span class="comment">//开启</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springconfig</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>然后创建aop包，新建ProjectAdvice类，我们是对业务层接口做监控所以起名也是这个，返回值不好说是什么，所以用通配，方法是任意方法，参数是什么都行。然后用循环去执行原始方法，最后打印结果，但这个并不能用，因为并不知道执行时间是哪个具体的方法，而ProceedingJoinPoint描述的是原来那个方法的执行对象，通过这个拿到执行的签名信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span><span class="comment">//受spring管理</span></span><br><span class="line"><span class="meta">@Aspect</span><span class="comment">//切面类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProjectAdvice</span>&#123;</span><br><span class="line">    <span class="comment">//匹配业务层所有方法</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.itheima.service.*Service.*(..))&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">servicePt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Around(&quot;ProjectAdvice.servicePt()&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">runspeed</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">        <span class="comment">//通过这个拿到执行的签名信息</span></span><br><span class="line">        <span class="type">Signature</span> <span class="variable">signature</span> <span class="operator">=</span> pjp.getsignature();</span><br><span class="line">        <span class="comment">//System.out.println(signature.getDeclaringType());//打印类型interface com.itheima.service.AccountService</span></span><br><span class="line">		<span class="comment">//System.out.println(signature.getName());//打印方法名findById</span></span><br><span class="line">        <span class="comment">//System.out.println(signature.getDeclaringTypeName());//打印类型名com.itheima.service.AccountService</span></span><br><span class="line">        <span class="comment">//改进</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> signature.getDeclaringTypeName();</span><br><span class="line">		<span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> signature.getName();</span><br><span class="line">        </span><br><span class="line">        <span class="type">long</span> start=system.currentTimeMillis();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">			pjp.proceed();</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">		<span class="comment">//System.out.println(&quot;业务层接口万次执行时间:[&quot;+(end-start)+&quot;ms&quot;);//注意要加括号，否则是字符串拼接</span></span><br><span class="line">        <span class="comment">//return ret;但是返回哪一遍都不合理，所以直接干掉，方法返回值变成void</span></span><br><span class="line">        <span class="comment">//改进</span></span><br><span class="line">        System.out.println(<span class="string">&quot;万次执行:&quot;</span>+ className +<span class="string">&quot;.&quot;</span>+ methodName +<span class="string">&quot;----&gt;&quot;</span> +(end-start)+ <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>补充说明：当前测试的接口执行效率仅仅是一个理论值，并不是一次完整的执行过程</p>
<h3 id="AOP通知获取数据"><a href="#AOP通知获取数据" class="headerlink" title="AOP通知获取数据"></a>AOP通知获取数据</h3><ul>
<li>获取切入点方法的参数<ul>
<li>JoinPoint:适用于前置、后置、返回后、抛出异常后通知（每个都有）</li>
<li>ProceedJointPoint:适用于around环绕通知</li>
</ul>
</li>
<li>获取切入点方法返回值<ul>
<li>返回后通知（afterReturning）</li>
<li>环绕通知（around）</li>
</ul>
</li>
<li>获取切入点方法运行异常信息<ul>
<li>抛出异常后通知</li>
<li>环绕通知</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251221024909688.png" alt="image-20251221024909688"></p>
<p>这个参数是pjp的父</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint jp)</span>&#123;</span><br><span class="line">	object[] args = jp.getArgs();</span><br><span class="line">	System.out.println(Arrays.tostring(args));</span><br><span class="line">	System.out.println(<span class="string">&quot;before advice ...&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在bookdao添加参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">findName</span><span class="params">(<span class="type">int</span> id,String password)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> string <span class="title function_">findName</span><span class="params">(<span class="type">int</span> id,string password)</span>&#123;</span><br><span class="line">		System.out.println(“id:<span class="string">&quot;+id);</span></span><br><span class="line"><span class="string">		return &quot;</span>itcast<span class="string">&quot;;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br></pre></td></tr></table></figure>

<p>启动程序</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[] args)</span>&#123;</span><br><span class="line">		ApplicationContext ctx= <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationcontext</span>(Springconfig.class);</span><br><span class="line">		<span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> ctx.getBean(BookDao.class);</span><br><span class="line">		<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> bookDao.findName(id:<span class="number">100</span>,password: <span class="string">&quot;itheima&quot;</span>);</span><br><span class="line">		System.out.println(name):</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">然后输出：[<span class="number">100</span>, itheima]</span><br><span class="line">before advice ...</span><br><span class="line">id:<span class="number">100</span></span><br><span class="line">itcast</span><br></pre></td></tr></table></figure>

<p><strong>参数的调用：</strong></p>
<p>其他的都一样这样用，对于around，父接口能调用的方法子接口也可以用，所以直接pjp.getArgs调用对应参数</p>
<p>在调用原始方法时，对于proceed这个操作除了空参外还可以传个object数组，也就是可以把上面的args传进去</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around(“pt()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint pjp)</span><span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">	object[] args = pjp.getArgs();</span><br><span class="line">	System.out.println(Arrays.tostring(args));</span><br><span class="line">	<span class="comment">//object ret = pjp.proceed();</span></span><br><span class="line">    <span class="type">object</span> <span class="variable">ret</span> <span class="operator">=</span> pjp.proceed(args);</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">输出[<span class="number">100</span>,itheima]</span><br><span class="line">id:<span class="number">100</span></span><br><span class="line">itcast</span><br></pre></td></tr></table></figure>

<p>但如果在获取之后调用之前把args的值更改了，比如args[0] &#x3D; 666；最后输出的结果也会被更改，所以如果传过来的参数有问题，我们就可以先处理一下，这里可以保证程序的健壮性，不需要每个程序都写，一个aop就可以搞定</p>
<p><strong>返回值的调用</strong>：</p>
<p>一个是around一个是afterReturning，around的返回值就是ret</p>
<p>而afterReturning要拿返回值，可以先定义一个用来接受返回值的形参，但如果定义了后就要告诉@AfterReturning用ret这个变量准备接受返回值。点进@AfterReturning可以看到提供了很多东西，其中一个是returning和value，returning的值要和形参名对应</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterReturning(value = &quot;pt()&quot;, returning = &quot;ret&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">(Object ret)</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;afterReturning advice ...&quot;</span>+ret);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当JoinPoint和Object同时存在，JoinPoint必须在第一个位置，其他的也是一样，如果不是这样就会报IllegalArgumentException异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">(JoinPoint jp,Object ret)</span>&#123;</span><br></pre></td></tr></table></figure>

<p><strong>异常对象的调用：</strong></p>
<p>两种写法，第一种是</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint pjp)</span> &#123;</span><br><span class="line">	object[] args = pjp.getArgs();</span><br><span class="line">	System.out.println(Arrays.tostring(args));</span><br><span class="line">    <span class="type">object</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        ret = pjp.proceed(args);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable throwable)&#123;</span><br><span class="line">        throwable.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第二种</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterThrowing(value = &quot;pt()&quot;,throwing =&quot;t&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowing</span><span class="params">(Throwable t)</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;afteiThrowing advice ...&quot;</span>+t)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="案例：百度网盘密码数据兼容处理"><a href="#案例：百度网盘密码数据兼容处理" class="headerlink" title="案例：百度网盘密码数据兼容处理"></a>案例：百度网盘密码数据兼容处理</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251224024522509.png" alt="image-20251224024522509"></p>
<p>分析：<br>①：在业务方法执行之前对所有的输入参数进行格式处理——trim(0)<br>②：使用处理后的参数调用原始方法–环绕通知中存在对原始方法的调用</p>
<p>准备代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ResourcesService</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">openURL</span><span class="params">(string url ,string password)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResourcesServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ResourcesService</span> &#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> ResourcesDao resourcesDao;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">openURL</span><span class="params">(string url, string password)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> resourcesDao.readResources(url,password);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ResourcesDao</span>&#123;</span><br><span class="line">	<span class="type">boolean</span> <span class="title function_">readResources</span><span class="params">(String url,String password)</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResourcesDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">ResourcesDao</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">readResources</span><span class="params">(String url,String password)</span>&#123;</span><br><span class="line">		<span class="comment">//模拟校验</span></span><br><span class="line">		<span class="keyword">return</span> password.equals(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[l args)</span>&#123;</span><br><span class="line">		<span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationcontext</span>(SpringConfig.class);</span><br><span class="line">		<span class="type">ResourcesService</span> <span class="variable">resourcesService</span> <span class="operator">=</span> ctx.getBean(ResourcesService.class):</span><br><span class="line">		<span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> resourcesService.openURL( url: <span class="string">&quot;http://pan.baidu.com/haha&quot;</span>, password: <span class="string">&quot;root&quot;</span>),</span><br><span class="line">		System.out.println(flag);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>现在简单运行一下，返回的是true，如果把root后面加个空格就会返回false，我们想要的效果是加上空格也能返回true，也就是帮我把这个空格去掉</p>
<p>首先开启aop注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Componentscan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springconfig</span> &#123;</span><br></pre></td></tr></table></figure>

<p>新建aop处理类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataAdvice</span> &#123;</span><br><span class="line">	<span class="meta">@Pointcut(&quot;execution(boolean com.itheima.service.*service.*(*,*))&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">servicePt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Around(&quot;DataAdvice.servicePt()&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> object <span class="title function_">trimstr</span><span class="params">(ProceedingJoinPoint pjp)</span><span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">		object[<span class="type">l</span> <span class="variable">args</span> <span class="operator">=</span> pjp.getArgs();</span><br><span class="line">        <span class="comment">//怎么去掉呢，有的人想用循环trim去掉空格，但args是个对象不能用trim</span></span><br><span class="line">		<span class="comment">/*for(object obj:args)&#123;</span></span><br><span class="line"><span class="comment">            obj.trim//没有这个调用方法</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        <span class="comment">//这里用for循环不用foreach</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; args.length; i++)&#123;<span class="comment">//通过i拿到索引值</span></span><br><span class="line">			<span class="comment">//判断参数是不是字符串</span></span><br><span class="line">            <span class="keyword">if</span>(args[i].getClass().equals(String.class))&#123;</span><br><span class="line">                args[i] = args[i].toString().trim();<span class="comment">//如果是字符串类就一定可以转换成字符串，然后trim，改完再放回去</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//把改完的参数放进原始操作里然后返回       </span></span><br><span class="line">		<span class="type">Obiect</span> <span class="variable">ret</span> <span class="operator">=</span> pip.proceed(args),</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>如果想测试做没做对就可以在输出程序app里添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(password.length());</span><br></pre></td></tr></table></figure>

<p>然后把root改成1234空格空格，打印出来的长度为4就是对的</p>
<h3 id="AOP总结"><a href="#AOP总结" class="headerlink" title="AOP总结"></a>AOP总结</h3><ul>
<li>概念:AOP(Aspect 0riented Programming)面向切面编程，一种编程范式</li>
<li>作用:在不惊动原始设计的基础上为方法进行功能<strong>增强</strong></li>
<li>核心概念<ul>
<li>代理(Proxy):SpringAoP的核心本质是采用代理模式实现的</li>
<li>连接点(JoinPoint):在SpringA0P中，理解为任意方法的执行</li>
<li>切入点(Pointcut):匹配连接点的式子，也是具有共性功能的方法描述</li>
<li>通知(Advice):若干个方法的共性功能，在切入点处执行，最终体现为一个方法</li>
<li>切面(Aspect):描述通知与切入点的对应关系</li>
<li>目标对象(Target):被代理的原始对象成为目标对象</li>
</ul>
</li>
</ul>
<p>切入点表达式书写技巧</p>
<ol>
<li>按<strong>标准规范</strong>开发</li>
<li>查询操作的返回值建议使用*匹配</li>
<li>减少使用..的形式描述包</li>
<li><strong>对接口进行描述</strong>,使用*表示模块名，例如userservice的匹配描述为*Service</li>
<li>方法名书写保留动词，例如get,使用<em>表示名词，例如getById匹配描述为getBy</em></li>
<li>参数根据实际情况灵活调整</li>
</ol>
<p>环绕通知可以模拟出其他四种通知，比如只在调用原始操作前做事情，这就是前置通知，用try catch写完后在finally写的东西就是后置通知，而返回后通知是在你的try catch finally中try大括号结束之前，原始调用方法之后的那些可以模拟返回后通知，catch模拟抛出异常后通知</p>
<p>环绕通知(重点 )</p>
<ul>
<li>环绕通知依赖形参ProceedingJoinPoint才能实现对原始方法的调用</li>
<li>环绕通知可以隔离原始方法的调用执行</li>
<li>环绕通知返回值设置为0bject类型</li>
<li>环绕通知中可以对原始方法调用过程中出现的异常进行处理</li>
</ul>
<h2 id="spring事务简介"><a href="#spring事务简介" class="headerlink" title="spring事务简介"></a>spring事务简介</h2><h3 id="案例：银行账户转账"><a href="#案例：银行账户转账" class="headerlink" title="案例：银行账户转账"></a>案例：银行账户转账</h3><ul>
<li>事务作用:在数据层保障一系列的数据库操作同成功同失败</li>
<li>Spring事务作用:在数据层或业务层保障一系列的数据库操作同成功同失败</li>
</ul>
<p>spring提供了一个接口，叫做平台事务管理器，大概意思是提交的时候都提交，回滚的时候都回滚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PlatformTransactionManager</span>&#123;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">commit</span><span class="params">(TransactionStatus status)</span><span class="keyword">throws</span> TransactionException;</span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">rollback</span><span class="params">(TransactionStatus status)</span><span class="keyword">throws</span> TransactionException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DatasourceTransactionManager</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这个内部使用的是jdbc的事务，如果用的是jdbc的技术就可以用这个，而mybatis内部就是用的jdbc</p>
<p>案例：模拟银行账户间转账业务<br>需求：实现任意两个账户间转账操作<br>需求微缩：A账户减钱，B账户加钱</p>
<p>分析<br>①：数据层提供基础操作，指定账户减钱(outMoney)，指定账户加钱(inMoney)<br>②：业务层提供转账操作(transfer),调用减钱与加钱的操作<br>③：提供2个账号和操作金额执行转账操作<br>④：基于Sprinq整合MyBatis环境搭建上述操作</p>
<p>转账接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 转账操作</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> out 传出方</span></span><br><span class="line"><span class="comment"> * param in 转入方</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> money 金额</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">    <span class="meta">@Transactional</span><span class="comment">//在需要添加事务的方法上加这个注解</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out,String in ,Double money)</span>;</span><br></pre></td></tr></table></figure>

<p>数据层接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span></span><br><span class="line">	<span class="meta">@Update(&quot;update tbl_account set money = money + #&#123;money&#125; where name = #&#123;name&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">inMoney</span><span class="params">(<span class="meta">@Param(&quot;name&quot;)</span>String name, <span class="meta">@Param(&quot;money&quot;)</span>Double money)</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Update(&quot;update tbl_account set money = money - #&#123;money&#125; where name = #&#123;name&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">outMoney</span><span class="params">(<span class="meta">@Param(&quot;name&quot;)</span>String name, <span class="meta">@Param(&quot;money&quot;)</span> Double money)</span>;</span><br></pre></td></tr></table></figure>

<p>业务层实现类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out,String in ,Double money)</span>&#123;</span><br><span class="line">		accountDao.outMoney(out,money);</span><br><span class="line">		accountDao.inMoney(in,money);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@ContextConfiguration(classes = SpringConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceTest</span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> AccountService accountService;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTransfer</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">		accountService.transfer(<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;Jerry&quot;</span>,<span class="number">100D</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>结果分析<br>①：程序正常执行时，账户金额A减B加，没有问题<br>②：程序出现异常后，转账失败，但是异常之前操作成功,异常之后操作失败，整体业务失败</p>
<p>第一步：要在接口上添加事务注解</p>
<p>第二部，到jdbc配置中配一个事务管理器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> PlatformTransactionManager <span class="title function_">transactionManager</span><span class="params">(DataSource dataSource)</span>&#123;</span><br><span class="line">	<span class="type">DataSourceTransactionManager</span> <span class="variable">transactionManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">	transactionManager.setDataSource(dataSource);<span class="comment">//dataSource是bean注入的</span></span><br><span class="line">	<span class="keyword">return</span> transactionManager;</span><br></pre></td></tr></table></figure>

<p>第三步要让spring知道你是用注解形式开启事务管理，到spring的配置文件中配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Componentscan(&quot;com.itheima&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;classpath:jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;Jdbcconfig.class,Mybatisconfig.class&#125;)</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span><span class="comment">//这个</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springconfig</span> &#123;</span><br></pre></td></tr></table></figure>

<p>注意事项：Spring注解式事务通常添加在业务层接口中而不会添加到业务层实现类中，降低耦合<br>注解式事务可以添加到业务方法上表示当前方法开启事务，也可以添加到接口上表示当前接口所有方法开启事务</p>
<h3 id="spring事务角色"><a href="#spring事务角色" class="headerlink" title="spring事务角色"></a>spring事务角色</h3><p>上一节的案例里业务层方法中使用了这个操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(string out,string in ,Double money)</span>&#123;</span><br><span class="line">	accountDao.outMoney(out,money);</span><br><span class="line">	accountDao.inMoney(in,money);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而这两个操作分别对应独立的数据层操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line">	<span class="meta">@Update(&quot;update tbl_account set money = money -#&#123;money&#125; where name = #&#123;name&#125;&quot;</span></span><br><span class="line"><span class="meta">	void outMoney(@Param(&quot;name&quot;) String name, @Param(&quot;money&quot;) Double money);</span></span><br><span class="line"><span class="meta">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line">	<span class="meta">@Update(&quot;update tbl_account set money = money + #&#123;money&#125; where name = #&#123;name&#125;&quot;</span></span><br><span class="line"><span class="meta">	void inMoney(@Param(&quot;name&quot;)String name, @Param(&quot;money&quot;)Double money);</span></span><br></pre></td></tr></table></figure>

<p>上面两个属于增删改操作所以都要开启事务，分别叫t1t2，这两个是不同的事务，假如第二个出现了异常，第一个不会去回滚。当业务层加上开启事务注解后就会有事务T，目前是三个事务，谁也不挨谁，于是spring在这里做了一件事，既然数据层都在业务层的控制范围内，这两个事务都改成和他一样的事务。讲spring开启的这个事务叫做事务管理员，将加入事务管理员的这些成员叫做事务的协调员</p>
<ul>
<li>事务角色<ul>
<li>事务管理员：发起事务方，在Spring中通常指代业务层开启事务的方法</li>
<li>事务协调员：加入事务方，在Spring中通常指代数据层方法，也可以是业务层方法</li>
</ul>
</li>
</ul>
<p>还有个需要注意的是在写程序的时候jdbc和mybatis里都注入了一个datasource，正因为使用了同一个datasource，所以才能够进行统一管理</p>
<h3 id="事务相关配置"><a href="#事务相关配置" class="headerlink" title="事务相关配置"></a>事务相关配置</h3><table>
<thead>
<tr>
<th align="center">属性</th>
<th align="center">作用</th>
<th align="center">示例</th>
</tr>
</thead>
<tbody><tr>
<td align="center">readOnly</td>
<td align="center">设置是否为只读事务</td>
<td align="center">readonly&#x3D;true 只读事务</td>
</tr>
<tr>
<td align="center">timeout</td>
<td align="center">设置事务超时时间</td>
<td align="center">timeout &#x3D;-1(永不超时)</td>
</tr>
<tr>
<td align="center"><strong>rollbackFor</strong></td>
<td align="center">设置事务回滚异常(class)</td>
<td align="center">rollbackFor &#x3D;{NullPointException.class}</td>
</tr>
<tr>
<td align="center">rollbackForClassName</td>
<td align="center">设置事务回滚异常(string)</td>
<td align="center">同上格式为字符串</td>
</tr>
<tr>
<td align="center">noRollbackFor</td>
<td align="center">设置事务不回滚异常(class)</td>
<td align="center">noRollbackFor<br/>&#x3D;{NullPointException.class}</td>
</tr>
<tr>
<td align="center">noRollbackForClassName</td>
<td align="center">设置事务不回滚异常(string)</td>
<td align="center">同上格式为字符串</td>
</tr>
<tr>
<td align="center">propagation</td>
<td align="center">设置事务传播行为</td>
<td align="center">…..</td>
</tr>
</tbody></table>
<p>点进事务按ctrl+f12可以查看类的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span>&#123;</span><br><span class="line">	<span class="meta">@Transactinnal(readOnly = true,timeout = -1)</span><span class="comment">//代表只读和永不超时</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out,String in ,Double money)</span><span class="keyword">throws</span> IoException;</span><br></pre></td></tr></table></figure>

<p>重点是rollbackFor遇到某一类异常回滚事务</p>
<p>一般遇到这两种会进行回滚，第一种是error系列的错误，比如内存溢出，第二种是运行时异常，而IOException这种属于编译时异常。而你希望在IOException异常发生后进行回滚就可以这样写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(rollbackFor =&#123;I0Exception.class)</span></span><br></pre></td></tr></table></figure>

<p>案例：转账业务追加日志<br>需求：实现任意两个账户间转账操作，并对每次转账操作在数据库进行留痕<br>需求微缩：A账户减钱，B账户加钱，数据库记录日志</p>
<p>分析：</p>
<ol>
<li>基于转账操作案例添加日志模块，实现数据库中记录日志</li>
<li>业务层转账操作(transfer)，调用减钱、加钱与记录日志功能</li>
</ol>
<p><strong>实现效果预期</strong>：</p>
<p>​	无论转账操作是否成功，均进行转账操作的日志留痕</p>
<p> log业务层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">LogService</span> &#123;</span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">log</span><span class="params">(string out, string in, Double money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogserviceImpl</span> <span class="keyword">implements</span> <span class="title class_">LogService</span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> LogDao logDao;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String out,String in,Double 	money )</span>&#123;</span><br><span class="line">		logDao.log( info:<span class="string">&quot;转账操作由&quot;</span>+out+<span class="string">&quot;到&quot;</span>+in+<span class="string">&quot;,金额:&quot;</span>+money);<span class="comment">//拼接成字符串</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>数据层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">LogDao</span> &#123;</span><br><span class="line">	<span class="meta">@Insert(&quot;insert into tbl log(info,createDate)values(#&#123;info&#125;,now())&quot;)</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String info)</span>;<span class="comment">//把传过来的信息作为info信息传到insert里</span></span><br></pre></td></tr></table></figure>

<p>实现类，回过头看要求是无论转账操作是否成功，均进行转账操作的日志留痕，怎样保证代码一定会执行，可以用try finally方法，把有可能出问题的代码放上面，finally放一定执行的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">Accountservice</span> &#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> LogService logService;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">/*public void transfer(string out,string in ,Double money)&#123;</span></span><br><span class="line"><span class="comment">		logservice.log(out,in,money);//这一句话并不一定保证能运行</span></span><br><span class="line"><span class="comment">		accountDao.outMoney(out,money);</span></span><br><span class="line"><span class="comment">		accountDao.inMoney(in,money);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">(String out,String in ,Double money)</span>&#123;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			accountDao.outMoney(out,money);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;<span class="comment">//模拟异常</span></span><br><span class="line">			accountDao.inMoney(in,money);</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			logService.log(out,in,money);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>然后在accountService和LogService都开启事务，去数据库查看运行效果，发现没有问题，然后在程序里模拟异常，然后再查看数据库，这时候金额没有发生变化，但日志也没有被记录</p>
<p><strong>存在的问题</strong>：<br>日志的记录与转账操作隶属同一个事务，同成功同失败</p>
<p><strong>实现效果预期改进</strong>：<br>无论转账操作是否成功，日志必须保留</p>
<p>这里学习到一个<strong>事务传播行为</strong>:事务协调员对事务管理员所携带事务的处理态度，协调员是加入呢还是不加入还是搞一个新的。</p>
<p>这里是搞一个新的事务，点开LogService的事务注解，里面有个方法是propagation，里面有一系列的默认值，用法是如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactinnal(propagation = Propagation.REQUIRES_NEW)</span></span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251226033800696.png" alt="image-20251226033800696"></p>
<h1 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h1><h2 id="SpringMVC简介"><a href="#SpringMVC简介" class="headerlink" title="SpringMVC简介"></a>SpringMVC简介</h2><p>SpringMVC概述</p>
<ul>
<li>SpringMVc技术与Servlet技术功能等同，均属于web层开发技术</li>
<li>优点<ul>
<li>使用简单，开发便捷(相比于Servlet)</li>
<li>灵活性强</li>
</ul>
</li>
</ul>
<p>以下是用servlet的保存代码（仅演示，除此之外还有其他三个不同功能的类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Webservlet(&quot;/user/save&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserSaveServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpservletRequest reg, HttpservletResponse resp)</span> <span class="keyword">throws</span> ServletException, IoException &#123;</span><br><span class="line">		<span class="comment">//1.接收请求参数</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> reg.getParameter( name:<span class="string">&quot;name&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;servlet save name ==&gt;&quot;</span> + name);</span><br><span class="line">		<span class="comment">//2.产生响应</span></span><br><span class="line">		resp.setcontentType(<span class="string">&quot;text/json;charset=utf-8&quot;</span>);</span><br><span class="line">		PrintWriter pw=resp.getWriter();</span><br><span class="line">		pw.write( s:<span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;servlet save&#x27;&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="meta">@override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpservletRequest reg, HttpservletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">	<span class="built_in">this</span>.doGet(reg,resp);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>用mvc做就变成只有一个类，里面集成了四个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Usercontroller</span>&#123;</span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(String name)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;springmvc save name ==&gt;&quot;</span> + name);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;springmvc save&#x27;&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="入门案例"><a href="#入门案例" class="headerlink" title="入门案例"></a>入门案例</h2><p>①：使用SpringMVc技术需要先导入SpringMVc坐标与Servlet坐标，也就是导入maven</p>
<p>②：创建SpringMVC控制器类(等同于servlet功能)，用@Component是定义bean，但在mvc中开发表现层的bean要用@Controller这个注解</p>
<p>③：初始化SpringMVC环境(同Spring环境)，设定SpringMVC加载对应的bean</p>
<p>④：初始化Servlet容器，加载SpringMVC环境，并设置SpringMVC技术处理的请求。在mvc中提供了一个专用的开发web容器的配置类，只需要自己定义一个类然后继承就行了</p>
<p>然后新建项目，在pom.xml配置，导入servlet包说会与tomcat有冲突，之前的web里学的是启动项参数（大概），这里是加了个标签provided，意思是在编译时可用运行时不可用，test相反</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后新建controller包UserController类，返回json就是String类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.定义controller</span></span><br><span class="line"><span class="comment">//2.1使用@controller定义bean</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">	<span class="comment">//2.2设置当前操作的访问路径，对应下面第五步，/save对应save方法</span></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line">	<span class="comment">//2.3设置当前操作的返回值类型</span></span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;user save...”);</span></span><br><span class="line"><span class="string">		return &quot;</span>&#123;<span class="string">&#x27;module&#x27;</span>:<span class="string">&#x27;springmvc&#x27;</span>&#125;<span class="string">&quot;;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br></pre></td></tr></table></figure>

<p>再新建一个spring配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.创建springmvc的配置文件，加载controller对应的bean</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima.controller&quot;)</span><span class="comment">//看下面的第四步</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcConfig</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>再做一个tomcat容器启动的配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.定义一个servlet容器启动的配置类，在里面加载spring的配置</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContainersInitConfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractDispatcherServletInitializer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//加载mvc配置</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> WebApplicationContext <span class="title function_">createServletApplicationContext</span><span class="params">()</span>&#123;<span class="comment">//看下面工作流程的第二步</span></span><br><span class="line">		<span class="type">AnnotationConfigWebApplicationcontext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigWebApplicationContext</span>();<span class="comment">//注意这个是应用于web的，是初始化一个空容器</span></span><br><span class="line">        <span class="comment">//注册配置，看下面的第三步</span></span><br><span class="line">		ctx.register(SpringMvcConfig.class);</span><br><span class="line">		<span class="keyword">return</span> ctx;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//设置哪些发过来的请求归属springMVc处理，对应下面的第六步</span></span><br><span class="line">	<span class="keyword">protected</span> String[] getServletMappings()&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">string</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;<span class="comment">//一个斜杠就是所有请求</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//加载spring容器配置</span></span><br><span class="line">	<span class="keyword">protected</span> WebApplicationContext <span class="title function_">createRootApplicationContext</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="comment">//把上面mvc的直接复制古来然后把括号里的mvc删掉就是spring的配置了</span></span><br><span class="line">        <span class="type">AnnotationConfigWebApplicationcontext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigWebApplicationContext</span>();</span><br><span class="line">		ctx.register(SpringConfig.class);</span><br><span class="line">		<span class="keyword">return</span> ctx;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>名称:@Controller</p>
<ul>
<li>类型:类注解</li>
<li>位置:SpringMvc控制器类定义上方</li>
<li>作用:设定SpringMVc的核心控制器bean</li>
</ul>
<p>名称:@RequestMapping</p>
<ul>
<li>类型:方法注解</li>
<li>位置:SpringMVc控制器方法定义上方</li>
<li>作用:设置当前控制器方法请求访问路径</li>
<li>相关属性：value：请求访问路径</li>
</ul>
<p>名称:@ResponseBody</p>
<ul>
<li><p>类型:方法注解</p>
</li>
<li><p>位置:SpringMVc控制器方法定义上方</p>
</li>
<li><p>作用:设置当前控制器方法响应内容为当前返回值，无需解析</p>
</li>
<li><p>AbstractDispatcherServletInitializer类是SpringMVC提供的快速初始化Web3.8容器的抽象类</p>
</li>
<li><p>AbstractDispatcherServletInitializer提供三个接口方法供用户实现</p>
<ul>
<li>createServletApplicationContext()方法，创建Servlet容器时，加载SpringMVC对应的bean并放入<br>WebApplicationContext对象范围中，而webApplicationContext的作用范围为ServletContext范围，即整个web容器范围</li>
<li>getservletMappings()方法，设定SpringMVC对应的请求映射路径，设置为&#x2F;表示拦截所有请求，任意请求都将转入到SpringMVc进行处理</li>
<li>createRootApplicationcontext()方法，如果创建Servlet容器时需要加载非SpringMVC对应的bean，使用当前方法进行，使用方式同createservletApplicationcontext()</li>
</ul>
</li>
</ul>
<h3 id="入门案例工作流程分析"><a href="#入门案例工作流程分析" class="headerlink" title="入门案例工作流程分析"></a>入门案例工作流程分析</h3><p>启动服务器初始化过程：</p>
<ol>
<li><p>服务器启动，执行ServletContainersInitConfig类，初始化web容器</p>
</li>
<li><p>执行createServletApplicationContext方法，创建了WebApplicationcontext对象，这个对象就是mvc最终体现的对象，有了这个对象就被加载到了web容器中，但被加载到什么位置呢，就是ServletContext，最大范围的这个</p>
</li>
<li><p>加载SpringMvcConfig</p>
</li>
<li><p>执行@Componentscan加载对应的bean</p>
</li>
<li><p>加载Usercontroller，每个@RequestMapping的名称对应一个具体的方法</p>
</li>
<li><p>执行getservletMappings方法，定义所有的请求都通过SpringMVC</p>
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251226193620265.png" alt="image-20251226193620265" style="zoom:50%;" /></li>
</ol>
<p>单次请求过程</p>
<ol>
<li><p>发送请求localhost&#x2F;save</p>
</li>
<li><p>web容器发现所有请求都经过SpringMVc，将请求交给SpringMVc处理</p>
</li>
<li><p>解析请求路径&#x2F;save</p>
</li>
<li><p>由&#x2F;save匹配执行对应的方法save()</p>
</li>
<li><p>执行save()</p>
</li>
<li><p>检测到有@ResponseBody直接将save()方法的返回值作为响应求体返回给请求方</p>
</li>
</ol>
<h2 id="bean加载控制"><a href="#bean加载控制" class="headerlink" title="bean加载控制"></a>bean加载控制</h2><p>Controller加载控制与业务bean加载控制</p>
<ul>
<li>SpringMVC相关bean(表现层bean)，加载Controller</li>
<li>Spring控制的bean，加载dao之类的<ul>
<li>业务bean(service)</li>
<li>功能bean(DataSource等)</li>
</ul>
</li>
</ul>
<p>思考：</p>
<p>1：因为功能不同，如何避免Spring错误的加载到SpringMvc的bean?</p>
<p>方法：加载Spring控制的bean的时候排除掉springMVc控制的bean</p>
<ul>
<li>SpringMvc相关bean加载控制<ul>
<li>SpringMVc加载的bean对应的包均在com.itheima.controller包内</li>
</ul>
</li>
<li>Spring相关bean加载控制<ul>
<li>方式一:Spring加载的bean设定扫描范围为com.itheima，排除掉controller包内的bean</li>
<li>方式二:Spring加载的bean设定扫描范围为精准范围，例如service包、dao包等</li>
<li>方式三:不区分Spring与springMvc的环境，加载到同一个环境中</li>
</ul>
</li>
</ul>
<p>方式二（主要使用），注意必须要写这个扫描包，否则通用性会变差，导致没有数据层的bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.itheima.service&quot;,&quot;com.itheima.dao&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springconfig</span> &#123;</span><br></pre></td></tr></table></figure>

<p>方式一：设定排除哪些东西，点进ComponentScan可以找到excludeFilter设定排除过滤器和includeFilter设定包含过滤器。点进excludeFilter看后面需要什么参数，是一个filter，这个filter是什么呢再点进去看看是在ComponentScan注解里面，所以@ComponentScan.Filter，点进filter里面也有些参数，也就是过滤规则。</p>
<p>点进type看看里面需要个filterType，就是用它，然后idea会给出提示用哪些规则，ANNOTATION是根据注解进行排除，排除哪种注解就用class</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(value=&quot;com.itheima&quot;,</span></span><br><span class="line"><span class="meta">	excludeFilter = @ComponentScan.Filter)(</span></span><br><span class="line"><span class="meta">    	type = FilterType.ANNOTATION,</span></span><br><span class="line"><span class="meta">    	class = Controller.class</span></span><br><span class="line"><span class="meta">       )</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springconfig</span> &#123;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Configuration</span></span><br><span class="line"><span class="meta">@componentScan(&quot;com.itheima.controller&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springMvcconfig</span> &#123;</span><br></pre></td></tr></table></figure>

<p>然后测试Controller有没有被获取的时候需要把springConfig里的@configuration注释掉，这是为什么？就是虽然在下面的class把Controller排除了，但是springConfig的注解又给加上了，在springConfig设定扫描的时候如果某个类有@configuration，那么这个类也会被扫描，同时里面的bean也会被加载。如果要留着@configuration那就可以把@componentScan注释掉，这样controller也不会被加载</p>
<p>对此两种方式学完了</p>
<p><strong>简化开发：</strong></p>
<p>然后回到加载配置文件类里，一个是加载mvc配置文件一个是加载spring配置文件，能不能就给一个配置文件名，点开配置类继承的AbstractDispatcherServletInitializer，看一下层次结构还有一个子类，以后只需要继承这个类就可以变得更简单，实现里面三个方法然后把配置类写上就行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">servletcontainersInitconfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationconfigDispatcherservletInitializer</span></span><br><span class="line">	<span class="keyword">protected</span> class&lt;?&gt;[]getRootconfigclasses()&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">class</span>[]&#123;SpringConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">protected</span> class&lt;?&gt;[]getServletconfigclasses()&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringMvcConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">protected</span> string[l <span class="title function_">getservletMappings</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">string</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="网页调试与发送网页HTTP请求的插件"><a href="#网页调试与发送网页HTTP请求的插件" class="headerlink" title="网页调试与发送网页HTTP请求的插件"></a>网页调试与发送网页HTTP请求的插件</h2><p>老师教的是postman，但我用的是apifox，所以看个原理就行</p>
<p>主要作用是模拟浏览器发送请求，比如发送get请求在地址栏写一下就行，但post请求就得写个表单，ajax就得写个js文件，但使用了这个工具，上面的工作就不用做了</p>
<p>先新建工作空间，这里面的操作可以备份和记录，然后新建请求，选择请求的类型比如get，然后输入地址点击发送就可以</p>
<h2 id="请求与响应"><a href="#请求与响应" class="headerlink" title="请求与响应"></a>请求与响应</h2><h3 id="请求的映射路径"><a href="#请求的映射路径" class="headerlink" title="请求的映射路径"></a>请求的映射路径</h3><p>准备数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Usercontroller</span> &#123;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line">    <span class="comment">//@RequestMapping(&quot;/user/save&quot;)</span></span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;user save..&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user save&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="comment">//@RequestMapping(&quot;/user/delete&quot;)</span></span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;user delete...&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user delete&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bookcontroller</span> &#123;</span><br><span class="line">	<span class="comment">//@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/book/save&quot;)</span></span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;book save ...&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;book save&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里面有两个save，然后启动一下发现报错</p>
<p>com.itheima.controller.UserController#save()<br>to{&#x2F;save}: There is already “bookController’ bean method</p>
<p>意思是&#x2F;save已经被bookController的bean方法用过了</p>
<p>1.团队多人开发，每人设置不同的请求路径，冲突问题如何解决——设置模块名作为请求路径前缀，比如@RequestMapping(“&#x2F;user&#x2F;save”)</p>
<p>也可以把@RequestMapping(“&#x2F;user”)放在整个类上面定义整个模块的请求路径前缀</p>
<h3 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h3><p><strong>get方式：</strong></p>
<p>准备数据ServletContainersInitConfig简单配置，SpringMvcConfig</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Componentscan(&quot;com.itheima.controller&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springMvcconfig</span> &#123;</span><br></pre></td></tr></table></figure>

<p>控制器类，如果请求的路径是<a href="http://localhost/commonParam?name=itcast%EF%BC%8C%E8%BF%99%E4%B8%AAname%E5%8F%82%E6%95%B0%E6%80%8E%E4%B9%88%E6%8E%A5%E6%94%B6%E5%91%A2%EF%BC%8C%E5%9C%A8%E6%8B%AC%E5%8F%B7%E9%87%8C%E7%9B%B4%E6%8E%A5%E6%B7%BB%E5%8A%A0String%E6%9D%A5%E6%8E%A5%E6%94%B6%E5%B0%B1%E8%A1%8C%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%98%AF%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0%E5%B0%B1%E5%9C%A8%E5%90%8E%E9%9D%A2%E6%8E%A5%E7%9D%80%E6%B7%BB%E5%8A%A0%E5%B0%B1%E8%A1%8C">http://localhost/commonParam?name=itcast，这个name参数怎么接收呢，在括号里直接添加String来接收就行，如果是多个参数就在后面接着添加就行</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">	<span class="comment">//普通参数</span></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/commonParam&quot;)</span></span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">commonParam</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;普通参数传递 name ==&gt;&quot;</span>+ name);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;common param&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>Post方式：</strong></p>
<p>在这里不管是post还是get请求，对于后台代码是没有变化的不区分的，和之前的Servlet是不一样的。请求地址：<a href="http://localhost/commonParam%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%E8%80%81%E5%B8%88%E6%BC%94%E7%A4%BA%E7%9A%84%E5%B7%A5%E5%85%B7%E9%87%8C%E4%B8%8D%E8%83%BD%E5%86%8D%E7%82%B9params%E4%BA%86%EF%BC%8C%E5%9B%A0%E4%B8%BApost%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8F%82%E6%95%B0%E5%B1%9E%E4%BA%8E%E8%AF%B7%E6%B1%82%E4%BD%93%E5%86%85%EF%BC%8C%E6%89%80%E4%BB%A5%E8%A6%81%E7%82%B9body%E8%BF%99%E9%A1%B9">http://localhost/commonParam，然后在老师演示的工具里不能再点params了，因为post请求的参数属于请求体内，所以要点body这项</a></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251228003332321.png" alt="image-20251228003332321"></p>
<p>如果是发表单数据应该用这个选项，和左边的区别在于这个不仅能发表单还能发文件，代码还是使用上面的，设置以下参数</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251228003851644.png" alt="image-20251228003851644"></p>
<p>如果把英文值改成中文，就会出现乱码现象，之前的处理方式是在web服务器设置一个过滤器，这里也是一样，只不过要在ServletContainersInitConfig里配置，用override覆盖方法。可以看到这里是要一个Filter数组，那么就可以直接new一个filter数组然后把过滤器对象放进去。但是过滤器在哪，springmvc有现成的字符过滤器，设定好字符集后直接把filter放进去就行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContainersInitConfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigpispatcherservletInitializer</span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>];&#125;</span><br><span class="line">	<span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringMvcConfig.class&#125;; &#125;</span><br><span class="line">	<span class="keyword">protected</span> String[] getServletMappings()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;; &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//乱码处理</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> Filter[] getservletFilters()&#123;</span><br><span class="line">		<span class="type">CharacterEncodingFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">characterEncodingFilter</span>();</span><br><span class="line">		filter.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Filter</span>[]&#123;filter);</span><br><span class="line">		<span class="comment">//return new Filter[]&#123;filter,filter1,filter2);设置多个过滤器</span></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>

<p>这个characterEncodingFilter在哪里？图下坐标包含了这个</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251228154530141.png" alt="image-20251228154530141"></p>
<h3 id="请求参数"><a href="#请求参数" class="headerlink" title="请求参数"></a>请求参数</h3><p>**普通参数：**url地址传参，地址参数名与形参变量名相同，定义形参即可接收参数</p>
<p>之前提到过一个问题就是get请求里的name与代码里的名字不一样，还能接收吗，答案是不能，解决方式是添加@RequestParam，也就是把请求参数中的name给到username</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/commonParamDifferentName&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> string <span class="title function_">commonParamDifferentName</span><span class="params">(<span class="meta">@RequestParam(&quot;name&quot;)</span>String userName , <span class="type">int</span> age)</span>&#123;</span><br></pre></td></tr></table></figure>

<p>**pojo参数：**传参的目的是通过大量的数据组成一个model，下面这个user里面有两个属性name和age，然后发送<a href="http://localhost/pojoParam?name=itcast&age=15%EF%BC%8C%E8%BF%98%E6%98%AF%E8%83%BD%E8%A2%AB%E6%8E%A5%E6%94%B6%E5%88%B0%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E5%89%8D%E9%9D%A2%E7%9A%84%E5%B1%9E%E6%80%A7%E5%90%8D%E5%92%8C%E5%90%8E%E9%9D%A2%E5%AE%9E%E4%BD%93%E7%B1%BB%E7%9A%84%E5%B1%9E%E6%80%A7%E5%90%8D%E4%B8%80%E6%A0%B7%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%8A%A8%E6%8A%8A%E5%B1%9E%E6%80%A7%E5%A1%9E%E8%BF%9B%E5%8E%BB">http://localhost/pojoParam?name=itcast&amp;age=15，还是能被接收到，也就是前面的属性名和后面实体类的属性名一样就可以自动把属性塞进去</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P0J0参数</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/pojoParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">pojoParam</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> string name;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">private</span> Address address;<span class="comment">//后面加上了get和tostring方法，这里省略</span></span><br></pre></td></tr></table></figure>

<p>然后还有个实体类里面定义了省市，然后封装成一个对象，然后加到上面</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Address</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String province;</span><br><span class="line">	<span class="keyword">private</span> String city;</span><br></pre></td></tr></table></figure>

<p>然后要给实体类里某个对象传属性值应该怎么做，以下这样做就可以</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251229170705867.png" alt="image-20251229170705867"></p>
<p>**数组参数：**比如你的个人爱好之类的，是很多个数据，比如复选框，可以用以下接收</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数组参数</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/arrayParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">arrayParam</span><span class="params">(String[] likes)</span>&#123;</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251229173509907.png" alt="image-20251229173509907"></p>
<p>但是java编程一般用集合比较多</p>
<p><strong>集合参数：</strong></p>
<p>还是用上面的数据发送看看有什么结果，发现报错了，提示NoSuchMethodException没有这个方法，后面还有java.util.List.<init>()，只要出现<init>代表的就是构造方法，list是个接口本身就不会有构造方法。他现在是在尝试造一个list<Stirng>类型的对象，为什么要造这个对象呢，因为这是引用类型，上面的那些也都是引用类型，所以都是准备造个对象然后setlike属性，但我们要的是作为集合的参数放进去。</p>
<p>用@RequestParam告诉他吧那些东西作为参数扔进去，只要是集合就不按照造对象的方法来了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//集合参数</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/listParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="comment">//public String listParam(List&lt;String&gt; likes)&#123;</span></span><br><span class="line">/<span class="keyword">public</span> String <span class="title function_">listParam</span><span class="params">(<span class="meta">@RequestParam</span> List&lt;String&gt; likes)</span>&#123;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>名称:@RequestParam</p>
</li>
<li><p>类型:形参注解</p>
</li>
<li><p>位置:SpringMVc控制器方法形参定义前面</p>
</li>
<li><p>作用:绑定请求参数与处理器方法形参间的关系</p>
</li>
<li><p>参数:</p>
<ul>
<li>required:是否为必传参数</li>
<li>defaultValue:参数默认值</li>
</ul>
</li>
</ul>
<h3 id="json数据"><a href="#json数据" class="headerlink" title="json数据"></a>json数据</h3><p>先在pom导入json，然后发送数据，在body里选择raw然后选择json</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251230024829629.png" alt="image-20251230024829629"></p>
<p>接收代码，但目前mvc不知道外面过来的json要转化成List，需要开启一个功能键，让它帮忙做这种转化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//集合参数:json格式</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/listParamForJson&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">listParamForJson</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;String&gt; likes)</span></span><br></pre></td></tr></table></figure>

<p>在mvc配置中添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.itheima.controller&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span><span class="comment">//开启这个</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springMvcconfig</span> &#123;</span><br></pre></td></tr></table></figure>

<p>然后运行还是报错无法造<init>对象，然后这次信息是在请求体里，也就是requestbody中，@RequestParam就不好用了，用@RequestBody就可以了</p>
<p>如果是传给pojo的，在body里变成这样，然后加上@RequestBody就行</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20251230033804617.png" alt="image-20251230033804617"></p>
<p>集合也是一样</p>
<ul>
<li><p>名称:@EnableWebMvc</p>
</li>
<li><p>类型:配置类注解</p>
</li>
<li><p>位置:SpringMvc配置类定义上方</p>
</li>
<li><p>作用:开启SpringMvc多项辅助功能</p>
</li>
<li><p>名称:@RequestBody</p>
</li>
<li><p>类型:形参注解</p>
</li>
<li><p>位置:SpringMVC控制器方法形参定义前面</p>
</li>
<li><p>作用:将请求中请求体所包含的数据传递给请求参数，此注解一个处理器方法只能使用一次</p>
</li>
</ul>
<p><strong>@RequestBody与@RequestParam区别</strong></p>
<ul>
<li>区别<ul>
<li>@RequestParam用于接收url地址传参，表单传参【application&#x2F;x-www-form-urlencoded】</li>
<li>@RequestBody用于接收json数据【application&#x2F;json】，在postman软件里发送的请求头中找到content-type，这里指定的是application&#x2F;json，老师说以前手写发ajax强求时这项要自己手写，现在自动加上了，如果是post的话这一项就变成了application&#x2F;x-www-form-urlencoded</li>
</ul>
</li>
<li>应用<ul>
<li>后期开发中，发送json格式数据为主，@RequestBody应用较广</li>
<li>如果发送非ison格式数据，选用@RequestParam接收请求参数</li>
</ul>
</li>
</ul>
<h3 id="日期类型参数传递"><a href="#日期类型参数传递" class="headerlink" title="日期类型参数传递"></a>日期类型参数传递</h3><p>如果是标准日期格式比如2012&#x2F;02&#x2F;02是可以直接由字符串转换成日期格式，但如果不是标准格式就需要用@DateTimeFormat后面带上格式就行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(Ov&quot;/dataParam&quot;</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">public string dataParam(Date date,</span></span><br><span class="line"><span class="meta">                        @DateTimeFormat(pattern=&quot;yyyy-MM-dd&quot;)Date date1,</span></span><br><span class="line"><span class="meta">                        @DateTimeFormat(pattern=&quot;yyyy/MM/dd HH:mm:ss&quot;)Date date2)&#123;</span></span><br></pre></td></tr></table></figure>

<p>这个注解内部是怎么工作的呢？里面用到了类型转换器converter，它是个接口，打开时注意包的位置在springframework里，这个接口就定义了一个方法T convert(S source);，这个接口的作用是将你传递的参数与我们要收集的参数进行转换，有非常多的实现类来帮助转换</p>
<h2 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h2><p>相应页面，注意这里没有加@RequsetBody</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">	<span class="comment">//响应页面/跳转页面</span></span><br><span class="line">	<span class="meta">@RequestMapping(&quot;/toJumpPage&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">toJumpPage</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;跳转页面&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;page.jsp&quot;</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;Hejlo Spring Mvc!&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>然后访问路径就可以看到page.jsp的内容被输出了，在mvc中想要响应页面只需要把页面名称写在return里然后返回字符串就可以了</p>
<p>如果只想返回文本呢，如果没加@ResponseBody会报错No mapping for GET&#x2F;response text，它在找一个叫response text的页面，而response text只是个文本，所以要加上@ResponseBody就行了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//响应文本数据</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/toText&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toText</span><span class="params">()</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;返回纯文本数据&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;response text&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>然后是响应json数据，如果想响应pojo对象，只需要把方法的返回值设成pojo对象然后再return这个对象就行了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//响应P0J0对象</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/toJsonP0J0&quot;)</span></span><br><span class="line"><span class="keyword">public</span> User to]sonPo]<span class="number">0</span>()&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;返回json对象数据&quot;</span>);</span><br><span class="line">	<span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">	user.setName(<span class="string">&quot;itcast&quot;</span>);</span><br><span class="line">	user.setAge(<span class="number">15</span>);</span><br><span class="line">	<span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但这样运行会报错，因为mvc对User返回值的要求默认是要个字符串，会把return user认成字符串”user”，所以还是要加@ResponseBody，而转换的这个操作是pom里导入的jackson帮我们做的，集合的获取也是这样</p>
<ul>
<li>名称:@ResponseBody</li>
<li>类型:方法注解</li>
<li>位置:SpringMVc控制器方法定义上方</li>
<li>作用:设置当前控制器方法响应内容为当前返回值，无需解析</li>
<li>作用:设置当前控制器返回值作为响应体</li>
</ul>
<p>实现这个转换的过程是一个叫HttpMessageConverter的接口，专门转换http消息的，打开类型层次图找到MappingJackson2HttpMessageConverter就是最终的实现类了</p>
<h2 id="REST风格"><a href="#REST风格" class="headerlink" title="REST风格"></a>REST风格</h2><ul>
<li>REST(Representational state Transfer)，表现形式状态转换，在开发中就是叫做访问网络资源的格式<ul>
<li>传统风格资源描述形式<br><a href="http://localhost/user/getById?id=1">http://localhost/user/getById?id=1</a><br><a href="http://localhost/user/saveUser">http://localhost/user/saveUser</a></li>
<li>REST风格描述形式<br><a href="http://localhost/user/1">http://localhost/user/1</a><br><a href="http://localhost/user">http://localhost/user</a></li>
</ul>
</li>
</ul>
<p>这两个链接和上面的作用完全一样</p>
<ul>
<li><p>优点:</p>
<ul>
<li>隐藏资源的访问行为，无法通过地址得知对资源是何种操作</li>
<li>书写简化</li>
</ul>
</li>
<li><p>按照REST风格访问资源时使用行为动作区分对资源进行了何种操作</p>
<ul>
<li><a href="http://localhost/users%E6%9F%A5%E8%AF%A2%E5%85%A8%E9%83%A8%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF">http://localhost/users查询全部用户信息</a> GET(查询)</li>
<li><a href="http://localhost/users/1%E6%9F%A5%E8%AF%A2%E6%8C%87%E5%AE%9A%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AFGET(%E6%9F%A5%E8%AF%A2)">http://localhost/users/1查询指定用户信息GET(查询)</a></li>
<li><a href="http://localhost/users%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AFPOST(%E6%96%B0%E5%A2%9E/%E4%BF%9D%E5%AD%98)">http://localhost/users添加用户信息POST(新增/保存)</a></li>
<li><a href="http://localhost/users%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AFPUT(%E4%BF%AE%E6%94%B9/%E6%9B%B4%E6%96%B0)">http://localhost/users修改用户信息PUT(修改/更新)</a></li>
<li><a href="http://localhost/users/1%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AFDELETE(%E5%88%A0%E9%99%A4)">http://localhost/users/1删除用户信息DELETE(删除)</a></li>
</ul>
</li>
</ul>
<p>上述行为是约定方式，约定不是规范，可以打破，所以称REST风格，而不是REST规范<br>描述模块的名称通常使用复数，也就是加s的格式描述，表示此类资源，而非单个资源，例如:users、books、accounts.</p>
<ul>
<li>根据REST风格对资源进行访问称为RESTful，开发使用这个风格开发就叫RESTful</li>
</ul>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p>根据之前的代码进行更改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"><span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;user save...&quot;</span>+ user);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user save&#x27;&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>然后更改，先不传参，第一链接那里要写users，第二步指定请求行为，点进RequestMapping可以看到有个叫method的，这个可以设定对应的请求方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"><span class="meta">@RequestMapping(Value =&quot;/users&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;user save...&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user save&#x27;&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>再改个delete,在请求路径上包含了一个值1，要想让id参数对应请求路径就要用到@PathVariable，也就是路径变量的意思，只有这个注解不够，还要告诉来自路径中的哪里，所以要加&#x2F;{id}进行匹配</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users/&#123;id&#125;,method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> string <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">”+ id);</span><br><span class="line">System.out.println(<span class="string">&quot;user delete...</span></span><br><span class="line"><span class="string">return &quot;</span>&#123;<span class="string">&#x27;module&#x27;</span>:<span class="string">&#x27;user delete&#x27;</span>&#125;<span class="string">&quot;;</span></span><br></pre></td></tr></table></figure>

<p>@RequestBody、@RequestParam、@PathVariable</p>
<ul>
<li>区别<ul>
<li>@RequestParam用于接收url地址传参或表单传参</li>
<li>@RequestBody用于接收json数据</li>
<li>@PathVariable用于接收路径参数，使用{参数名称}描述路径参数</li>
</ul>
</li>
<li>应用<ul>
<li>后期开发中，发送请求参数超过1个时，以json格式为主，@RequestBody应用较广</li>
<li>如果发送非json格式数据，选用@RequestParam接收请求参数</li>
<li>采用RESTfu1进行开发，当参数数量较少时，例如1个，可以采用@Pathvariable接收请求路径变量，通常用于传递id值</li>
</ul>
</li>
</ul>
<h3 id="restful快速开发"><a href="#restful快速开发" class="headerlink" title="restful快速开发"></a>restful快速开发</h3><p>value&#x3D;”&#x2F;books”和@ResponseBody这种重复代码写起来很繁琐能不能简化呢。可以用@ReqstMapping(“&#x2F;books”)代替前面重复的value那些，但是有参数的还是要留着{id}这种。</p>
<p>然后@ResponseBody可以拿到外面了，而springmvc给合成了一个@RestController，里面包含了这两个注解。</p>
<p> @RequestMapping(value &#x3D; “&#x2F;{id}”,method &#x3D; RequestMethod.DELETE)这个就简化成了DeleteMapping(“&#x2F;{id}”)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Controller</span></span><br><span class="line"><span class="comment">//@ResponseBody</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@ReqstMapping(&quot;/books”)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> &#123;</span><br><span class="line">    <span class="comment">//@RequestMapping(value = &quot;/&#123;id&#125;&quot;,method = RequestMethod.DELETE)</span></span><br><span class="line">    <span class="comment">//DeleteMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> string <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;book delete...&quot;</span>+ id);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;book delete&#x27;&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="案例-基于RESTful页面数据交互"><a href="#案例-基于RESTful页面数据交互" class="headerlink" title="案例:基于RESTful页面数据交互"></a>案例:基于RESTful页面数据交互</h3><p>能正常展示数据，并且点击新建按钮输入信息后能提交到后台</p>
<p>先把后台的controller做出来然后再使用postman测通，然后让页面能运行，然后发送ajax提交能访问后台表现层接口</p>
<p>准备数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Componentscan(&quot;com.itheima.controller&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcConfig</span> &#123;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">servletcontainersInitconfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherservletInitializer</span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> Class&lt;?&gt;[] getRootconfigclasses()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">class</span>[<span class="number">0</span>]; &#125;</span><br><span class="line">	<span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigclasses()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">class</span>[]&#123;springMvcConfig.class&#125;; &#125;</span><br><span class="line">	<span class="keyword">protected</span> String[] getservletMappings()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;; &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//乱码处理</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> Filter[] getservletFilters()&#123;</span><br><span class="line">		<span class="type">CharacterEncodingFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CharacterEncodingFilter</span>();</span><br><span class="line">		filter.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Filter</span>[]&#123;filter&#125;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>domain包下Book类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String type;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> String description;</span><br><span class="line">    下面是tostring和setget方法</span><br></pre></td></tr></table></figure>

<p>创建BookController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/books&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> Book book)</span>&#123;<span class="comment">//要记得加@RequestBody接收json数据</span></span><br><span class="line">		System.out.println(<span class="string">&quot;book save ==&gt;&quot;</span>+ book);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;book save success&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">   <span class="meta">@GetMapping</span></span><br><span class="line">   <span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">getAll</span><span class="params">()</span>&#123;</span><br><span class="line">		List&lt;Book&gt;bookList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Book&gt;();</span><br><span class="line">		<span class="type">Book</span> <span class="variable">book1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line">		book1.setType(<span class="string">&quot;计算机&quot;</span>);</span><br><span class="line">		book1.setName(<span class="string">&quot;springMvc入门教程&quot;</span>);</span><br><span class="line">		book1.setDescription(<span class="string">&quot;小试牛刀&quot;</span>);</span><br><span class="line">		bookList.add(book1);<span class="comment">//添加到集合里</span></span><br><span class="line">       </span><br><span class="line">		<span class="type">Book</span> <span class="variable">book2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line">		book2.setType(<span class="string">&quot;计算机&quot;</span>);</span><br><span class="line">		book2.setName(<span class="string">&quot;springMVc实战教程&quot;</span>);</span><br><span class="line">		book2.setDescription(<span class="string">&quot;一代宗师&quot;</span>);</span><br><span class="line">		bookList.add(book2);</span><br><span class="line">		<span class="keyword">return</span> bookList: </span><br></pre></td></tr></table></figure>

<p>然后postman发送和接收一下测试测试</p>
<p>然后把html的那些东西复制到webapp文件夹里，运行一下服务器，然后访问html网址，结果404，后台输出提示[WARNING] No mapping for GET &#x2F;pages&#x2F;books.html，是被mvc拦截了，它认为应该有个配置叫books.html，所以应该把这个放行交给tomcat处理，问题出在下面，”&#x2F;“是把所有请求都经过mvc，应该把静态资源不过mvc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">servletcontainersInitconfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherservletInitializer</span>&#123;</span><br><span class="line">    	<span class="keyword">protected</span> String[] getservletMappings()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;; &#125;</span><br></pre></td></tr></table></figure>

<p>方案一：做一个功能类，在config里新建一个SpringmvcSupport</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcSupport</span> <span class="keyword">extends</span> <span class="title class_">WebMvcconfigurationSupport</span> &#123;<span class="comment">//继承这个类</span></span><br><span class="line">	<span class="meta">@override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span>&#123;<span class="comment">//查看继承类有什么关于source的方法，找到了这个</span></span><br><span class="line">    <span class="comment">//当访问/pages/**的时候，走/pages目录下的内容</span></span><br><span class="line">	registry.addResourceHandler(<span class="string">&quot;/pages/**&quot;</span>).addResourceLocations(<span class="string">&quot;/pages/&quot;</span>);<span class="comment">//这里的意思是如果发送的是/pages/**请求就走/pages/下的内容</span></span><br></pre></td></tr></table></figure>

<p>写完上面的代码记得必须要有个动作就是让mvc启动时加载这里，加上@Configuration然后在Springmvc配置类里改成</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.itheima.controller&quot;,&quot;com.itheima.config&quot;)</span></span><br></pre></td></tr></table></figure>

<p>以后要放行什么就在SpringmvcSupport继续添加就行</p>
<p>这里是vue代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//主页列表查询</span></span><br><span class="line"><span class="title function_">getA11</span>(<span class="params"></span>)&#123;</span><br><span class="line">	axios.<span class="title function_">get</span>(<span class="string">&quot;/books&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">dataList</span> = res,data;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//添加</span></span><br><span class="line"><span class="title function_">saveBook</span>(<span class="params"></span>)&#123;</span><br><span class="line">	axios.<span class="title function_">post</span>(<span class="string">&quot;/books&quot;</span>,<span class="variable language_">this</span>.<span class="property">formData</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">	&#125;);<span class="comment">//这里是post要提交数据，所以路径后面要加上this.formData</span></span><br></pre></td></tr></table></figure>

<h2 id="SSM整合"><a href="#SSM整合" class="headerlink" title="SSM整合"></a>SSM整合</h2><h3 id="SSM整合流程"><a href="#SSM整合流程" class="headerlink" title="SSM整合流程"></a>SSM整合流程</h3><ol>
<li><p>创建工程</p>
</li>
<li><p>SSM整合</p>
<ul>
<li><p>Spring</p>
<ul>
<li>SpringConfig</li>
</ul>
</li>
<li><p>MyBatis</p>
<ul>
<li><p>MybatisConfig</p>
</li>
<li><p>Jdbcconfig</p>
</li>
<li><p>jdbc.properties</p>
</li>
</ul>
</li>
<li><p>SpringMVC</p>
<ul>
<li><p>ServletConfig</p>
</li>
<li><p>SpringMvcConfig</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>功能模块</p>
<ul>
<li>表与实体类</li>
<li>dao(接口+自动代理)</li>
<li>service(接口+实现类<ul>
<li>业务层接口测试(整合Junit)</li>
</ul>
</li>
<li>controller<ul>
<li>表现层接口测试(PostMan)</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>先导入pom，里面有Spring、mybatis、mybatisSpring整合、mysql、junit、Servlet、jackson</p>
<p>再创建包config、controller、dao、domain、Service、impl</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span><span class="comment">//配置类</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.itheima.service&quot;&#125;)</span><span class="comment">//扫描包</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;jdbc.properties&quot;)</span><span class="comment">//加载jdbc配置文件（里面是连接jdbc的信息）</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class,MyBatisConfig.class&#125;)</span><span class="comment">//加载配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springconfig</span> &#123;</span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/ssm db</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Jdbcconfig</span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.driver&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String driver;,</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;jdbc.url&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String url;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="meta">@Value(&quot;$&#123;jdbc.password&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@bean</span></span><br><span class="line">	<span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">		dataSource.setDriverclassName(driver);</span><br><span class="line">		datasource.setUrl(url);</span><br><span class="line">		dataSource.setUsername(username);</span><br><span class="line">		dataSource.setPassword(password);</span><br><span class="line">		<span class="keyword">return</span> dataSource;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBatisconfig</span> &#123;</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> SqlSessionFactoryBean <span class="title function_">sqlSessionFactory</span><span class="params">(DataSource dataSource)</span>&#123;<span class="comment">//这里的dataSource是Spring容器根据类型自动装配</span></span><br><span class="line">	<span class="type">SqlSessionFactoryBean</span> <span class="variable">factoryBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBean</span>();</span><br><span class="line">	factoryBean.setDataSource(dataSource);</span><br><span class="line">	factoryBean.setTypeAliasesPackage(<span class="string">&quot;com.itheima.domain&quot;</span>);<span class="comment">//类型别名扫描包</span></span><br><span class="line">	<span class="keyword">return</span> factoryBean;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//映射扫描（Dao）</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> MapperscannerConfigurer <span class="title function_">mapperScannerConfigurer</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="type">MapperScannerConfigurer</span> <span class="variable">msc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapperScannerConfigurer</span>();</span><br><span class="line">		msc.setBasePackage(<span class="string">&quot;com.itheima.dao&quot;</span>);<span class="comment">//扫描包</span></span><br><span class="line">		<span class="keyword">return</span> msc;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">servletcontainersInitconfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherservletInitializer</span>&#123;</span><br><span class="line">	<span class="keyword">protected</span> Class&lt;?&gt;[] getRootconfigclasses()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">class</span>[<span class="number">0</span>]; &#125;</span><br><span class="line">	<span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigclasses()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">class</span>[]&#123;springMvcConfig.class&#125;; &#125;</span><br><span class="line">	<span class="keyword">protected</span> String[] getservletMappings()&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;; &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//乱码处理</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> Filter[] getservletFilters()&#123;</span><br><span class="line">		<span class="type">CharacterEncodingFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CharacterEncodingFilter</span>();</span><br><span class="line">		filter.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Filter</span>[]&#123;filter&#125;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Componentscan(&quot;com.itheima.controller&quot;)</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcConfig</span> &#123;</span><br></pre></td></tr></table></figure>

<p>这里老师提到mvc容器能访问Spring容器，反过来不行，这里是父子容器概念</p>
<h3 id="功能模块"><a href="#功能模块" class="headerlink" title="功能模块"></a>功能模块</h3><p>创建pojo对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"><span class="keyword">private</span> String type;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> String description;</span><br><span class="line"><span class="comment">//后面是setget tostring</span></span><br></pre></td></tr></table></figure>

<p>Service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="comment">//用mybatis自动代理创建实现类</span></span><br><span class="line">    <span class="comment">//@Insert(&quot;insert into tbl_book values(null,#&#123;type&#125;,#&#123;name&#125;,#&#123;description&#125;)”)这种写法括号里的字段对应book中的属性</span></span><br><span class="line">	<span class="meta">@Insert(&quot;insert into tbl_book (type,name,description)values(#&#123;type&#125;,#&#123;name&#125;,#&#123;description&#125;)&quot;//这种写法前面的type是数据库中的字段，后面的是book中的属性，没有了id的null</span></span><br><span class="line"><span class="meta">	public void save(Book book);</span></span><br><span class="line"><span class="meta">	</span></span><br><span class="line"><span class="meta">	@Update(&quot;update tbl_book set type = #&#123;type&#125;, name = #&#123;name&#125;, description = #&#123;idescription&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">	public void update(Book book);</span></span><br><span class="line"><span class="meta">	@Delete(&quot;delete from tbl_book where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">	public void delete(Integer id);</span></span><br><span class="line"><span class="meta">	@Select(&quot;select * from tbl_book where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">	public Book getById(Integer id);//查单个</span></span><br><span class="line"><span class="meta">	@Select(&quot;select * from tbl_book&quot;)</span></span><br><span class="line"><span class="meta">	public List&lt;Book&gt; getA11();//查所有</span></span><br></pre></td></tr></table></figure>

<p>这样的接口层一般是不行的，最好是见名知意，返回值用boolean用来判断返回成功或失败</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Bookservice</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 保存</span></span><br><span class="line"><span class="comment">	 <span class="doctag">@param</span> book</span></span><br><span class="line"><span class="comment">	 <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	**/</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">save</span><span class="params">(Book book)</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">update</span><span class="params">(Book book)</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line">	<span class="keyword">public</span> Book <span class="title function_">getById</span><span class="params">(Integer id)</span>;</span><br><span class="line">	<span class="keyword">public</span> List&lt;Book&gt; <span class="title function_">getA11</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<p>然后实现类，要用到dao接口了，然后注入dao</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Autowired</span><span class="comment">//注入dao</span></span><br><span class="line">	<span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">save</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">        bookDao.save(book);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//统一写true</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<pre><code>public Book getById(Integer id){
	return bookDao.getById(id);
}
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">但做ssm整合的时候如果要注入这个的东西，在整个系统中不存在，也就是Spring中没有配bookdao的bean，我们用的自动代理，所以没有对应的bean给它自动装配，所以idea在这里把bookDao做个检查然后报错，但这个报错不影响运行，在弹出的下列选项里进入到idea做语法检查的设置，有一个Autowiring for bean class是自动装配的时候对bean的类型做检测，把它勾掉或者更改提示类型为警告</span><br><span class="line"></span><br><span class="line">![image-20260101163637629](黑马程序员SSM.assets/image-20260101163637629.png)</span><br><span class="line"></span><br><span class="line">![image-20260101163817235](黑马程序员SSM.assets/image-20260101163817235.png)</span><br><span class="line"></span><br><span class="line">然后是控制层</span><br><span class="line"></span><br><span class="line">~~~java</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/books&quot;)</span><br><span class="line">public class Bookcontroller&#123;</span><br><span class="line">    @Autowired</span><br><span class="line">	private BookService bookService;</span><br><span class="line">    </span><br><span class="line">	@PostMapping</span><br><span class="line">	public boolean save(@RequestBody Book book)&#123;//从前端提交的json数据获取所以要加RequestBody</span><br><span class="line">		return bookService.save(book);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<pre><code>@DeleteMapping(&quot;/{id}&quot;)
public boolean delete(@PathVariable Integer id){
	return bookService.delete(id);
}
@GetMapping
public List&lt;Book&gt; getA11(){
	return bookService.getA11();
}
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 接口测试</span><br><span class="line"></span><br><span class="line">~~~java</span><br><span class="line">@RunWith(SpringJUnit4ClassRunner.class)//Spring整合测试类</span><br><span class="line">@ContextConfiguration(classes = SpringConfig.class)//加载配置类</span><br><span class="line">public class BookServiceTest&#123;</span><br><span class="line">    </span><br><span class="line">    @Autowired</span><br><span class="line">	private Bookservice bookservice;</span><br><span class="line">    </span><br><span class="line">	@Test</span><br><span class="line">	public void testGetById()&#123;</span><br><span class="line">		Book book = bookService.getById(1);</span><br><span class="line">		System.out.println(book);</span><br><span class="line">    &#125;//这里老师说正常测试要做断言测试，不知道是什么</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>然后是开启事务，先在SpringConfig里加上@EnableTransactionManagement，然后写事务管理器，要用到datasource，在jdbcconfig里添加代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> PlatformTransactionManager <span class="title function_">transactionManager</span><span class="params">(DataSource dataSource)</span>&#123;<span class="comment">//平台事务管理器</span></span><br><span class="line">	DataSourceTransactionManager ds= <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">	ds.setDataSource(dataSource):<span class="comment">//这里的datasource一定要从形参里拿</span></span><br><span class="line">	<span class="keyword">return</span> ds;</span><br></pre></td></tr></table></figure>

<p>然后在业务层加上@Transactional</p>
<h3 id="表现层数据封装"><a href="#表现层数据封装" class="headerlink" title="表现层数据封装"></a>表现层数据封装</h3><p>前端接收数据格式太多，增删改返回true，查单条一个json，查全部一个集合json，所以现在要整合到一个里面</p>
<ul>
<li>前端接收数据格式-创建结果模型类，封装数据到data属性中</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260101194434877.png" alt="image-20260101194434877"></p>
<p>但现在分不出返回的true是增还是删，所以再加一个code用来区分功能</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260101195035410.png" alt="image-20260101195035410"></p>
<p>又有个问题，如果查询不存在的数据，后台会返回data：null，code:20041，但这个代表成功还是失败？所以我们做个规定，结尾是1就是成功，0就是失败。所以就变成了这样，如果是20041就从data取数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">20040</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span></span><br></pre></td></tr></table></figure>

<p>然后又有问题，20040是没取到，应该给用户看什么呢，于是封装特殊消息到message(msg)属性中，变成</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">20040</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span></span><br><span class="line"><span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span><span class="string">&quot;数据查询失败，请重试！&quot;</span></span><br></pre></td></tr></table></figure>

<p>设置统一数据返回结果类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> Object data;</span><br><span class="line">	<span class="keyword">private</span> Integer code;</span><br><span class="line">	<span class="keyword">private</span> String msg;</span><br></pre></td></tr></table></figure>

<p>注意：Result类中的字段并不是固定的，可以根据需要自行增减<br>提供若干个构造方法，方便操作</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><p>其他数据继承上面的ssm整合，然后因为这是前后端沟通，要展示给前端的所以是表现层用，放到controller包里。因为是前后端沟通的所以不需要写tostring，只需要写setget，然后要提供构造方法不然就是new一个对象然后不停往里面set。构造方法分别是三个都要，data、code和无参</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> Object data;</span><br><span class="line">	<span class="keyword">private</span> Integer code;</span><br><span class="line">	<span class="keyword">private</span> String msg;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Result</span><span class="params">(Integer code,Object data)</span>&#123;</span><br><span class="line">		<span class="built_in">this</span>.data = data;</span><br><span class="line">		<span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">Result</span><span class="params">(Integer code, Object data, String msg)</span>&#123;</span><br><span class="line">		<span class="built_in">this</span>.data = data;</span><br><span class="line">		<span class="built_in">this</span>.code = code;</span><br><span class="line">		<span class="built_in">this</span>.msg = msg;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>然后再创建一个Code类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">code</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">SAVE_OK</span> <span class="operator">=</span> <span class="number">20011</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">DELETE_OK</span> <span class="operator">=</span> <span class="number">20021</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer <span class="type">UPDATE</span> <span class="variable">OK</span> <span class="operator">=</span> <span class="number">2031</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer <span class="type">GET</span> <span class="variable">OK</span> <span class="operator">=</span> <span class="number">20041</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer <span class="type">SAVE</span> <span class="variable">ERR</span> <span class="operator">=</span> <span class="number">20010</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer <span class="type">DELETE</span> <span class="variable">ERR</span> <span class="operator">=</span> <span class="number">20020</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">UPDATE_ERR</span> <span class="operator">=</span> <span class="number">20030</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer <span class="type">GET</span> <span class="variable">ERR</span> <span class="operator">=</span> <span class="number">20040</span>;</span><br></pre></td></tr></table></figure>

<p>然后BookController里return的结果就变了，全都返回Result</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> Book book)</span>&#123;</span><br><span class="line">	<span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> bookservice.save(book);</span><br><span class="line">	<span class="keyword">return</span> new.Result(flag ? Code.SAVE_OK:Code.SAVE_ERR,flag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">	<span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> bookService.getById(id);</span><br><span class="line">	<span class="type">Integer</span> <span class="variable">code</span> <span class="operator">=</span> book != <span class="literal">null</span> ? Code.GET_OK : Code.GET_ERR;<span class="comment">//如果book不为空就返回ok，否则err</span></span><br><span class="line">	<span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> book != <span class="literal">null</span> ? <span class="string">&quot;&quot;</span>:<span class="string">&quot;数据查询失败，请重试!&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(code,book,msg);</span><br></pre></td></tr></table></figure>

<h3 id="异常处理器"><a href="#异常处理器" class="headerlink" title="异常处理器"></a>异常处理器</h3><ul>
<li>出现异常现象的常见位置与常见诱因如下<ul>
<li>框架内部抛出的异常:因使用不合规导致</li>
<li>数据层抛出的异常:因外部服务器故障导致(例如:服务器访问超时)</li>
<li>业务层抛出的异常:因业务逻辑书写错误导致(例如:遍历业务书写操作，导致索引异常等)</li>
<li>表现层抛出的异常:因数据收集、校验等规则导致(例如:不匹配的数据类型间导致异常)</li>
<li>工具类抛出的异常:因工具类书写不严谨不够健壮导致(例如:必要释放的连接长期未释放等)</li>
</ul>
</li>
</ul>
<p>思考：</p>
<ol>
<li><p>各个层级均出现异常，异常处理代码书写在哪一层</p>
<p>-所有的异常均往上抛出到表现层进行处理</p>
</li>
<li><p>表现层处理异常，每个方法中单独书写，代码书写量巨大且意义不强，如何解决</p>
<p>-AOP思想，但不需要自己写，mvc提供了快捷的处理方案</p>
</li>
</ol>
<ul>
<li>异常处理器，要按规范来写<ul>
<li>集中的、统一的处理项目中出现的异常</li>
</ul>
</li>
</ul>
<p>首先在表现层新建一个ProjectExceptionAdvice类，然后加上注解用来声明这个类是做异常处理的，注意要在mvc配置类里加上扫描包路径</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span><span class="comment">//声明这个类是做异常处理的</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProjectExceptionAdvice</span> &#123;</span><br><span class="line">	<span class="meta">@ExceptionHandler(Exception.class)</span><span class="comment">//拦截什么异常</span></span><br><span class="line">	<span class="keyword">public</span> Result <span class="title function_">doException</span><span class="params">(Exception ex)</span>&#123;<span class="comment">//通过Exception形参接收异常</span></span><br><span class="line">        <span class="comment">//这里面想怎么处理异常都行</span></span><br><span class="line">		System.out.println(<span class="string">&quot;嘿嘿，异常你哪里跑!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">666</span>, <span class="literal">null</span>, <span class="string">&quot;嘿嘿，异常你哪里跑!&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>名称:@RestControllerAdvice</p>
</li>
<li><p>类型:类注解</p>
</li>
<li><p>位置:Rest风格开发的控制器增强类定义上方</p>
</li>
<li><p>作用:为Rest风格开发的控制器类做增强</p>
</li>
<li><p>说明：</p>
<ul>
<li>此注解自带@ResponseBody注解与@component注解，具备对应的功能</li>
</ul>
</li>
<li><p>名称:@ExceptionHandler</p>
</li>
<li><p>类型:方法注解</p>
</li>
<li><p>位置:专用于异常处理的控制器方法上方</p>
</li>
<li><p>作用:设置指定异常的处理方案，功能等同于控制器方法，出现异常后终止原始控制器执行，并转入当前方法执行</p>
</li>
<li><p>说明</p>
<ul>
<li>此类方法可以根据处理的异常不同，制作多个方法分别处理对应的异常</li>
</ul>
</li>
</ul>
<h3 id="项目异常处理方案"><a href="#项目异常处理方案" class="headerlink" title="项目异常处理方案"></a>项目异常处理方案</h3><p>项目异常分类</p>
<ul>
<li>业务异常(BusinessException)<ul>
<li>不规范的用户行为操作产生的异常，比如访问路径被更改</li>
<li>规范的用户行为产生的异常，比如年龄输入嘿嘿</li>
</ul>
</li>
<li>系统异常(SystemException)<ul>
<li>项目运行过程中可预计且无法避免的异常比如停电</li>
</ul>
</li>
<li>其他异常(Exception)<ul>
<li>编程人员未预期到的异常，比如系统找不到指定的文件</li>
</ul>
</li>
</ul>
<p>项目异常处理方案</p>
<ul>
<li><p>业务异常(BusinessException)</p>
<ul>
<li>发送对应消息传递给用户，提醒规范操作</li>
</ul>
</li>
<li><p>系统异常(SystemException)</p>
<ul>
<li>发送固定消息传递给用户，安抚用户</li>
<li>发送特定消息给运维人员，提醒维护</li>
<li>记录日志</li>
</ul>
</li>
<li><p>其他异常(Exception)</p>
<ul>
<li>发送固定消息传递给用户，安抚用户</li>
<li>发送特定消息给编程人员，提醒维护(纳入预期范围内)</li>
<li>记录日志</li>
</ul>
</li>
</ul>
<p>创建一个exception包，然后创建一个系统异常类，然后加一个code用以区分错误，然后实现构造方法，可以用一个写一个也可以全写上，这里是只用了两个，然后再加上code的getset方法就行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SystemException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer code;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">SystemException</span><span class="params">(Integer code,string message)</span>&#123;</span><br><span class="line">		<span class="built_in">super</span>(message);</span><br><span class="line">		<span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">SystemException</span><span class="params">(Integer code, String message, Throwable cause)</span>&#123;</span><br><span class="line">		<span class="built_in">super</span>(message,cause);</span><br><span class="line">		<span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>然后在可能出现异常的地方去进行一下处理，土办法是try catch，再自己new一个异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Book <span class="title function_">getById</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">    <span class="comment">//这也是模拟异常</span></span><br><span class="line">    <span class="keyword">if</span>(id == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(Code.BUSINESS_ERR,<span class="string">&quot;请不要xxxx&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//将可能出现的异常进行包装，转换成自定义异常</span></span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">	<span class="comment">//&#125;catch(ArithmeticException e)&#123;这样太麻烦了，直接换成Exception比较方便</span></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">SystemException</span>(Code.SYSTEM TIMEOUT_ERR.,<span class="string">&quot;服务器访问超时，请重试!&quot;</span>,e);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> bookDao.getById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后就是异常处理器，code和消息都可以从ex里获得，其他异常就按照上面的异常处理器里写的就行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProjectExceptionAdvice</span> &#123;</span><br><span class="line">    <span class="comment">//系统异常</span></span><br><span class="line">	<span class="meta">@ExceptionHandler(SystemException.class)</span><span class="comment">//拦截上面的异常</span></span><br><span class="line">	<span class="keyword">public</span> Result <span class="title function_">doSystemException</span><span class="params">(SystemException ex)</span>&#123;</span><br><span class="line">		<span class="comment">//记录日志</span></span><br><span class="line">		<span class="comment">//发送消息给运维</span></span><br><span class="line">		<span class="comment">//发送邮件给开发人员，ex对象发送给开发人员</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(ex.getCode(),data:<span class="literal">null</span>,ex.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//业务异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(BusinessException.class)</span></span><br><span class="line">	<span class="keyword">public</span> Result <span class="title function_">doBusinessException</span><span class="params">(BusinessException ex)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(ex.getCode(),data:<span class="literal">null</span>,ex.getMessage());</span><br></pre></td></tr></table></figure>

<h3 id="前后端协议联调"><a href="#前后端协议联调" class="headerlink" title="前后端协议联调"></a>前后端协议联调</h3><h4 id="添加功能"><a href="#添加功能" class="headerlink" title="添加功能"></a>添加功能</h4><p>复制前端文件过来，然后现在没有配置的话页面的请求一定会被mvc拦截，所以要建个配置类给他放行，将任意请求都指向到哪个location</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcSupport</span> <span class="keyword">extends</span> <span class="title class_">WebMvcconfigurationsupport</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span>&#123;</span><br><span class="line">		registry.addResourceHandler(<span class="string">&quot;/pages/**&quot;</span>).addResourceLocations(<span class="string">&quot;/pages/&quot;</span>);</span><br><span class="line">		registry.addResourceHandler(<span class="string">&quot;/css/**&quot;</span>).addResourceLocations(<span class="string">&quot;/css/&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		registry.addResourceHandler(<span class="string">&quot;/js/**&quot;</span>).addResourceLocations(<span class="string">&quot;/js/&quot;</span>);</span><br><span class="line">		registry.addResourceHandler(<span class="string">&quot;/plugins/**&quot;</span>).addResourceLocations(<span class="string">&quot;/plugins/&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>然后要在mvc中添加下面代码确保能扫描到</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Componentscan(&#123;&quot;com.itheima.controller&quot;,&quot;com.itheima.config&quot;&#125;)</span></span><br></pre></td></tr></table></figure>

<p>前端代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">	<span class="comment">//列表</span></span><br><span class="line">	<span class="title function_">getA11</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//发送ajax请求</span></span><br><span class="line">	axios.<span class="title function_">get</span>(<span class="string">&quot;/books&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">dataList</span> =res.<span class="property">data</span>.<span class="property">data</span>;</span><br><span class="line">	&#125;);</span><br><span class="line">        </span><br><span class="line">   <span class="comment">//添加</span></span><br><span class="line">	<span class="title function_">handleAdd</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="comment">//发送ajax请求</span></span><br><span class="line">	axios.<span class="title function_">post</span>(<span class="string">&quot;/books&quot;</span>,<span class="variable language_">this</span>.<span class="property">formData</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">		<span class="comment">//如果操作成功，关闭弹层，显示数据</span></span><br><span class="line">		<span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">20011</span>)&#123;<span class="comment">//添加成功</span></span><br><span class="line">			<span class="variable language_">this</span>.<span class="property">dialogFormVisible</span> = <span class="literal">false</span>,</span><br><span class="line">			<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&quot;添加成功&quot;</span>);<span class="comment">//这里的返回信息按理应该从后台拿，但是我们后天没写所以先在这里添加</span></span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">20010</span>)&#123;<span class="comment">//添加失败</span></span><br><span class="line">			<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;<span class="comment">//其他情况</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getAll</span>();</span><br></pre></td></tr></table></figure>

<p>然后看代码，要让代码失败就要让code为20010，去bookController看到post的返回代码里如果想返回失败就得让flag值为false，看到BookServiceImpl的代码为以下，我们要让save这个功能必须把结果反馈给我们，所以要改dao</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">save</span><span class="params">(Book book)</span>&#123;</span><br><span class="line">	<span class="comment">//bookDao.save(book);</span></span><br><span class="line">	<span class="comment">//return true;这里返回true是之前写死的</span></span><br><span class="line">    <span class="keyword">return</span> bookDao.save(book) &gt; <span class="number">0</span>;<span class="comment">//也就是大于0代表成功</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>更改返回值为int，这个int就是行计数，用来判断到底是成功或失败</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span>&#123;</span><br><span class="line">    <span class="meta">@Insert(&quot;xxx&quot;)</span></span><br><span class="line">    <span class="comment">//pubilc void save(Book book);</span></span><br><span class="line">    pubilc <span class="type">int</span> <span class="title function_">save</span><span class="params">(Book book)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里就把成功返回写好了，但怎么构建失败，在老师的数据库设计里如果输入的东西超过20个然后提交就会报错，然后提交的时候应该弹个框提示错误的但没有反应，在前端post那里添加代码console.log(res.data);查看打印数据，发现走的是sql异常，被异常拦截器拦截了，code是5999，就直接让它这个异常输出到前端就行。然后this.getAll();这句不管成功还是失败都要输出，一般用finally来写</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//添加</span></span><br><span class="line"><span class="title function_">handleAdd</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//发送ajax请求</span></span><br><span class="line">axios.<span class="title function_">post</span>(<span class="string">&quot;/books&quot;</span>,<span class="variable language_">this</span>.<span class="property">formData</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>);</span><br><span class="line">	<span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">20011</span>)&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">dialogFormVisible</span> = <span class="literal">false</span>,</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&quot;添加成功&quot;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">20010</span>)&#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="variable language_">this</span>.<span class="property">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(res.<span class="property">data</span>.<span class="property">msg</span>);<span class="comment">//直接让它这个异常输出到前端就行</span></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//this.getAll();</span></span><br><span class="line">   &#125;).<span class="title function_">finally</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">       <span class="variable language_">this</span>.<span class="title function_">getAll</span>();</span><br><span class="line">   &#125;);</span><br></pre></td></tr></table></figure>

<p>然后还有个问题是弹窗输入完信息后再次打开信息没有被清空，要让每次打开弹窗都是空的就加入以下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//弹出添加窗口</span></span><br><span class="line">handlecreate()&#123;</span><br><span class="line">	<span class="built_in">this</span>.dialogFormVisible =<span class="literal">true</span>;</span><br><span class="line">	<span class="built_in">this</span>.resetForm();</span><br><span class="line"><span class="comment">//重置表单</span></span><br><span class="line">resetForm()&#123;</span><br><span class="line">	<span class="built_in">this</span>.formData =&#123;&#125;;</span><br><span class="line">&#125;。</span><br></pre></td></tr></table></figure>

<h4 id="修改功能"><a href="#修改功能" class="headerlink" title="修改功能"></a>修改功能</h4><p>修改功能弹出的框里应该是有数据的，所以要先查询数据再展示，打印row看看里面的数据，选择id为查询条件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//弹出编辑窗口</span></span><br><span class="line"><span class="title function_">handleUpdate</span>(<span class="params">row</span>)&#123;</span><br><span class="line">	<span class="comment">//console.log(row);//row.id 查询条件</span></span><br><span class="line">	<span class="comment">//查询数据，根据id查询</span></span><br><span class="line">	axios.<span class="title function_">get</span>(<span class="string">&quot;/books/&quot;</span>+row.<span class="property">id</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">20041</span>)&#123;</span><br><span class="line">            <span class="comment">//console.log(res.data.data);//查看报错问题</span></span><br><span class="line">        <span class="comment">//展示弹层加载数据</span></span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">formData</span> = res.<span class="property">data</span>.<span class="property">data</span>;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">dialogFormVisible4Edit</span> = <span class="literal">true</span>;<span class="comment">//显示这个组件</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(res.<span class="property">data</span>.<span class="property">msg</span>);</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>

<p>显示组件的时候发现报错，打印数据看看，发现输出了个null，结果是之前的Serviceimpl里有模拟的异常导致的，注释掉就行了</p>
<h4 id="编辑功能"><a href="#编辑功能" class="headerlink" title="编辑功能"></a>编辑功能</h4><p>和添加功能一模一样，把里面的代码匹配一下，然后axios.post改为put</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//编辑</span></span><br><span class="line"><span class="title function_">handleEdit</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//发送ajax请求</span></span><br><span class="line">	axios.<span class="title function_">put</span>(<span class="string">&quot;/books&quot;</span>,<span class="variable language_">this</span>.<span class="property">formData</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">		<span class="comment">//如果操作成功，关闭弹层，显示数据</span></span><br><span class="line">		<span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">20031</span>)&#123;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="property">dialogFormVisible4Edit</span> =<span class="literal">false</span>;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">20030</span>)&#123;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(res.<span class="property">data</span>.<span class="property">msg</span>);</span><br><span class="line">		&#125;).<span class="title function_">finally</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="title function_">getA11</span>();</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;，</span><br></pre></td></tr></table></figure>

<h4 id="删除功能"><a href="#删除功能" class="headerlink" title="删除功能"></a>删除功能</h4><p>删除要先提示是否删除，then是确定后干什么，catch是取消后干什么。然后根据id删除，删除完在finally那里记得刷新页面</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">handleDelete</span>(<span class="params">row</span>)&#123;</span><br><span class="line">    <span class="comment">//1.弹出提示框，第一个参数是内容，第二个是标题，第三个是关于框的一些设定</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$confirm</span>*(<span class="string">&quot;此操作永久删除当前数据，是否继续？&quot;</span>.<span class="string">&quot;提示&quot;</span>,&#123;</span><br><span class="line">    	<span class="attr">type</span>:<span class="string">&#x27;info&#x27;</span><span class="comment">//会有个提示的图标</span></span><br><span class="line">	&#125;).<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//2.做删除业务</span></span><br><span class="line">        axios.<span class="title function_">delete</span>(<span class="string">&quot;/books/&quot;</span>+row.<span class="property">id</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">20021</span>)&#123;</span><br><span class="line">				<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    	&#125;).<span class="title function_">catch</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//3.取消删除</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">info</span>(<span class="string">&quot;取消删除操作&quot;</span>);</span><br><span class="line">  	 &#125;).<span class="title function_">finally</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="title function_">getA11</span>();</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><h3 id="拦截器概念"><a href="#拦截器概念" class="headerlink" title="拦截器概念"></a>拦截器概念</h3><p>浏览器发送请求会发送到tomcat服务器，拦截这个请求后会划分成静态和动态资源，静态的一般直接返回，动态的就是经过过滤器，过完过滤器后就会交给处理器工作，也就是mvc，然后先看访问的是什么请求，这个地方就是中央控制器，中央控制器根据你的访问将它分发到具体的控制器方法中，让它执行操作，操作完会返回一个数据，比如json。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260105033140661.png" alt="image-20260105033140661"></p>
<p>然后我们想要在每个Controller访问之前做一件事，比如说权限控制，有的人觉得在controller后也需要一些事，所以就这样产生了拦截器</p>
<ul>
<li>拦截器(Interceptor)是一种动态拦截方法调用的机制，在SpringMvc中动态拦截控制器方法的执行</li>
<li>作用<ul>
<li>在指定的方法调用前后执行预先设定后的的代码</li>
<li>阻止原始方法的执行</li>
</ul>
</li>
</ul>
<p>拦截器与过滤器区别：</p>
<ul>
<li>归属不同:Filter属于Servlet技术，Interceptor属于SpringMVc技术</li>
<li>拦截内容不同:Filter对所有访问进行增强，Interceptor仅针对SpringMvVc的访问进行增强</li>
</ul>
<p>弹幕：springmvc核心就是一个servlet做请求分发，filter是在进入servlet之前，interceptor是在进入servlet之后</p>
<h3 id="入门案例-1"><a href="#入门案例-1" class="headerlink" title="入门案例"></a>入门案例</h3><p>准备的类和之前的差不多，过滤器放在表现层里，在controller新建interceptor包，这个单词要记住，然后新建ProjectInterceptor。继承的这个方法后发现不需要实现方法，这是因为接口里面都有默认方法，然后把这三个方法都覆盖掉</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span><span class="comment">//受mvc管理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProjectInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">	<span class="meta">@override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpservletRequest request, HttpservletResponse response, object handler)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;preHandle...&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//如果改成false就会只执行到preHandle...然后中止往后的所有操作</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	@0verride</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpservletRequest reguest, HttpservletResponse response, obiect handler, ModelAndview modelAndView)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;postHandle...&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line">                           </span><br><span class="line">	@0verride</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttoservletReguest reguest, HttoservletResponse response, obiect handler, Exception ex)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;aftercompletion...&quot;</span>);</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>

<p>记得让mvc扫这个包</p>
<p>然后在config新建一个SpringMvcSupport，这个是过滤访问静态资源的，之前有写过。拦截器和过滤的写法区别差不多，只不过注册的东西不一样。下面括号里的拦截器可以通过自动注入来加入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcSupport</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationsupport</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ProjectInterceptor projectIntereptor;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry 	registry)</span>&#123;</span><br><span class="line">		registry.addResourceHandler( <span class="string">&quot;/pages/**&quot;</span>).addResourceLocations(<span class="string">&quot;/pages/&quot;</span>);</span><br><span class="line">&#125;<span class="comment">//访问page路径时指定访问到什么目录下的文件</span></span><br><span class="line"></span><br><span class="line">	<span class="meta">@override</span></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span>&#123;</span><br><span class="line">		registry.addInterceptor(projectIntereptor).addPathPatterns(<span class="string">&quot;/books&quot;</span>,<span class="string">&quot;/books/*&quot;</span>);<span class="comment">//添加指定拦截器，添加被拦截路径，第二个是以books开头的全拦截，想添加其他的可以继续添加</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>记得也要让mvc加载这个包</p>
<p>然后前端发送请求去调试，返回了以下信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">preHandle...这是在什么什么之前</span><br><span class="line">book save...Book&#123;书名=&#x27;springmvc实战&#x27;，价格=66.8&#125;</span><br><span class="line">postHandle..这是在什么什么之后</span><br><span class="line">afterCompletion...在完成之后</span><br></pre></td></tr></table></figure>

<p>不过SpringMvcSupport可以简化开发，在mvcConfig里可以继承这个方法，里面可以实现的方法就有之前SpringMvcSupport的两个addResourceHandlers和addInterceptors，开头的protected换成了public</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.itheima.controller&quot;&#125;)</span></span><br><span class="line"><span class="meta">@EnablewebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">springMvcconfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> ProjectInterceptor projectInterceptor;</span><br><span class="line">	<span class="meta">@override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span>&#123;</span><br><span class="line">		registry.addInterceptor(projectInterceptor).addPathPatterns(<span class="string">&quot;/books&quot;</span>,<span class="string">&quot;/books/*&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>但是这种简化开发的侵入式较强</p>
<h3 id="拦截参数"><a href="#拦截参数" class="headerlink" title="拦截参数"></a>拦截参数</h3><p>上面的参数都是用来干什么的呢，就是现在的程序执行以后可以通过这些参数取数据。对于HandlerMethod这个类里面封装了现在执行的方法，用的是反射，然后通过强转然后调用getMethod来获取方法之类的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span><span class="comment">//受mvc管理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProjectInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">	<span class="meta">@override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpservletRequest request, HttpservletResponse response, object handler)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">contentType</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;Content-Type&quot;</span>);<span class="comment">//获取数据。会输出application/json</span></span><br><span class="line">        <span class="comment">//System.out.println(handler.getClass());输出了class org.springframework.web.method.HandlerMethod，</span></span><br><span class="line">        <span class="type">HandlerMethod</span> <span class="variable">hm</span> <span class="operator">=</span> (HandlerMethod)handler;</span><br><span class="line">        hm.getMethod().~~~调用想获取的反射</span><br><span class="line">		System.out.println(<span class="string">&quot;preHandle...&quot;</span>+ contentType);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>modelAndView封装了mvc进行页面跳转的相关数据。下面那个ex可以拿到原始程序执行过程中的异常，但我们有异常统一处理机制所以也没有这个需求了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@0verride</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpservletRequest reguest, HttpservletResponse response, obiect handler, ModelAndview modelAndView)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;postHandle...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">                          </span><br><span class="line">@0verride</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttoservletReguest reguest, HttoservletResponse response, obiect handler, Exception ex)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;aftercompletion...&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>preHandle</p>
<ul>
<li>参数<ul>
<li>request:请求对象</li>
<li>response:响应对象</li>
<li>handler:被调用的处理器对象，本质上是一个方法对象，对反射技术中的Method对象进行了再包装</li>
</ul>
</li>
<li>返回值<ul>
<li>返回值为false，被拦截的处理器将不执行</li>
</ul>
</li>
</ul>
<p>postHandle</p>
<ul>
<li>modelAndview:如果处理器执行完成具有返回结果，可以读取到对应数据与页面信息，并进行调整</li>
</ul>
<p>afterCompletion</p>
<ul>
<li>ex:如果处理器执行过程中出现异常对象，可以针对异常情况进行单独处理</li>
</ul>
<h3 id="多个拦截器执行顺序"><a href="#多个拦截器执行顺序" class="headerlink" title="多个拦截器执行顺序"></a>多个拦截器执行顺序</h3><ul>
<li>当配置多个拦截器时，形成拦截器链</li>
<li>拦截器链的运行顺序参照拦截器添加顺序为准</li>
<li>当拦截器中出现对原始处理器的拦截，后面的拦截器均终止运行</li>
<li>当拦截器运行中断，仅运行配置在前面的拦截器的afterCompletion操作</li>
</ul>
<p> 全成功就是运行到post1后，再把所有的after执行完，如果3是false，就会中止拦截器运行，直接跳到after2和1运行完，以此类推，如果1就是false，那么后面的都不运行</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260106160327882.png" alt="image-20260106160327882"></p>
<p>拦截器链的运行顺序<br>preHandle:与配置顺序相同，必定运行<br>postHandle:与配置顺序相反，可能不运行<br>aftercompletion:与配置顺序相反，可能不运行</p>
<h1 id="Maven进阶"><a href="#Maven进阶" class="headerlink" title="Maven进阶"></a>Maven进阶</h1><h2 id="分模块开发与设计"><a href="#分模块开发与设计" class="headerlink" title="分模块开发与设计"></a>分模块开发与设计</h2><p>白学警告</p>
<p>将原始模块按照功能拆分成若干个子模块，方便模块间的相互调用，接口共享</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260106161601387.png" alt="image-20260106161601387"></p>
<p>右击新建个maven模块，取名叫maven_03_pojo，在这个里面有pom.xml，然后再java里建个con.itheima.domain，把maven_02_ssm里的domain里的Book剪切到03的里面，这里就要思考如果我们要在02里调用03的book应该怎么弄</p>
<p>可以打开02的pom.xml添加以下这行，这行是03的pom.xml里复制过来的，然后在右侧的maven管理里也能看到多了个这个的依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--依赖domain运行--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven 03 pojo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>maven想要真正运行最终要执行的是生命周期里的操作，点击compile，发现提示了error:Could not resolve dependencies for project com.itheima:maven 02 ssm:war:1.8-SNAPsHoT: Could not find artifact com.itheima:maven 03_pojo:jar:1.0-SNAPSHOT -&gt;[Help 1]，引用03的时候找不到</p>
<p>我们去本地仓库找，maven-repository-com-itheima这个路径找不到对应的文件夹，但是其他的仓库是能找到的，也就是本地仓库没有这个资源坐标，要保证可移植性肯定是需要仓库也有的，所以需要打包进去，点击maven指令里的install，将当前的模块安装到本地仓库中，安装的时候注意是选择安装03</p>
<h2 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h2><p>依赖指当前项目运行所需的jar，一个项目可以设置多个依赖</p>
<p>打开右侧的maven管理，前面有箭头的代表当前的依赖又依赖了别的东西，比如02里面有03和04，而04又依赖了03，那么把02里面的03注释掉，依然可以正常使用，这说明依赖具有传递性</p>
<ul>
<li>直接依赖:在当前项目中通过依赖配置建立的依赖关系</li>
<li>间接依赖:被资源的资源如果依赖其他资源，当前项目间接依赖其他资源</li>
</ul>
<p><strong>依赖传递冲突问题</strong></p>
<ul>
<li>路径优先:当依赖中出现相同的资源时，层级越深，优先级越低，层级越浅，优先级越高</li>
<li>声明优先:当资源在相同层级被依赖时，配置顺序靠前的覆盖配置顺序靠后的</li>
<li>特殊优先:当同级配置了相同资源的不同版本，后配置的覆盖先配置的，以最后配置的为准</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260107190516992.png" alt="image-20260107190516992"></p>
<p>这个按钮显示了依赖的关系和深度</p>
<h2 id="可选依赖和排除依赖"><a href="#可选依赖和排除依赖" class="headerlink" title="可选依赖和排除依赖"></a>可选依赖和排除依赖</h2><p>可选依赖指对外隐藏当前所依赖的资源–不透明</p>
<p>如果不想让别人知道我的依赖里用过什么东西，想给隐藏起来，就可以加一个标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven 03 pojo&lt;/artifactId)</span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--可选依赖是隐藏当前工程所依赖的资源，隐藏后对应资源将不具有依赖传递性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span>加这个</span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>排除依赖是指在当前引用的坐标中，将它的依赖从你的依赖关系中去除，是主动断开依赖的资源</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven 04 dao<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--排除依赖是隐藏当前资源对应的依赖关系--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="继承与聚合"><a href="#继承与聚合" class="headerlink" title="继承与聚合"></a>继承与聚合</h2><p><strong>聚合</strong>：</p>
<ul>
<li>聚合:将多个模块组织成一个整体，同时进行项目构建的过程称为聚合</li>
<li>聚合工程:通常是一个不具有业务功能的“空”工程(有且仅有一个pom文件)</li>
<li>作用:使用聚合工程可以将多个工程编组，通过对聚合工程进行构建，实现对所包含的模块进行同步构建<ul>
<li>当工程中某个模块发生更新(变更)时，必须保障工程中与已更新模块关联的模块同步更新，此时可以使用聚合工程来解决批量模块同步构建的问题</li>
</ul>
</li>
</ul>
<p>新建一个模块，里面只有一个pom.xml，之前的打包方式都是jar之类的，这里为pom的打包方式</p>
<p>管理的话用module标签，路径是以pom.xml开始，往上找一级，标签里的顺序不会影响效果，因为他们是按照依赖关系构建，比如a依赖b，就会先构建b，先把没有依赖的构建</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven 01_parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--设置管理的模块名称--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">module</span>&gt;</span>../maven_02_ssm<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">module</span>&gt;</span>../maven_03_pojo<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">module</span>&gt;</span>../maven_04_dao<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>继承：</strong></p>
<ul>
<li>概念:继承描述的是两个工程间的关系，与java中的继承相似，子工程可以继承父工程中的配置信息，常见于依赖关系的继承</li>
<li>作用:<ul>
<li>简化配置</li>
<li>减少版本冲突</li>
</ul>
</li>
</ul>
<p>这里我们让1为父工程，其他为子工程，继承关系要在子类中描述，现在在2的pom.xml里加入以下代码，relativePath是用来快速定位父工程路径的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置当前工程继承自parent工程--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven 0l parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">relativePath</span>&gt;</span>../maven 01 parent/pom.xml<span class="tag">&lt;/<span class="name">relativePath</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后把子工程中的坐标都放到父工程里统一管理</p>
<p>如果2和3都要用到junit，而4不用，那可以在1里定义依赖管理，这里的不会让子工程都会继承，而是提供可选依赖资源</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--定义依赖管理--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>子工程就还是写dependency，但是不要加版本，因为它用的是父工程里的版本。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test&lt;/scope)</span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>子工程中使用父工程中的可选依赖时，仅需要提供群组id和项目id，无需提供版本，版本由父工程统一提供，避免版本冲突。子工程中还可以定义父工程中没有定义的依赖关系</p>
<p><strong>聚合与继承的区别</strong></p>
<ul>
<li>作用<ul>
<li>聚合用于快速构建项目</li>
<li>继承用于快速配置</li>
</ul>
</li>
<li>相同点:<ul>
<li>聚合与继承的pom.xm1文件打包方式均为pom，可以将两种关系制作到同一个pom文件中</li>
<li>聚合与继承均属于设计型模块，并无实际的模块内容</li>
</ul>
</li>
<li>不同点:<ul>
<li>聚合是在当前模块中配置关系，聚合可以感知到参与聚合的块有哪些</li>
<li>继承是在子模块中配置关系，父模块无法感知哪些子模块继承了自己</li>
</ul>
</li>
</ul>
<h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><p>前面的管理版本号还是有点麻烦，在java中学过用变量来定义版本号，maven的属性就是干这个的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencys</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencys</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--定义属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>既然有了属性，能不能把jdbc.properties里的数据也做统一管理呢，也可以，同样是在下面标签里加上原本的数据库地址，但是只能在这个pom文件里使用，不能在配置文件里使用，如果想扩大范围可以使用build标签配置资源文件，加上路径和开启过滤规则，不过这个方法<strong>并不常用</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">jdbc.url</span>&gt;</span>jdbc:mysql://127.0.0.1:3306/ssm db&lt;/jdbc,url&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">directory</span>&gt;</span>../maven 02 ssm/src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如何查看效果，只需要把02这个工程打包成war包，看看里面的配置有没有加载上值就行，找到本地仓库maven_repository_com_itheima把里面的东西清空，然后在maven点install，如果打包提示必须要web.xml，就需要新建一个，因为war包最起码要有一个web.xml。然后查看war文件里webinf里classes找到配置文件，看有没有生效就行</p>
<p>但是这样不规范，因为这里只配置了02，要是0304都配就要写好多，但这里面只支持写一个directory，所以就要改变代码，${project.basedir}代表了当前项目所在的目录，而后面的020304会继承这个，就不会局限在哪一个工程了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里是刚才的web.xml根本性处理方案，是如果没有这个文件，你不要给我报错。而只有02这个工程有这个插件，所以要在这里的pom.xml写，这下面的plugin是一个插件，里面写maven打war包的那个插件，坐标从maven&gt;repository&gt;org&gt;apachemaven &gt;plugins这个路径里找，org.apache.maven.plugins这个就是。后面要写对应的配置，这个标签的意思是如果遇到了没有web.xml是否报错，写false</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">port</span>&gt;</span>80<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">path</span>&gt;</span>/<span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-war-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">failonMissingWebXml</span>&gt;</span>false<span class="tag">&lt;<span class="name">fail0nMissingWebXml</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面用到的${project.basedir}是maven内置的系统属性</p>
<ol start="3">
<li><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260113184231237.png" alt="image-20260113184231237"></li>
</ol>
<h2 id="版本管理"><a href="#版本管理" class="headerlink" title="版本管理"></a>版本管理</h2><ul>
<li>工程版本:<ul>
<li>SNAPSHOT(快照版本)<ul>
<li>项目开发过程中临时输出的版本，称为快照版本</li>
<li>快照版本会随着开发的进展不断更新</li>
</ul>
</li>
<li>RELEASE(发布版本)<ul>
<li>项目开发到进入阶段里程碑后，向团队外部发布较为稳定的版本，这种版本所对应的构件文件是稳定的，即便进行功能的后续开发，也不会改变当前发布版本内容，这种版本称为发布版本</li>
</ul>
</li>
</ul>
</li>
<li>发布版本<ul>
<li>alpha版</li>
<li>beta版</li>
<li>纯数字版</li>
</ul>
</li>
</ul>
<h2 id="多环境配置与应用"><a href="#多环境配置与应用" class="headerlink" title="多环境配置与应用"></a>多环境配置与应用</h2><p>maven提供配置多种环境的设定，帮助开发者使用过程中快速切换环境</p>
<p>在01父工程里配置多环境开发</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置多环境--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开发环境--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span>&gt;</span>env_depk/id&gt;</span><br><span class="line">		<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">jdbc.url</span>&gt;</span>jdbc:mysq1://127.0.0.1:3306/ssm_db<span class="tag">&lt;/<span class="name">jdbc.url</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--设定是否为默认启动环境--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--生产环境--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span>&gt;</span>env_pro/id&gt;</span><br><span class="line">		<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">jdbc.url</span>&gt;</span>jdbc:mysq1://127.2.2.1:3306/ssm_db<span class="tag">&lt;/<span class="name">jdbc.url</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--测试环境--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span>&gt;</span>env_depk/id&gt;</span><br><span class="line">		<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">jdbc.url</span>&gt;</span>jdbc:mysq1://127.0.0.1:3306/ssm_db<span class="tag">&lt;/<span class="name">jdbc.url</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面设置默认启动环境太麻烦了，也可以换种方式，点击这里，输入执行指令mvn install -P env_test，-p代表指定环境，运行就可以了</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260113190505918.png" alt="image-20260113190505918"></p>
<h3 id="跳过测试"><a href="#跳过测试" class="headerlink" title="跳过测试"></a>跳过测试</h3><p>点一下这个按钮，test就变成了灰色的</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260113191213505.png" alt="image-20260113191213505"></p>
<p>但是这个会全部跳过，能不能指定跳过哪些呢。在build里写，而测试是一个插件，所以要在插件标签里写配置，里面是跳过测试。然后比如某个测试用例不参与，其他的都参与，就要把</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--设置资源目录，并设置能够解析$&#125;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">directory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true&lt;/filtering)</span><br><span class="line"><span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">skipTests</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skipTests</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--排除掉不参与测试的内容--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exclude</span>&gt;</span>**/BookServiceTest.java<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>用指令就是mvn package -D skip</p>
<h2 id="私服"><a href="#私服" class="headerlink" title="私服"></a>私服</h2><ul>
<li>私服是一台独立的服务器，用于解决团队内部的资源共享与资源同步问题</li>
<li>Nexus<ul>
<li>Sonatype公司的一款maven私服产品</li>
<li>下载地址:<a target="_blank" rel="noopener" href="https://help.sonatype.com/repomanager3/download">https://help.sonatype.com/repomanager3/download</a></li>
</ul>
</li>
</ul>
<p>下载完去bin目录运行cmd，然后执行nexus.exe &#x2F;run nexus</p>
<p>访问地址是localhost:8081，用户名admin，密码在他提供的路径里找到admin.password里</p>
<ul>
<li>修改基础配置信息<ul>
<li>安装路径下etc目录中nexus-default.properties文件保存有nexus基础配置信息，例如默认访问端口</li>
</ul>
</li>
<li>修改服务器运行配置信息<ul>
<li>安装路径下bin目录中nexus.vmoptions文件保存有nexus服务器启动对应的配置信息，例如默认占用内存空间</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260114153514985.png" alt="image-20260114153514985"></p>
<p>现在idea打包到本地仓库，然后本地仓库上传到私服，但这样的话需要本地仓库配置访问权限，也就是访问私服的用户名和密码，还要告诉上传的位置，下载也是同理</p>
<p>找到maven的conf里的setting.xml，找到servers标签，复制一个server标签然后修改</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置访间字符的权限--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>私服中的服务器id名称<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在仓库里找到这个选项，点击创建仓库，然后选maven2(hosted)，然后写上名字itheima-snapshot，下面的version policy要选同样的snapshot，其他的不动直接创建</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260114154330189.png" alt="image-20260114154330189"></p>
<p>然后还缺一个配置，就是当前项目要发布到哪一个私服仓库中，在01pom文件里配置，一个是正式版，一个是快照版</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置当前工程保存在私服中的具体位置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>itheima-release<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/repository/itheima-release/<span class="tag">&lt;/<span class="name">ur1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>itheima-snapshot<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://localhost:8081/repository/itheima-snapshot/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后在maven选项中选择deploy，这个是上传到私服，本地的是用install，上传完后查看仓库，发现release里没有东西但snapshot有，这是因为在01pom文件里的版本号叫snapshot，要改成release</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven 01 parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>下面这个地方可以换取阿里的坐标用来下载</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260114155647714.png" alt="image-20260114155647714"></p>
<h1 id="SpringBoot"><a href="#SpringBoot" class="headerlink" title="SpringBoot"></a>SpringBoot</h1><p>SpringBoot是由Pivotal团队提供的全新框架，其设计目的是用来简化Spring应用的初始搭建以及开发过程</p>
<h2 id="入门案例-2"><a href="#入门案例-2" class="headerlink" title="入门案例"></a>入门案例</h2><p>创建时选择<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260114182813129.png" alt="image-20260114182813129">然后选择好jdk版本，按照下图设置，name随便写，描述随便写，包名只要前面的</p>
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260114190053045.png" alt="image-20260114190053045" style="zoom:50%;" />

<p>在这里右侧是版本号，左侧是添加到maven的坐标</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260114190206845.png" alt="image-20260114190206845"></p>
<p>然后在finish就行了，里面的内容大概是这样</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260114190545805.png" alt="image-20260114190545805"></p>
<p>然后新建一个控制类，协商这些东西就可以了，不需要tomcat服务器，boot里有</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/books&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bookcontroller</span>&#123;</span><br><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> string <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;id ==&gt;&quot;</span>+id);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;hello , spring boot!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>点开Application查看代码，意思就是运行这个东西，然后把Application传进来，再加个参数就行了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@springBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[] args)</span>&#123;</span><br><span class="line">SpringApplication.run(Application.class,args);</span><br></pre></td></tr></table></figure>

<p>让后点开pom，把里面的name标签和description删掉，往上有个parent标签，这个是boot的核心继承，下面那个是前面点web所产生的东西</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span><span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>基于idea开发SpringBoot程序需要确保联网且能够加载到程序框架结构</p>
<h2 id="Springboot项目快速启动"><a href="#Springboot项目快速启动" class="headerlink" title="Springboot项目快速启动"></a>Springboot项目快速启动</h2><p>如果前端调试程序需要链接后端，但不在同一台电脑上，后端可以使用maven的package进行打包，这个包在target里，把打好的jar包发给前端就行，运行方式是在这个文件目录启动cmd，然后输入java -jar 包名.jar就行了，而且需要的其他jar包也会一起打包好</p>
<p>jar支持命令行启动需要依赖maven插件支持，请确认打包时是否具有SpringBoot对应的maven插件</p>
<h2 id="Springboot概述"><a href="#Springboot概述" class="headerlink" title="Springboot概述"></a>Springboot概述</h2><p>SpringBoot是由Pivota1团队提供的全新框架，其设计目的是用来简化Spring应用的初始搭建以及开发过程</p>
<p>在上面的parent标签里，点击spring-boot-starter-parent进去可以看到这个又继承了spring-boot-dependencies，这里程序就已经准备好了要用的资源的版本管理，只需要写上需要的依赖不加版本就可以</p>
<p>下面这个是帮我们一次性写了若干依赖，意思是起步依赖，点进去都可以看到</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>starter<ul>
<li>SpringBoot中常见项目名称，定义了当前项目使用的所有项目坐标，以达到减少依赖配置的目的</li>
</ul>
</li>
<li>parent<ul>
<li>所有SpringBoot项目要继承的项目，定义了若干个坐标版本号(依赖管理，而非依赖)，以达到减少依赖冲突的目的</li>
<li>spring-boot-starter-parent(2.5.0)与 spring-boot-starter-parent(2.4.6)共计57处坐标版本不同</li>
</ul>
</li>
<li>实际开发<ul>
<li>使用任意坐标时，仅书写GAV中的G和A，V由SpringBoot提供</li>
<li>如发生坐标错误，再指定version(要小心版本冲突)</li>
</ul>
</li>
</ul>
<p>上面这些都是辅助功能</p>
<h2 id="springboot启动方式"><a href="#springboot启动方式" class="headerlink" title="springboot启动方式"></a>springboot启动方式</h2><ul>
<li><p>启动方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Springboot010uickstartApplicationf</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[] args)</span>&#123;</span><br><span class="line">SpringApplication.run(Springboot01QuickstartApplication.class, args);</span><br></pre></td></tr></table></figure>
</li>
<li><p>SpringBoot在创建项目时，采用jar的打包方式</p>
</li>
<li><p>SpringBoot的引导类是项目的入口，运行main方法就可以启动项目</p>
</li>
</ul>
<p>这里我们想换成jetty服务器，不用tomcat，在pom里的org.springframework.boot里面是有tomcat的，并且是源码不能随意更改不能用可选依赖，所以我们这里用到之前学过的排除依赖，然后再加上jetty的依赖就行</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Jetty比Tomcat更轻量级，可扩展性更强(相较于Tomcat)，谷歌应用引擎(GAE)已经全面切换为Jetty</p>
<h2 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h2><p><strong>修改服务器端口</strong></p>
<ul>
<li><p>SpringBoot提供了多种属性配置方式<br>在resources里有个application.properties，在里面添加</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">80</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在这个目录下新建一个application.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="string">port:81</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>新建一个application.yaml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="string">port:82</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>如果三个文件都有的情况下，properties为主启动文件，然后是yml最后是yaml</p>
<p>SpringBoot核心配置文件名为application<br>SpringBoot内置属性过多，且所有属性集中在一起修改，在使用时，通过提示键+关键字修改属性</p>
<h2 id="yaml"><a href="#yaml" class="headerlink" title="yaml"></a>yaml</h2><ul>
<li>YAML(YAML Ain’t Markup Language)，一种数据序列化格式</li>
<li>优点:<ul>
<li>容易阅读</li>
<li>容易与脚本语言交互</li>
<li>以数据为核心，重数据轻格式</li>
</ul>
</li>
<li>YAML文件扩展舎<ul>
<li>.ym1(主流)</li>
<li>.yam1</li>
</ul>
</li>
</ul>
<p><strong>yaml语法规则</strong></p>
<ul>
<li>大小写敏感</li>
<li>属性层级关系使用多行描述，每行结尾使用冒号结束</li>
<li>使用缩进表示层级关系，同层级左侧对齐，只允许使用空格(不允许使用Tab键)</li>
<li>属性值前面添加空格(属性名与属性值之间使用冒号+空格作为分隔)</li>
<li>表示注释</li>
<li>核心规则:数据前面要加空格与冒号隔开</li>
</ul>
<p><strong>yaml数组数据</strong></p>
<p>数组数据在数据书写位置的下方使用减号作为数据开始符号，每行书写一个数据，减号与数据间空格分隔</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">enterprise:</span></span><br><span class="line"> <span class="string">tel:4006184000</span></span><br><span class="line"> <span class="attr">subject:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Java</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">前端</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">大数据</span></span><br></pre></td></tr></table></figure>

<h3 id="yaml数据读取"><a href="#yaml数据读取" class="headerlink" title="yaml数据读取"></a>yaml数据读取</h3><p>可以通过下面的方式读取上面yml文件的数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/books&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bookcontroller</span> &#123;</span><br><span class="line"><span class="meta">@Value(&quot;$&#123;enterprise.tel&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Integer tel;</span><br><span class="line"></span><br><span class="line"><span class="comment">//数组</span></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;enterprise.subject[0]&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Integer subject;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>也可以使用加载环境信息全部获取</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(©v&quot;/books&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bookcontroller</span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Environment environment;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">    	System.out.println(environment.getProperty(<span class="string">&quot;lesson&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>第三种方式是比较常用的，先定义一个实体类，内容和yml里的东西一一对应，要想加载这里的信息，得先让Spring控制这里，添加@Component把他加入bean，第二步要告诉从配置中读取属性，@ConfigurationProperties，里面写上前缀</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;enterprise&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Enterprise</span>&#123;</span><br><span class="line"><span class="keyword">private</span> String tel;</span><br><span class="line"><span class="keyword">private</span> String[] subject;</span><br></pre></td></tr></table></figure>

<p>然后再放到上面的控制类里</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> Enterprise enterprise,</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">    System.out.println(enterprise);</span><br></pre></td></tr></table></figure>

<p><strong>自定义对象封装数据警告解决方案</strong></p>
<p>把这个加在依赖里就可以</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="多环境开发配置"><a href="#多环境开发配置" class="headerlink" title="多环境开发配置"></a>多环境开发配置</h2><p>分隔环境在yml里用三个横线分隔，区分什么是开发测试的话用</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置启用的环境</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">profiles:</span></span><br><span class="line"><span class="attr">active:</span> <span class="string">test</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#开发</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">profiles:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="string">port:80</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#生产</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">profiles:</span> <span class="string">pro</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">81</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">profiles:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">82</span></span><br></pre></td></tr></table></figure>

<p>现在推荐的写法：用哪个都行</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置启用的环境</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">profiles:</span></span><br><span class="line"><span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#开发</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">config:</span></span><br><span class="line"><span class="attr">activate:</span></span><br><span class="line"><span class="attr">on-profile:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="string">port:80</span></span><br></pre></td></tr></table></figure>

<p>properties的写法：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置启用的环境</span></span><br><span class="line"><span class="attr">spring.profiles.active</span>=<span class="string">dev</span></span><br></pre></td></tr></table></figure>

<p>dev在哪写呢？新建一个application-dev.properties，里面写上server.port&#x3D;80，这样会读取</p>
<h2 id="多环境命令行启动参数设置"><a href="#多环境命令行启动参数设置" class="headerlink" title="多环境命令行启动参数设置"></a>多环境命令行启动参数设置</h2><p>前端人员在启动打好的jar包时可以通过命令来更改环境，但是在打包前一定要先执行clean，有中文注释的时候需要打开idea设置，输入encoding，把所有的编码改成utf-8</p>
<p>启动时先在jar包所在的文件夹里启动cmd，然后输入java -jar springboot.jar –spring.profiles.active&#x3D;test，也可以临时修改参数，比如</p>
<p>java -jar springboot.jar –spring.profiles.active&#x3D;test –server.port&#x3D;88</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260116001823456.png" alt="image-20260116001823456"></p>
<h2 id="多环境开发兼容问题"><a href="#多环境开发兼容问题" class="headerlink" title="多环境开发兼容问题"></a>多环境开发兼容问题</h2><p>开发的时候jar最终要在服务器上运行，而maven是用来最终打包，所以要以maven的profile为主，boot为辅</p>
<p>这里准备了数据，在pom里有设置多环境开发，yml里设置的是，这时候运行打好的jar包，发现最终运行的端口是80，说明yml里的dev在生效，properties里想要生效的也没有告诉yml，怎么让yml知道呢，在pom里把每个环境都设上&lt;properties.active&gt;，把yml里active后面改成${profile.avtive}。</p>
<p>上面配置的pom属性只能在pom文件里用，不会干预配置文件，想要干预配置文件就要加个下面的插件，配置里的useDefaultDelimiters设置为true，然后再设置一下字符集</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">configuraton</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">useDefaultDelimiters</span>&gt;</span>true<span class="tag">&lt;/<span class="name">useDefaultDelimiters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuraton</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">useDefaultDelimiters</span>&gt;</span>true<span class="tag">&lt;/<span class="name">useDefaultDelimiters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--开发环境--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>dev<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span>dev<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--生产环境--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>pro<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span>pro<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--测试环境--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>test<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span>test<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置启用的环境</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">profiles:</span></span><br><span class="line"><span class="attr">active:</span> <span class="string">$&#123;profile.avtive&#125;</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#开发</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="string">profiles:dev</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="string">port:80</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#生产</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">profiles:</span> <span class="string">pro</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">81</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">profiles:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">82</span></span><br></pre></td></tr></table></figure>

<h2 id="配置文件分类"><a href="#配置文件分类" class="headerlink" title="配置文件分类"></a>配置文件分类</h2><p>SpringBoot中4级配置文件<br>1级:file :config&#x2F;application.yml【最高】<br>2级:file :application.yml<br>3级:classpath:config&#x2F;application.yml<br>4级:classpath:application.yml【最低】<br>作用:<br>1级与2级留做系统打包后设置通用属性<br>3级与4级用于系统开发阶段设置通用属性</p>
<h2 id="整合第三方技术"><a href="#整合第三方技术" class="headerlink" title="整合第三方技术"></a>整合第三方技术</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260116011651976.png" alt="image-20260116011651976"></p>
<p>上面两个类其实都是统一的名字，如果都一样的话是不是就不用写了，boot给做了整合。随便弄了个Service，然后到测试类去做测试，下面的方法是不重要的可以随意修改，@SpringBootTest里面整合了运行器，在这里没有写需要加载的配置文件，但是有没有加载？加载了，在Springboote7TestApplication这个类（运行的那个）就起到了加载配置类的作用，他会把他所在包及其子包全部扫描一遍</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">springboot07TestApplicationTests</span>&#123;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> BookService bookService;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="comment">//void contextLoads()&#123;//这个是创建时自带的，可以随意修改</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;<span class="comment">//改成了这样</span></span><br><span class="line">bookService.save();</span><br></pre></td></tr></table></figure>

<p>如果就是换地方了，可以通过指定参数把类名指定上就行了</p>
<p>@SpringBootTest(class &#x3D; Springboot07TestApplication.class)</p>
<h2 id="基于SpringBoot整合mybatis"><a href="#基于SpringBoot整合mybatis" class="headerlink" title="基于SpringBoot整合mybatis"></a>基于SpringBoot整合mybatis</h2><p>创建一个新模块，把mybatis framework依赖加上，还有mysql的</p>
<p>然后准备下面代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span>&#123;<span class="comment">//还有setget方法</span></span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"><span class="keyword">private</span> string name;</span><br><span class="line"><span class="keyword">private</span> string type;</span><br><span class="line"><span class="keyword">private</span> string description;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line"><span class="meta">@Select(&quot;select *from tbl_book where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Book <span class="title function_">getById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure>

<p>还有个Application.yml，serverTimezone&#x3D;UTC是设置时区，这个是boot2.4.2以前的会报错，后面的就不用加了</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">datasource:</span></span><br><span class="line"><span class="string">driver-class-name:com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="string">url:jdbc:mysql://localhost:3306/ssm_db?serverTimezone=UTC</span></span><br><span class="line"><span class="string">username:root</span></span><br><span class="line"><span class="attr">password:</span> <span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>然后到测试类，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">springboote8MybatisApplicationTests</span>&#123;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> BookDao bookDao;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testGetById</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">Book</span> <span class="variable">book</span> <span class="operator">=</span> bookDao.getById(<span class="number">1</span>);</span><br><span class="line">System.out.println(book);</span><br></pre></td></tr></table></figure>

<p>运行时提示错误的创建了一个bean，依赖的bookDao加载失败了，因为这样配BookDao这是一个接口，那我们的对象是什么？是通过自动代理得到的实现类，而Spring怎么知道这个类要做自动代理呢，之前是@MapperScanner然后里面是包名，这里只需要写@Mapper</p>
<p>如果需要其他的数据库源，就先加载对应的依赖，然后在上的yml最后面加上</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDatasource</span></span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260116015221587.png" alt="image-20260116015221587"></p>
<h2 id="案例：基于boot的ssm整合案例"><a href="#案例：基于boot的ssm整合案例" class="headerlink" title="案例：基于boot的ssm整合案例"></a>案例：基于boot的ssm整合案例</h2><p>之前的config包全部删掉，domain不需要变化，dao里需要加一个@Mapper，作用是让boot扫描到这里并且生成自动代理，Service包不需要动，controller也不需要，然后在resources包里把Application.properties后缀改成yml，然后把jdbc.properties里的东西放到yml里，测试类就是上面那些</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260116183738833.png" alt="image-20260116183738833"></p>
<h1 id="mybatis-plus"><a href="#mybatis-plus" class="headerlink" title="mybatis plus"></a>mybatis plus</h1><h2 id="MyBatisPlus简介"><a href="#MyBatisPlus简介" class="headerlink" title="MyBatisPlus简介"></a>MyBatisPlus简介</h2><p>MyBatisPlus(简称MP)是基于MyBatis框架基础上开发的增强型工具，旨在简化开发、提高效率</p>
<ul>
<li>SpringBoot整合MyBatis开发过程(复习)<ul>
<li>创建SpringBoot工程</li>
<li>勾选配置使用的技术（mybatis、mysql）</li>
<li>设置dataSource相关属性(JDBC参数)</li>
<li>定义数据层接口映射配置</li>
</ul>
</li>
</ul>
<p>新建一个模块选择mysql，如果没有mybatisplus就手动加，再加一个druid，然后在yml里配置数据库，新建一个UserDao的接口，继承BaseMapper就可以获得所有需要的查询方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">getById</span><span class="params">(Long id)</span>;</span><br><span class="line"><span class="comment">//以前是这么写，如果用plus就里面什么也不写，然后继承BaseMapper加一个泛型，写实体类名</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt;&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Mybatispluse1QuickstartApplicationTests</span>&#123;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testGetAll</span><span class="params">()</span>&#123;</span><br><span class="line">List&lt;User&gt;userList = userDao.selectList(<span class="literal">null</span>);</span><br><span class="line">System.out.println(userList);</span><br></pre></td></tr></table></figure>

<p>MyBatisPlus特性：</p>
<ul>
<li>无侵入:只做增强不做改变，不会对现有工程产生影响</li>
<li>强大的 CRUD 操作:内置通用 Mapper，少量配置即可实现单表CRUD 操作</li>
<li>支持 Lambda:编写查询条件无需担心字段写错</li>
<li>支持主键自动生成</li>
<li>内置分页插件</li>
</ul>
<h2 id="标准数据层开发"><a href="#标准数据层开发" class="headerlink" title="标准数据层开发"></a>标准数据层开发</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260117025540821.png" alt="image-20260117025540821"></p>
<p>新增，但是id是按照它的规则生成的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSave</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">user.setName(<span class="string">&quot;黑马程序员&quot;</span>);</span><br><span class="line">user.setPassword(<span class="string">&quot;itheima&quot;</span>),</span><br><span class="line">user.setAge(<span class="number">12</span>);</span><br><span class="line">user.setTel(<span class="string">&quot;4006184080&quot;</span>)</span><br><span class="line">userDao.insert(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>按id删除</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span>&#123;</span><br><span class="line">userDao.deleteById(<span class="number">1401856123725713409L</span>);</span><br></pre></td></tr></table></figure>

<p>改，这里以前要做个判断，哪些字段为空就不更改，不为空的才更改，现在他直接自动判断</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdate</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">user.setId(<span class="number">1L</span>);</span><br><span class="line">user.setName(<span class="string">&quot;Tom666&quot;</span>);</span><br><span class="line">userDao.updateById(user);</span><br></pre></td></tr></table></figure>

<p>查</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testGetById</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.selectById(<span class="number">2L</span>);</span><br><span class="line">System.out.println(user);</span><br></pre></td></tr></table></figure>

<p>然后pojo对象可以用lombok来快速生成setget方法，也可以用@Data，这个包含以下所有除了两个构造方法的所有方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Tostring</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="keyword">private</span> Long id;</span><br><span class="line"><span class="keyword">private</span> string name;</span><br><span class="line"><span class="keyword">private</span> string password;</span><br><span class="line"><span class="keyword">private</span> Integer age;</span><br><span class="line"><span class="keyword">private</span> string tel;</span><br></pre></td></tr></table></figure>

<h3 id="分页功能"><a href="#分页功能" class="headerlink" title="分页功能"></a>分页功能</h3><p>selectPage要的是什么，是一个Ipage对象，那就new一个，怎么设置页码，page后面的1代表第一页，2代表有多少条</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testGetByPage</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">IPage</span> <span class="variable">page</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Page</span>( <span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">userDao.selectPage(page,queryWrapper: <span class="literal">null</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;当前页码值:&quot;</span>+page.getcurrent());</span><br><span class="line">System.out.println(<span class="string">&quot;每页显示数:&quot;</span>+page.getsize());</span><br><span class="line">System.out.println(<span class="string">&quot;一共多少页:&quot;</span>+page.getPages());</span><br><span class="line">System.out.println(<span class="string">&quot;一共多少条数据:&quot;</span>+page.getTotal());</span><br><span class="line">System.out.println(<span class="string">&quot;数据:&quot;</span>+page.getRecords());</span><br></pre></td></tr></table></figure>

<p>但执行时发现他显示的是一共0页，一共0条数据，然后把数据全部查询出来，正常的查询语句应该是select *from user ????? limit 1,2.，就是要在后面加上limit进行分页，但这里不是aop，是mybatisplus的拦截器，用于配置分页功能</p>
<p>新建一个MyConfig</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Mpconfig</span> &#123;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mpInterceptor</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">//1.定义Mp拦截器</span></span><br><span class="line"><span class="type">MybatisPlusInterceptor</span> <span class="variable">mpInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line"><span class="comment">//2.添加具体的拦截器</span></span><br><span class="line">mpInterceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>());</span><br><span class="line"><span class="keyword">return</span> mpInterceptor;</span><br></pre></td></tr></table></figure>

<p>然后要被加载，一种是在Application类里写上@Import加载进去，另一种是直接加@Configuration</p>
<p>想看sql语句可以开启mypluls日志，要在yml配置以下，调程序用的一般不开启</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启mp的日志(输出到控制台)</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"><span class="attr">configuration:</span></span><br><span class="line"><span class="string">log-impl:org.apache,ibatis.logging.stdout.stdoutImpl</span></span><br></pre></td></tr></table></figure>

<h2 id="DQL编程控制"><a href="#DQL编程控制" class="headerlink" title="DQL编程控制"></a>DQL编程控制</h2><p>MyBatisPlus将书写复杂的SQL查询条件进行了封装，使用编程的形式完成查询条件的组合</p>
<p>如果要关闭mybatisplus的图标显示可以在yml设置如下</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"><span class="attr">global-config:</span></span><br><span class="line"><span class="attr">banner:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>关闭springboot的是</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">main:</span></span><br><span class="line"><span class="string">banner-mode:off</span></span><br></pre></td></tr></table></figure>

<p>条件查询的使用：queryWrapper是专门做查询封装条件的，后面的lt是对应html的&amp;lt，也就是小于号，这样就查询出年龄小于18的，大于号用gt</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testGetA11</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">//按条件查询</span></span><br><span class="line">QueryWrapper qw= <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>();</span><br><span class="line">qw.lt(<span class="string">&quot;age&quot;</span>,<span class="number">18</span>);</span><br><span class="line">List&lt;User&gt;userList =userDao.selectList(qw);</span><br><span class="line">System.out.println(userList);</span><br></pre></td></tr></table></figure>

<p>方式二，里面的是user类里的age属性的意思，注意要指定泛型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式二:lambda格式按条件查询</span></span><br><span class="line">QueryWrapper&lt;User&gt; qw= <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;();</span><br><span class="line">qw.lambda().lt(user::getAge, <span class="number">18</span>);</span><br><span class="line">List&lt;User&gt;userList =userDao.selectList(qw);</span><br><span class="line">System.out.println(userList);</span><br></pre></td></tr></table></figure>

<p>方式三（推荐）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式三:lambda格式按条件查询</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt;lqw=<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;();</span><br><span class="line">lqw.lt(User::getAge,val:<span class="number">10</span>);</span><br><span class="line">List&lt;User&gt;userList = userDao.selectList(lqw);</span><br><span class="line">System.out.println(userList);</span><br></pre></td></tr></table></figure>

<h3 id="null值处理"><a href="#null值处理" class="headerlink" title="null值处理"></a>null值处理</h3><p>在购物的时候会有些没选择的值，这里就成了空值，这应该怎么处理呢</p>
<p>新建一个query包，新建UserQuery类，这是封装User类的，继承user，然后分析user中有哪些东西可能会有上下限或者范围，比如数值型和日期型。那么这里的age2就用来描述年龄的上限，user里的age就描述年龄的下限</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserQuery</span> <span class="keyword">extends</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="keyword">private</span> Integer age2;</span><br></pre></td></tr></table></figure>

<p>然后到test中，模拟年龄下限为空时会发生什么，结果是不成功，以前判断空是要加个if(null !&#x3D; uq.getAge())，但这样写要写很多个if，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模拟页面传递过来的查询数据</span></span><br><span class="line"><span class="type">UserQuery</span> <span class="variable">uq</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserQuery</span>();</span><br><span class="line"><span class="comment">//uq.setAge(10);</span></span><br><span class="line">uq.setAge2(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//nuLL判定</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; lqw = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;();</span><br><span class="line">lqw.lt(User: :getAge, uq.getAge2());</span><br><span class="line">lqw.gt(User::getAge, uq.getAge());</span><br><span class="line">List&lt;User&gt; userList = userDao.selectList(lqw);</span><br><span class="line">System.out.println(userList) ;</span><br></pre></td></tr></table></figure>

<p>lt的值可以传个boolean</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260117161710215.png" alt="image-20260117161710215"></p>
<p>可以改造成下面的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LambdaQueryWrapper&lt;User&gt; lqw = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;();</span><br><span class="line">lqw.lt(User: :getAge, uq.getAge2());</span><br><span class="line"><span class="comment">//先判定第一个参数是否为true，如果为true连按当前条件</span></span><br><span class="line">lqw.lt(<span class="literal">null</span> != uq.getAge2(),User::getAge,uq.getAge2());</span><br><span class="line">lqw.lt(<span class="literal">null</span> != uq.getAge(),User::getAge,uq.getAge());</span><br><span class="line">List&lt;User&gt; userList = userDao.selectList(lqw);</span><br><span class="line">System.out.println(userList) ;</span><br></pre></td></tr></table></figure>

<h3 id="查询投影"><a href="#查询投影" class="headerlink" title="查询投影"></a>查询投影</h3><p>就是设置查询结果的样子。下面这个是查全集，然后设置只显示其中某一些字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询投影</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt;lqw= <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;();</span><br><span class="line"><span class="comment">//select这个专门设置查询的字段名，只适用于lambda格式</span></span><br><span class="line">lqw.select(User::getId,User::getName,User: :getAge);</span><br><span class="line"><span class="comment">//这个是不用lambda格式</span></span><br><span class="line">QueryWrapper&lt;User&gt; lqw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;();</span><br><span class="line">lqw.select(<span class="string">&quot;id&quot;</span>,<span class="string">&quot;name&quot;</span>,<span class="string">&quot;age&quot;</span>);</span><br><span class="line">List&lt;User&gt;userList =userDao.selectList(lqw);</span><br><span class="line">System.out.println(userList);</span><br></pre></td></tr></table></figure>

<p>现在要求查一下count，就是统计有多少数据。单纯用lqw.select(“count(*)”);的时候最终查询是个null，因为现在包装的是放在user对象里，放不进去，不能用selectList这个方法，用selectMaps，其中String代表key，Object代表value，最后输出的是count(*)&#x3D;6，但是看着很怪，起个别名叫count</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; lqw = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;();</span><br><span class="line">lqw.select(<span class="string">&quot;count(*) as count, tel&quot;</span>);</span><br><span class="line"><span class="comment">//List&lt;User&gt; userList = userDao.selectList(lqw);</span></span><br><span class="line"><span class="comment">//分组查询</span></span><br><span class="line">lqw.groupBy(<span class="string">&quot;tel&quot;</span>);</span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; userList = userDao.selectMaps(lqw);</span><br><span class="line">System.out.println(userList);</span><br></pre></td></tr></table></figure>

<h3 id="查询条件"><a href="#查询条件" class="headerlink" title="查询条件"></a>查询条件</h3><p>范围匹配（&gt;、&#x3D;、between)模糊匹配（like）<br>空判定（null）包含性匹配（in）分组（group）排序（order）</p>
<p>先看等匹配：eq就是equals</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//条件查询</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; 1qw = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;();</span><br><span class="line"><span class="comment">//意思是如果名字为Jerry并且密码是jerry</span></span><br><span class="line">lqw.eq(User::getName,<span class="string">&quot;Jerry&quot;</span>).eq(User::getPassword,<span class="string">&quot;jerry&quot;</span>) ;</span><br><span class="line"><span class="comment">//如果是这种只查询一种，没必要用selectList,用SelectOne就行</span></span><br><span class="line"><span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userDao.select0ne(lqw);</span><br><span class="line">System.out.println(loginUser);</span><br></pre></td></tr></table></figure>

<p>范围查询，lt 是不带等号的，le是带等号的，gt是不带ge是带</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LambdaQueryWrapper&lt;User&gt; 1qw = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;();<span class="comment">//范围查询LtLe gt ge eq between</span></span><br><span class="line"><span class="comment">//between的使用规则是有限制的，必须是从小到大</span></span><br><span class="line">lqw.between(User::getAge,<span class="number">10</span>, <span class="number">30</span>);</span><br><span class="line">List&lt;User&gt; userList = userDao.selectList(lqw);</span><br><span class="line">System.out.println(userList) ;</span><br></pre></td></tr></table></figure>

<p>模糊匹配</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LambdaQueryWrapper&lt;User&gt; 1qw = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;();<span class="comment">//模糊匹配Like</span></span><br><span class="line"><span class="comment">//这里的左和右是指百分号的位置，也就是J%以J开头的名字</span></span><br><span class="line">lqw.likeRight(User::getName,<span class="string">&quot;J&quot;</span>);</span><br><span class="line">List&lt;User&gt; userList = userDao.selectList(lqw);</span><br><span class="line">System.out.println(userList) ;</span><br></pre></td></tr></table></figure>

<p>更多查询条件设置参看<a target="_blank" rel="noopener" href="https://mybatis.plus/guide/wrapper.html#abstractwrapper">https://mybatis.plus/guide/wrapper.html#abstractwrapper</a></p>
<h3 id="字段映射与表明映射"><a href="#字段映射与表明映射" class="headerlink" title="字段映射与表明映射"></a>字段映射与表明映射</h3><ul>
<li><p>名称：@TableField类型：属性注解</p>
</li>
<li><p>位置：模型类属性定义上方</p>
</li>
<li><p>作用：设置当前属性对应的数据库表中的字段关系，也就是重命名为数据库的字段名</p>
</li>
<li><p>范例：</p>
</li>
<li><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="meta">@TableField(value=&quot;pwd&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String password;</span><br></pre></td></tr></table></figure>
</li>
<li><p>相关属性</p>
<ul>
<li>value（默认）：设置数据库表字段名称</li>
</ul>
</li>
</ul>
<p>问题二:编码中添加了数据库中未定义的属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这个意思是这个字段仅存在这个类里，数据库没有，排除这个</span></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> Integer online;</span><br></pre></td></tr></table></figure>

<p>名称：@TableField<br>类型：属性注解<br>位置：模型类属性定义上方<br>作用：设置当前属性对应的数据库表中的字段关系</p>
<p>相关属性<br>value：设置数据库表字段名称<br>exist：设置属性在数据库表字段中是否存在，默认为true。此属性无法与value合井使用</p>
<p>问题三：采用默认查询开放了更多的字段查看权限</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="meta">@TableField(value=&quot;pwd&quot;,select = false)</span></span><br><span class="line"><span class="keyword">private</span> String password;</span><br></pre></td></tr></table></figure>

<p>select：设置属性是否参与查询，此属性与select（）映射配置不冲突</p>
<p>问题四：表名与编码开发设计不同步，比如表明叫tb1_user</p>
<p>名称：@TableName<br>类型：类注解<br>位置：模型类定义上方<br>作用：设置当前类对应与数据库表关系范例:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableName(&quot;tbl_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>

<p>相关属性：value：设置数据库表名称</p>
<h3 id="id生成策略"><a href="#id生成策略" class="headerlink" title="id生成策略"></a>id生成策略</h3><ul>
<li><p>不同的表应用不同的id生成策略</p>
<ul>
<li>日志：自增（1,2,3,4，.）</li>
<li>购物订单：特殊规则（FQ23948AK3843）</li>
<li>外卖单：关联地区日期等信息（1004202003143491）</li>
<li>关系表：可省略id</li>
</ul>
</li>
<li><p>名称：@TableId</p>
</li>
<li><p>类型：属性注解</p>
</li>
<li><p>位置：模型类中用于表示主键的属性定义上方</p>
</li>
<li><p>作用：设置当前类中主键属性的生成策略</p>
</li>
<li><p>范例:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">- <span class="meta">@TableId(type = IdType.AUTo)</span></span><br><span class="line">- <span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>
</li>
<li><p>相关属性</p>
<ul>
<li>value：设置数据库主键名称</li>
<li>type：设置主键属性的生成策略，值参照IdType枚举值，有很多种</li>
</ul>
</li>
</ul>
<p>设置为AUTO后要去数据库看一下表结构，在表的选项把自动递增的值改小一点，他会自动识别最大值</p>
<p>设置为INPUT后要去数据库把自增策略取消，现在要求必须传id，而id需要自己指定，比如user.serId(666L)</p>
<ul>
<li>AUTO（0）：使用数据库id自增策略控制id生成</li>
<li>NONE（1）：不设置id生成策略</li>
<li>INPUT（2）：用户手工输入id</li>
<li>ASSIGN_ID（3）：雪花算法生成id（可兼容数值型与字符串型）</li>
<li>ASSIGN_UUID（4）：以UUID生成算法作为id生成策略</li>
</ul>
<p>雪花算法是生成一个串，是一个由64位二进制组成的，是一个long值</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260119033209429.png" alt="image-20260119033209429"></p>
<p>也可以弄个全局设置，在yml里加上</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line"><span class="attr">global-config:</span></span><br><span class="line"><span class="attr">db-config:</span></span><br><span class="line"><span class="string">id-type:assign_id</span></span><br></pre></td></tr></table></figure>

<h3 id="多记录操作"><a href="#多记录操作" class="headerlink" title="多记录操作"></a>多记录操作</h3><p>用这个方法deleteBatchIds</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//批量删除</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span>&#123;</span><br><span class="line">List&lt;Long&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    list.add(<span class="number">1402551342481838081L</span>);</span><br><span class="line">    list.add(<span class="number">1402553134049501186L</span>);</span><br><span class="line">    list.add(<span class="number">1402553619611430913L</span>);</span><br><span class="line">    userDao.deleteBatchIds(list);</span><br><span class="line"></span><br><span class="line"><span class="comment">//批量查询</span></span><br><span class="line">List&lt;Long&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">list.add(<span class="number">1402551342481838081L</span>) ;</span><br><span class="line">    list.add(<span class="number">1402553134049501186L</span>);</span><br><span class="line">    list.add(<span class="number">1402553619611430913L</span>);</span><br><span class="line">    userDao.selectBatchIds();</span><br></pre></td></tr></table></figure>

<h3 id="逻辑删除"><a href="#逻辑删除" class="headerlink" title="逻辑删除"></a>逻辑删除</h3><p>删除操作业务问题：业务数据从数据库中丢弃</p>
<p>逻辑删除：为数据设置是否可用状态字段，删除时设置状态字段为不可用状态，数据保留在数据库中，比如设置1就是删除了，0就是没删，但都还保留着</p>
<p>先在数据库添加deleted字段，默认值为0，然后到User类加个逻辑删除字段，标记当前记录是否被删除</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//逻辑删除字段，标记当前记录是否被删除，里面的值都是默认值，要与数据库的对应</span></span><br><span class="line"><span class="meta">@TableLogic(value = &quot;0&quot; ,delval = &quot;1&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Integer deleted;</span><br></pre></td></tr></table></figure>

<p>执行后的sql语句:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> tbl_user <span class="keyword">SET</span> deleted<span class="operator">=</span><span class="number">1</span> <span class="keyword">WHERE</span> id<span class="operator">=</span>? <span class="keyword">AND</span> deleted<span class="operator">=</span><span class="number">0</span> </span><br></pre></td></tr></table></figure>

<p>这个也有在配置中搞定，第一个是用哪个字段做通用的逻辑，第二个是没有删除的东西标记是几，第三个是被逻辑删除的字段对应的值是几</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260119035440820.png" alt="image-20260119035440820"></p>
<h3 id="乐观锁"><a href="#乐观锁" class="headerlink" title="乐观锁"></a>乐观锁</h3><p>业务并发现象带来的问题：秒杀</p>
<p>要现在数据库加个字段用来标记当前谁在操作这条数据，然后在user里加下面字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Version</span></span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure>

<p>这个锁的原理是比如一个sql语句update set abc&#x3D;1，如果我有锁就where version &#x3D; 1，但如果别人拿到了也是1，那么效果就达不到了，所以修改的时候就变成version&#x3D;version+1，这样不断的累加就会不一样</p>
<p>在之前的分页里mp是通过拦截器帮我们把sql语句里加上，下面第二个拦截器是之前分页的拦截器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MpConfig</span> &#123;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mpInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="comment">//1.定义Mp拦截器</span></span><br><span class="line">	<span class="type">MybatisPlusInterceptor</span> <span class="variable">mpInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">	<span class="comment">//2.添加具体的拦截器</span></span><br><span class="line">	mpInterceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>());</span><br><span class="line">    <span class="comment">//3.添加乐观锁拦截器</span></span><br><span class="line">	mpInterceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">OptimisticLockerInnerInterceptor</span>());</span><br><span class="line">    <span class="keyword">return</span> mpInterceptor;</span><br></pre></td></tr></table></figure>

<p>在使用这个的时候要记得加上version值，不提供就没有锁机制。下面这个是test类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user.setVersion(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>输出的结果是</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">UPDATE</span> tb1_user <span class="keyword">SET</span> name<span class="operator">=</span>?, version<span class="operator">=</span>? <span class="keyword">WHERE</span> id<span class="operator">=</span>? <span class="keyword">AND</span> version<span class="operator">=</span>? <span class="keyword">AND</span> deleted<span class="operator">=</span><span class="number">0</span></span><br><span class="line">Parameters: Jock666(String), <span class="number">2</span>(<span class="type">Integer</span>), <span class="number">3</span>(Long), <span class="number">1</span>(<span class="type">Integer</span>)</span><br></pre></td></tr></table></figure>

<p>如果不用锁，就是下面代码，这里面是有version的，可以不从前台拿到version但是要保证这里有version</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.先通过要修改的数据id将当前数据查询出来</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.selectById(<span class="number">3L</span>);</span><br><span class="line"><span class="comment">//2.将要修改的属性逐一设置进去</span></span><br><span class="line">user.setName(<span class="string">&quot;Jock888&quot;</span>);</span><br><span class="line"></span><br><span class="line">模拟一下两个用户同时操作</span><br><span class="line"><span class="comment">//1.先通过要修改的数据d将当前数据查询出来</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.selectById(<span class="number">3L</span>);</span><br><span class="line"><span class="comment">//version=3</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> userDao.selectById(<span class="number">3L</span>);</span><br><span class="line"><span class="comment">//version=3</span></span><br><span class="line">user2.setName(<span class="string">&quot;Jock aaa&quot;</span>);</span><br><span class="line">userDao.updateById(user2) ;</span><br><span class="line"><span class="comment">//version=&gt;4</span></span><br><span class="line">user.setName(<span class="string">&quot;Jock bbb&quot;</span>);</span><br><span class="line">userDao.updateById(user);</span><br><span class="line"><span class="comment">//verion=3?条件还成立吗？就不成立了</span></span><br></pre></td></tr></table></figure>

<p>也就是上面的执行完version已经是4了，下面的就不成立，所以执行失败</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260119235730228.png" alt="image-20260119235730228"></p>
<h2 id="代码生成器"><a href="#代码生成器" class="headerlink" title="代码生成器"></a>代码生成器</h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/SSM/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98SSM/image-20260120173126665.png" alt="image-20260120173126665"></p>
<p>其实有些信息是可以读取数据库获取的</p>
<p>我们新建一个项目，pom里面新添两个坐标</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--代码生成器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--veLocity模板引擎，模板技术是一个独立的技术--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.velocity<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>velocity-engine-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后新建一个类，先创建代码生成器的对象，然后执行代码生成器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Generator</span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(string[]args)</span>&#123;</span><br><span class="line"><span class="type">AutoGenerator</span> <span class="variable">autoGenerator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AutoGenerator</span>();</span><br><span class="line">    </span><br><span class="line"><span class="comment">//设置数据库配置</span></span><br><span class="line"><span class="type">DataSourceConfig</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceConfig</span>();</span><br><span class="line">dataSource.setDriverName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/mybatisplus_db?serverTimezone=UTc&quot;</span>);</span><br><span class="line">dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">dataSource.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">autoGenerator.setDataSource(dataSource);</span><br><span class="line">    </span><br><span class="line">autoGenerator.execute();<span class="comment">//执行代码</span></span><br></pre></td></tr></table></figure>

<p>执行后就生成了一些文件，文件名叫conf，但是生成的路径不太对，就可以配置一些东西</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置全局配置</span></span><br><span class="line"><span class="type">GlobalConfig</span> <span class="variable">globalConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GlobalConfig</span>();</span><br><span class="line"><span class="comment">//这个是准备输出到什么位置，点进setoutputDir查看源码，默认是输出到d盘根目录里，所以后面的配置是输出到用户目录的</span></span><br><span class="line">globalconfig.setoutputDir(System.getProperty(<span class="string">&quot;user.dir&quot;</span>)+<span class="string">&quot;/mybatisplus_04_generator/src/main/java&quot;</span>);</span><br><span class="line">globalconfig.setOpen（<span class="literal">false</span>）；<span class="comment">//设置生成完毕后是否打开生成代码所在的目录</span></span><br><span class="line">globalConfig.setAuthor(<span class="string">&quot;黑马程序员&quot;</span>）;<span class="comment">//设置生成的作者</span></span><br><span class="line">                       globalConfig.setFileoverride(<span class="literal">true</span>);<span class="comment">//后生成的要不要覆盖前面生成的文件</span></span><br><span class="line">                       globalConfig.setMapperName(<span class="string">&quot;%sDao&quot;</span>);<span class="comment">//设置数据层接口名，%s为占位符（数据库里的表名），指代模块名称，比如按照我们的设置生成的文件名就叫xxx_xxxDao，如果不设置这个会按照他自己的规则生成xxxMapper</span></span><br><span class="line">globalConfig.setIdType(IdType.ASSIGN_ID); <span class="comment">//设置Id生成策略，会在实体类里自动加上@TableId(value = &quot;id&quot;,type = IdType.ASSIGN_ID)</span></span><br><span class="line">                       autoGenerator.setGlobalConfig(globalConfig);</span><br></pre></td></tr></table></figure>

<p>然后是包名相关配置，创建出来的实体类不叫domain，叫entity，dao包叫mapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置包名相关配置</span></span><br><span class="line"><span class="type">PackageConfig</span> <span class="variable">packageInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PackageConfig</span>();</span><br><span class="line">packageInfo.setParent（<span class="string">&quot;com.itheima”）；//设置生成的包名，与代码所在位置不冲突，二者叠加组成完整路径</span></span><br><span class="line"><span class="string">packageInfo.setEntity(&quot;</span>domain<span class="string">&quot;)；//设置实体类包名</span></span><br><span class="line"><span class="string">packageInfo.setMapper(&quot;</span>dao<span class="string">&quot;);//设置数据层包名</span></span><br><span class="line"><span class="string">autoGenerator.setPackageInfo(packageInfo);</span></span><br></pre></td></tr></table></figure>

<p>然后是策略配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//策略设置</span></span><br><span class="line"><span class="type">StrategyConfig</span> <span class="variable">strategyConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StrategyConfig</span>();</span><br><span class="line">strategyConfig.setInclude（<span class="string">&quot;tbl_user&quot;</span>）；<span class="comment">//设置当前参与生成的表名，参数为可变参数，就是只生成哪些表</span></span><br><span class="line">strategyConfig.setTablePrefix（<span class="string">&quot;tbl_&quot;</span>）； <span class="comment">//设置数据库表的前缀名称，模块名=数据库表名－前缀名例如：User =tbl_user就变成了user</span></span><br><span class="line">strategyConfig.setRestControllerStyle(<span class="literal">true</span>）；<span class="comment">//设置是否启用Rest风格</span></span><br><span class="line">strategyConfig.setEntityLombokModel（<span class="literal">true</span>）;<span class="comment">//设置是否启用Lombok</span></span><br><span class="line">strategyConfig.setVersionFieldName（<span class="string">&quot;version&quot;</span>）；<span class="comment">//设置乐观锁字段名strategyConfig.setLogicDeleteFieldName（&quot;deleted&quot;）；//设置逻辑删除字段名</span></span><br><span class="line"></span><br><span class="line">autoGenerator.setStrategy(strategyConfig);</span><br><span class="line"><span class="comment">//2.执行生成操作</span></span><br><span class="line">autoGenerator.execute();</span><br></pre></td></tr></table></figure>

<p>运行后controller里的注解就自动加上@RestController，然后User里加上了@Data，多了个@EquealsAndHashCode(callSuper &#x3D; false)，这个是生成的equals和hashcode是否继承父类的equals和hashcode方法，然后下面的deleted和version都加上了注解</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/Shelter67">Shelter</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://localhost:4000/posts/e25feb6e.html">http://localhost:4000/posts/e25feb6e.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://localhost:4000" target="_blank">Shelter</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SSM/">SSM</a><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.dreamshelter.cn/blog/source/img/cover/26.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/da77c56c.html" title="MVC架构设计模式"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/21.jpg" onerror="onerror=null;src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">MVC架构设计模式</div></div><div class="info-2"><div class="info-item-1">不使用mvc架构的缺陷在不使用MVC架构模式的前提下，完成银行账户转账。分析这个程序存在哪些问题?  缺点1&gt;代码的复用性太差。(代码的重用性太差) 导致缺点1的原因? 因为没有进行”职能分工”，没有独立组件的概念，所以没有办法进行代码复用。代码和代码之间的耦合度太高，扩展力太差。  缺点2&gt;耦合度高，导致了代码很难护展。  缺点3&gt;操作数据库的代码和业务逻辑混杂在一起，很容易出错。编写代码的时候很容易出错，无法专注业务逻辑的编写。   分析以下AccountTransferServlet他都负责了什么?   负责了数据接收    负责了核心的业务处理    负责了数据库表中数据的CRUD操作 (Create【增】 Retrieve【査】 Update【改】 Delete【删】)    负责了页面的数据展示    公司中一般都有很多员工，每个员工都各司其职，为什么要这样?	保洁阿姨负责打扫卫生	杜老师负责教学大纲的指定	郭老师负责上课	王老师负责学习就业*我们公司只有一个员工。这个员工负责所有的事情。生病了。–&gt;公司倒闭了。 理论基础 javaEE设计模式...</div></div></div></a><a class="pagination-related" href="/posts/2821e645.html" title="饱了么后端"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/11.jpg" onerror="onerror=null;src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">饱了么后端</div></div><div class="info-2"><div class="info-item-1">项目效果前端是小程序，后端是商家管理界面，管理界面需要登录才可以使用，右上角可以切换营业状态，其他都是一些增删改查，然后里面是有真正的支付功能，支付后会告诉商家订单信息，可以选择拒单或者接单，用户会有个等待商户接单界面，也可以进行催单，接单成功后就进入到待派送状态，商家点击派送就进入到派送中状态，如果派送到就可以点击完成按钮进入已完成状态 然后也有数据统计，工作台里记录当天的一些数据 开发准备软件开发流程需求分析需要需求规格说明书   产品原型，一般是静态网页展示   设计： ui设计：会讲这个项目做完后最终的效果是什么样子，小到一个按钮，大到整个页面布局 数据库设计：把类型和数据库有什么关系都设计好 接口设计：比如一个登录功能的接口，请求方式什么样子的，参数路径是什么样子的 编码： 项目代码、单元测试 测试： 测试用例、测试报告 上线运维： 软件环境安装、配置 角色分工 项目经理：对整个项目负责，任务分配、把控进度 产品经理：进行需求调研，输出需求调研文档、产品原型等 UI设计师：根据产品原型输出界面效果图 架构师：项目整体架构设计、技术选型等 开发工程师：代码实现 测试工程师...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/7d713e54.html" title="Spirng速成"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/30.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-18</div><div class="info-item-2">Spirng速成</div></div><div class="info-2"><div class="info-item-1"> 给分成了三层，后面的mapper就是mybatis的，如果要获取其他对象就需要在这里面创建类，比如BookService2 b &#x3D; new BookService2这样，但只要一改名字，就需要把所有的对象名字都改，这样耦合度太高。就需要用到spring容器来进行统一管理 ioc就是控制反转的意思，把创建对象的权利交给spring容器  会有一个配置文件叫applicationcontext.xml，里面存放了bean这个，id就是名字，class是类型，然后他自动通过反射机制创建对象，然后放到spring容器里，这个容器可以理解成一个筐，苹果放一个筐梨放一个筐，然后再从这个容器里读取到java程序    1234&lt;bean id = &quot;b&quot; class = &#x27;com.msb.pojo.Book&#x27;&gt;	&lt;property name=&quot;id&quot; value=&quot;1&quot;&gt;&lt;/property&gt;    &lt;property name=&quot;name&quot;...</div></div></div></a><a class="pagination-related" href="/posts/9c933fc9.html" title="学习Maven"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/18.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-14</div><div class="info-item-2">学习Maven</div></div><div class="info-2"><div class="info-item-1">maven简介https://www.bilibili.com/video/BV1uApMeWErY?spm_id_from=333.788.videopod.sections&amp;vd_source=b0128143be22d1783a42f5fbf34d9d25 pom.xml 定义了项目的配置、依赖、插件、以及构建的过程 Maven仓库就是存放jiar包的地方，按照作用范围可以分为  本地仓库  就是电脑上的本地目录，默认在  一定要是一个没有中文的路径下。    远程仓库  一般是一个公司或者组织内部搭建的一个仓库，用来给内部的项目提供统一的依赖管理，避免jar包的重复下载 也可以通过中央仓库下载，是Maven官方维护的一个仓库 ，开源jar包都可以在这里找到   私服   maven安装和下载Maven官网：https://maven.apache.org/ Maven下载地址：https://maven.apache.org/download.cgi Nexus下载地址：https://help.sonatype.com/en/download.html 环境变量...</div></div></div></a><a class="pagination-related" href="/posts/6c92115f.html" title="Spring"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/6.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-20</div><div class="info-item-2">Spring</div></div><div class="info-2"><div class="info-item-1">十五、面向切面编程AOPIoC使软件组件松耦合。AOP让你能够捕捉系统中经常使用的功能，把它转化成组件。AOP（Aspect Oriented Programming）：面向切面编程，面向方面编程。（AOP是一种编程技术）AOP是对OOP的补充延伸。AOP底层使用的就是动态代理来实现的。Spring的AOP使用的动态代理是：JDK动态代理 + CGLIB动态代理技术。Spring在这两种动态代理中灵活切换，如果是代理接口，会默认使用JDK动态代理，如果要代理某个类，这个类没有实现接口，就会切换使用CGLIB。当然，你也可以强制通过一些配置让Spring只使用CGLIB。 15.1 AOP介绍一般一个系统当中都会有一些系统服务，例如：日志、事务管理、安全等。这些系统服务被称为：交叉业务这些交叉业务几乎是通用的，不管你是做银行账户转账，还是删除用户数据。日志、事务管理、安全，这些都是需要做的。如果在每一个业务处理过程当中，都掺杂这些交叉业务代码进去的话，存在两方面问题：  第一：交叉业务代码在多个业务流程中反复出现，显然这个交叉业务代码没有得到复用。并且修改这些交叉业务代码的话，需要...</div></div></div></a><a class="pagination-related" href="/posts/da77c56c.html" title="MVC架构设计模式"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/21.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-11-15</div><div class="info-item-2">MVC架构设计模式</div></div><div class="info-2"><div class="info-item-1">不使用mvc架构的缺陷在不使用MVC架构模式的前提下，完成银行账户转账。分析这个程序存在哪些问题?  缺点1&gt;代码的复用性太差。(代码的重用性太差) 导致缺点1的原因? 因为没有进行”职能分工”，没有独立组件的概念，所以没有办法进行代码复用。代码和代码之间的耦合度太高，扩展力太差。  缺点2&gt;耦合度高，导致了代码很难护展。  缺点3&gt;操作数据库的代码和业务逻辑混杂在一起，很容易出错。编写代码的时候很容易出错，无法专注业务逻辑的编写。   分析以下AccountTransferServlet他都负责了什么?   负责了数据接收    负责了核心的业务处理    负责了数据库表中数据的CRUD操作 (Create【增】 Retrieve【査】 Update【改】 Delete【删】)    负责了页面的数据展示    公司中一般都有很多员工，每个员工都各司其职，为什么要这样?	保洁阿姨负责打扫卫生	杜老师负责教学大纲的指定	郭老师负责上课	王老师负责学习就业*我们公司只有一个员工。这个员工负责所有的事情。生病了。–&gt;公司倒闭了。 理论基础 javaEE设计模式...</div></div></div></a><a class="pagination-related" href="/posts/7273cdc.html" title="Maven"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/13.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-13</div><div class="info-item-2">Maven</div></div><div class="info-2"><div class="info-item-1">什么是MavenMaven的概念Maven 是 Apache 软件基金会组织维护的一款自动化构建工具，专注服务于 Java 平台的项目构建和依赖管理。Maven 这个单词的本意是：专家，内行。 它是一个一键式的自动化的构建工具.首先,Maven可以自动的帮助我们下载jar包.其次可以进行多个项目同时的编译运行.还有在开发的过程中需要进行测试运行,Maven提供了自动化的测试插件帮助我们进行项目测试功能的运行.最后项目是需要进行资源文件,配置文件的整合,来进行打包和部署,Maven可以轻松搞定. 为什么要使用Maven我们知道，项目开发不仅仅是写写代码而已，期间会伴随着各种必不可少的事情要做，例如：  我们需要引用各种 jar 包，尤其是比较大的工程，引用的 jar 包往往有几十个乃至上百个，每个都要到不同的官网去下载，而且每次用到的 jar 包，都需要手动引入工程目录，而且经常遇到各种让人抓狂的 jar 包冲突，版本冲突，Maven可以自动下载jar包及依赖包添加到项目中，大大减轻了工作负担。 我们开发的 Java 文件，都是需要将它编译成二进制字节码文件。好在这项工作可以由各种...</div></div></div></a><a class="pagination-related" href="/posts/d2dc75e3.html" title="老杜MyBatis"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/8.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-10</div><div class="info-item-2">老杜MyBatis</div></div><div class="info-2"><div class="info-item-1">一、MyBatis概述1.1 框架 在文献中看到的framework被翻译为框架 Java常用框架： SSM三大框架：Spring + SpringMVC + MyBatis SpringBoot SpringCloud 等。。   框架其实就是对通用代码的封装，提前写好了一堆接口和类，我们可以在做项目的时候直接引入这些接口和类（引入框架），基于这些现有的接口和类进行开发，可以大大提高开发效率。 框架一般都以jar包的形式存在。(jar包中有class文件以及各种配置文件等。) SSM三大框架的学习顺序：MyBatis、Spring、SpringMVC（仅仅是建议）  1.2 三层架构  表现层（UI）：直接跟前端打交互（一是接收前端ajax请求，二是返回json数据给前端） 业务逻辑层（BLL）：一是处理表现层转发过来的前端请求（也就是具体业务），二是将从持久层获取的数据返回到表现层。 数据访问层（DAL）：直接操作数据库完成CRUD，并将获得的数据返回到上一层（也就是业务逻辑层）。 Java持久层框架： MyBatis Hibernate（实现了JPA规范） jOOQ Guz...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/touxiang.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Shelter</div><div class="author-info-description">记录自己的成长日志</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Shelter67"><i class="fab fa-github"></i><span>没有什么star的github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Shelter67" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1830191738@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/8416212" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #fb7299;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的小小博客！都是基于hexo框架使用，魔改了一些地方，表现得有些二次元，有个博客希望能在未来工作简历上成为加分项吧，但是弄起来还真的挺好玩的</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#spring"><span class="toc-number">1.</span> <span class="toc-text">spring</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">核心概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IoC%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">IoC入门案例思路分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DI%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90"><span class="toc-number">1.3.</span> <span class="toc-text">DI入门案例思路分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bean"><span class="toc-number">1.4.</span> <span class="toc-text">bean</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bean%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.1.</span> <span class="toc-text">bean基础配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bean%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="toc-number">1.4.2.</span> <span class="toc-text">bean实例化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">1.4.3.</span> <span class="toc-text">bean生命周期</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">1.5.</span> <span class="toc-text">依赖注入方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#setter%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.1.</span> <span class="toc-text">setter引用类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setter%E7%AE%80%E5%8D%95%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.2.</span> <span class="toc-text">setter简单类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5-%E7%AE%80%E5%8D%95%E7%B1%BB%E5%9E%8B%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">1.5.3.</span> <span class="toc-text">构造器注入-简单类型（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="toc-number">1.5.4.</span> <span class="toc-text">自动装配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%B3%A8%E5%85%A5"><span class="toc-number">1.5.5.</span> <span class="toc-text">集合注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-%E6%95%B0%E6%8D%AE%E6%BA%90%E5%AF%B9%E8%B1%A1%E7%AE%A1%E7%90%86"><span class="toc-number">1.6.</span> <span class="toc-text">案例:数据源对象管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BDproperties%E6%96%87%E4%BB%B6"><span class="toc-number">1.7.</span> <span class="toc-text">加载properties文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8"><span class="toc-number">1.8.</span> <span class="toc-text">容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E7%9B%B8%E5%85%B3"><span class="toc-number">1.8.1.</span> <span class="toc-text">容器相关</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-number">1.9.</span> <span class="toc-text">注解开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91bean"><span class="toc-number">1.9.1.</span> <span class="toc-text">注解开发bean</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%AF%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-number">1.9.2.</span> <span class="toc-text">纯注解开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bean%E7%AE%A1%E7%90%86%E5%92%8C%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">1.9.3.</span> <span class="toc-text">bean管理和生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5"><span class="toc-number">1.9.4.</span> <span class="toc-text">依赖注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9bean%E7%AE%A1%E7%90%86"><span class="toc-number">1.9.5.</span> <span class="toc-text">第三方bean管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E7%AC%AC%E4%B8%89%E6%96%B9bean%E6%B3%A8%E5%85%A5%E8%B5%84%E6%BA%90"><span class="toc-number">1.9.6.</span> <span class="toc-text">为第三方bean注入资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XML%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%B3%A8%E8%A7%A3%E9%85%8D%E7%BD%AE%E6%AF%94%E8%BE%83"><span class="toc-number">1.9.7.</span> <span class="toc-text">XML配置与注解配置比较</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E6%95%B4%E5%90%88MyBatis"><span class="toc-number">1.10.</span> <span class="toc-text">Spring整合MyBatis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spring%E6%95%B4%E5%90%88JUnit"><span class="toc-number">1.11.</span> <span class="toc-text">spring整合JUnit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP"><span class="toc-number">1.12.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.12.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOP%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">1.12.2.</span> <span class="toc-text">AOP入门案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOP%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">1.12.3.</span> <span class="toc-text">AOP工作流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOP%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.12.4.</span> <span class="toc-text">AOP切入点表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOP%E9%80%9A%E7%9F%A5%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.12.5.</span> <span class="toc-text">AOP通知类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%EF%BC%9A%E6%B5%8B%E9%87%8F%E4%B8%9A%E5%8A%A1%E5%B1%82%E6%8E%A5%E5%8F%A3%E4%B8%87%E6%AC%A1%E6%89%A7%E8%A1%8C%E6%95%88%E7%8E%87"><span class="toc-number">1.12.6.</span> <span class="toc-text">案例：测量业务层接口万次执行效率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOP%E9%80%9A%E7%9F%A5%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.12.7.</span> <span class="toc-text">AOP通知获取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%EF%BC%9A%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E5%AF%86%E7%A0%81%E6%95%B0%E6%8D%AE%E5%85%BC%E5%AE%B9%E5%A4%84%E7%90%86"><span class="toc-number">1.12.8.</span> <span class="toc-text">案例：百度网盘密码数据兼容处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AOP%E6%80%BB%E7%BB%93"><span class="toc-number">1.12.9.</span> <span class="toc-text">AOP总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spring%E4%BA%8B%E5%8A%A1%E7%AE%80%E4%BB%8B"><span class="toc-number">1.13.</span> <span class="toc-text">spring事务简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%EF%BC%9A%E9%93%B6%E8%A1%8C%E8%B4%A6%E6%88%B7%E8%BD%AC%E8%B4%A6"><span class="toc-number">1.13.1.</span> <span class="toc-text">案例：银行账户转账</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spring%E4%BA%8B%E5%8A%A1%E8%A7%92%E8%89%B2"><span class="toc-number">1.13.2.</span> <span class="toc-text">spring事务角色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="toc-number">1.13.3.</span> <span class="toc-text">事务相关配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringMVC"><span class="toc-number">2.</span> <span class="toc-text">SpringMVC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringMVC%E7%AE%80%E4%BB%8B"><span class="toc-number">2.1.</span> <span class="toc-text">SpringMVC简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">2.2.</span> <span class="toc-text">入门案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90"><span class="toc-number">2.2.1.</span> <span class="toc-text">入门案例工作流程分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bean%E5%8A%A0%E8%BD%BD%E6%8E%A7%E5%88%B6"><span class="toc-number">2.3.</span> <span class="toc-text">bean加载控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E8%B0%83%E8%AF%95%E4%B8%8E%E5%8F%91%E9%80%81%E7%BD%91%E9%A1%B5HTTP%E8%AF%B7%E6%B1%82%E7%9A%84%E6%8F%92%E4%BB%B6"><span class="toc-number">2.4.</span> <span class="toc-text">网页调试与发送网页HTTP请求的插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%93%8D%E5%BA%94"><span class="toc-number">2.5.</span> <span class="toc-text">请求与响应</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E7%9A%84%E6%98%A0%E5%B0%84%E8%B7%AF%E5%BE%84"><span class="toc-number">2.5.1.</span> <span class="toc-text">请求的映射路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="toc-number">2.5.2.</span> <span class="toc-text">请求方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">2.5.3.</span> <span class="toc-text">请求参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#json%E6%95%B0%E6%8D%AE"><span class="toc-number">2.5.4.</span> <span class="toc-text">json数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="toc-number">2.5.5.</span> <span class="toc-text">日期类型参数传递</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%8D%E5%BA%94"><span class="toc-number">2.6.</span> <span class="toc-text">响应</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REST%E9%A3%8E%E6%A0%BC"><span class="toc-number">2.7.</span> <span class="toc-text">REST风格</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">2.7.1.</span> <span class="toc-text">案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#restful%E5%BF%AB%E9%80%9F%E5%BC%80%E5%8F%91"><span class="toc-number">2.7.2.</span> <span class="toc-text">restful快速开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-%E5%9F%BA%E4%BA%8ERESTful%E9%A1%B5%E9%9D%A2%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92"><span class="toc-number">2.7.3.</span> <span class="toc-text">案例:基于RESTful页面数据交互</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSM%E6%95%B4%E5%90%88"><span class="toc-number">2.8.</span> <span class="toc-text">SSM整合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SSM%E6%95%B4%E5%90%88%E6%B5%81%E7%A8%8B"><span class="toc-number">2.8.1.</span> <span class="toc-text">SSM整合流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97"><span class="toc-number">2.8.2.</span> <span class="toc-text">功能模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%8E%B0%E5%B1%82%E6%95%B0%E6%8D%AE%E5%B0%81%E8%A3%85"><span class="toc-number">2.8.3.</span> <span class="toc-text">表现层数据封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.8.3.1.</span> <span class="toc-text">实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">2.8.4.</span> <span class="toc-text">异常处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%96%B9%E6%A1%88"><span class="toc-number">2.8.5.</span> <span class="toc-text">项目异常处理方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8D%8F%E8%AE%AE%E8%81%94%E8%B0%83"><span class="toc-number">2.8.6.</span> <span class="toc-text">前后端协议联调</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD"><span class="toc-number">2.8.6.1.</span> <span class="toc-text">添加功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%8A%9F%E8%83%BD"><span class="toc-number">2.8.6.2.</span> <span class="toc-text">修改功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%8A%9F%E8%83%BD"><span class="toc-number">2.8.6.3.</span> <span class="toc-text">编辑功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%8A%9F%E8%83%BD"><span class="toc-number">2.8.6.4.</span> <span class="toc-text">删除功能</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">2.9.</span> <span class="toc-text">拦截器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%A6%E6%88%AA%E5%99%A8%E6%A6%82%E5%BF%B5"><span class="toc-number">2.9.1.</span> <span class="toc-text">拦截器概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B-1"><span class="toc-number">2.9.2.</span> <span class="toc-text">入门案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%A6%E6%88%AA%E5%8F%82%E6%95%B0"><span class="toc-number">2.9.3.</span> <span class="toc-text">拦截参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">2.9.4.</span> <span class="toc-text">多个拦截器执行顺序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Maven%E8%BF%9B%E9%98%B6"><span class="toc-number">3.</span> <span class="toc-text">Maven进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91%E4%B8%8E%E8%AE%BE%E8%AE%A1"><span class="toc-number">3.1.</span> <span class="toc-text">分模块开发与设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86"><span class="toc-number">3.2.</span> <span class="toc-text">依赖管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E9%80%89%E4%BE%9D%E8%B5%96%E5%92%8C%E6%8E%92%E9%99%A4%E4%BE%9D%E8%B5%96"><span class="toc-number">3.3.</span> <span class="toc-text">可选依赖和排除依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E4%B8%8E%E8%81%9A%E5%90%88"><span class="toc-number">3.4.</span> <span class="toc-text">继承与聚合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-number">3.5.</span> <span class="toc-text">属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86"><span class="toc-number">3.6.</span> <span class="toc-text">版本管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E5%BA%94%E7%94%A8"><span class="toc-number">3.7.</span> <span class="toc-text">多环境配置与应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BF%87%E6%B5%8B%E8%AF%95"><span class="toc-number">3.7.1.</span> <span class="toc-text">跳过测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%81%E6%9C%8D"><span class="toc-number">3.8.</span> <span class="toc-text">私服</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot"><span class="toc-number">4.</span> <span class="toc-text">SpringBoot</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B-2"><span class="toc-number">4.1.</span> <span class="toc-text">入门案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Springboot%E9%A1%B9%E7%9B%AE%E5%BF%AB%E9%80%9F%E5%90%AF%E5%8A%A8"><span class="toc-number">4.2.</span> <span class="toc-text">Springboot项目快速启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Springboot%E6%A6%82%E8%BF%B0"><span class="toc-number">4.3.</span> <span class="toc-text">Springboot概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#springboot%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">4.4.</span> <span class="toc-text">springboot启动方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">4.5.</span> <span class="toc-text">基础配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yaml"><span class="toc-number">4.6.</span> <span class="toc-text">yaml</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#yaml%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96"><span class="toc-number">4.6.1.</span> <span class="toc-text">yaml数据读取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%BC%80%E5%8F%91%E9%85%8D%E7%BD%AE"><span class="toc-number">4.7.</span> <span class="toc-text">多环境开发配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE"><span class="toc-number">4.8.</span> <span class="toc-text">多环境命令行启动参数设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%BC%80%E5%8F%91%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98"><span class="toc-number">4.9.</span> <span class="toc-text">多环境开发兼容问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%88%86%E7%B1%BB"><span class="toc-number">4.10.</span> <span class="toc-text">配置文件分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E5%90%88%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8A%80%E6%9C%AF"><span class="toc-number">4.11.</span> <span class="toc-text">整合第三方技术</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8ESpringBoot%E6%95%B4%E5%90%88mybatis"><span class="toc-number">4.12.</span> <span class="toc-text">基于SpringBoot整合mybatis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%EF%BC%9A%E5%9F%BA%E4%BA%8Eboot%E7%9A%84ssm%E6%95%B4%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-number">4.13.</span> <span class="toc-text">案例：基于boot的ssm整合案例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mybatis-plus"><span class="toc-number">5.</span> <span class="toc-text">mybatis plus</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MyBatisPlus%E7%AE%80%E4%BB%8B"><span class="toc-number">5.1.</span> <span class="toc-text">MyBatisPlus简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E6%95%B0%E6%8D%AE%E5%B1%82%E5%BC%80%E5%8F%91"><span class="toc-number">5.2.</span> <span class="toc-text">标准数据层开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E5%8A%9F%E8%83%BD"><span class="toc-number">5.2.1.</span> <span class="toc-text">分页功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DQL%E7%BC%96%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">5.3.</span> <span class="toc-text">DQL编程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-number">5.3.1.</span> <span class="toc-text">null值处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%8A%95%E5%BD%B1"><span class="toc-number">5.3.2.</span> <span class="toc-text">查询投影</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%9D%A1%E4%BB%B6"><span class="toc-number">5.3.3.</span> <span class="toc-text">查询条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E6%98%A0%E5%B0%84%E4%B8%8E%E8%A1%A8%E6%98%8E%E6%98%A0%E5%B0%84"><span class="toc-number">5.3.4.</span> <span class="toc-text">字段映射与表明映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#id%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5"><span class="toc-number">5.3.5.</span> <span class="toc-text">id生成策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%AE%B0%E5%BD%95%E6%93%8D%E4%BD%9C"><span class="toc-number">5.3.6.</span> <span class="toc-text">多记录操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4"><span class="toc-number">5.3.7.</span> <span class="toc-text">逻辑删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%90%E8%A7%82%E9%94%81"><span class="toc-number">5.3.8.</span> <span class="toc-text">乐观锁</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-number">5.4.</span> <span class="toc-text">代码生成器</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/da77c56c.html" title="MVC架构设计模式"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/21.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="MVC架构设计模式"/></a><div class="content"><a class="title" href="/posts/da77c56c.html" title="MVC架构设计模式">MVC架构设计模式</a><time datetime="2026-11-14T16:24:00.000Z" title="发表于 2026-11-15 00:24:00">2026-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e25feb6e.html" title="黑马程序员SSM"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/26.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="黑马程序员SSM"/></a><div class="content"><a class="title" href="/posts/e25feb6e.html" title="黑马程序员SSM">黑马程序员SSM</a><time datetime="2026-02-03T03:14:00.000Z" title="发表于 2026-02-03 11:14:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/eedaddf.html" title="博客笔记"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/4.png" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="博客笔记"/></a><div class="content"><a class="title" href="/posts/eedaddf.html" title="博客笔记">博客笔记</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5764bc58.html" title="饱了么前端"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/12.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="饱了么前端"/></a><div class="content"><a class="title" href="/posts/5764bc58.html" title="饱了么前端">饱了么前端</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2821e645.html" title="饱了么后端"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/11.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="饱了么后端"/></a><div class="content"><a class="title" href="/posts/2821e645.html" title="饱了么后端">饱了么后端</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Shelter</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><script src="/js/tw_cn.js?v=5.5.4"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://blog.dreamshelter.cn/twikooapi/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://blog.dreamshelter.cn/twikooapi/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script src="https://fastly.jsdelivr.net/npm/live2d-widgets@1.0.0/dist/autoload.js"></script><div class="aplayer no-destroy" data-id="17745883873" data-server="netease" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-autoplay="true" data-mutex="true"></div><script>function initAPlayerVolume(){setTimeout(function(){var a=document.querySelector(".aplayer");if(a&&a.aplayer){a.aplayer.volume(0.1);console.log("音量已设为10%")}},1500)}window.addEventListener("load",initAPlayerVolume);document.addEventListener("pjax:complete",initAPlayerVolume);</script><script id="canvas_nest" defer="defer" color="255,192,203" opacity="0" zIndex="-1" count="80" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"]):not([href=".aside-content"]):not([href="#aside-content"]):not([href=".card-clock"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      false
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><div id="app-refresh" style="position: fixed; top: -2.2rem; left: 0; right: 0; z-index: 99999; padding: 0 1rem; font-size: 15px; height: 2.2rem; transition: all 0.3s ease;"><div class="app-refresh-wrap" style="display: flex; color: #fff; height: 100%; align-items: center; justify-content: center;"><label>🚀 有新内容发布啦！</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color: #fff; text-decoration: underline; cursor: pointer; margin-left: 8px;">点击刷新</span></a></div></div><script>if ('serviceWorker' in navigator) {
  // 如果当前页面受 Service Worker 控制，监听控制权变化
  if (navigator.serviceWorker.controller) {
    navigator.serviceWorker.addEventListener('controllerchange', function() {
      showNotification();
    });
  }

  // 页面加载完成后注册 sw.js
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js').catch(err => {
      console.error('PWA 注册失败:', err);
    });
  });
}

function showNotification() {
  // 优先使用主题自带的 Snackbar 弹窗
  if (window.GLOBAL_CONFIG && GLOBAL_CONFIG.Snackbar) {
    var snackbarBg = document.documentElement.getAttribute('data-theme') === 'light' ?
      GLOBAL_CONFIG.Snackbar.bgLight :
      GLOBAL_CONFIG.Snackbar.bgDark;
    
    var snackbarPos = GLOBAL_CONFIG.Snackbar.position;

    Snackbar.show({
      text: '🚀 有新文章发布啦！',
      backgroundColor: snackbarBg,
      duration: 10000, // 持续 10 秒
      pos: snackbarPos,
      actionText: '点击刷新',
      actionTextColor: '#fff',
      onActionClick: function(e) {
        location.reload();
      },
    });
  } else {
    // 如果没有 Snackbar，则显示顶部的 app-refresh 栏
    var showBg = document.documentElement.getAttribute('data-theme') === 'light' ? '#49b1f5' : '#1f1f1f';
    var appRefresh = document.getElementById('app-refresh');
    if (appRefresh) {
      appRefresh.style.cssText = 'top: 0; background: ' + showBg + ';';
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索点什么呢………" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://vercelapi.dreamshelter.cn/api?user=shelter67";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="shelter67";
            var parent_div_git = document.getElementsByClassName('layout')[0];
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/gongxianban/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementsByClassName('layout')[0]){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><script data-pjax>
function hexo_butterfly_clock_remake_injector_config(){
  var parent_div_git;
  var item_html = `<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>`;

  // 按类型获取容器
  if ('class' === 'class') {
    parent_div_git = document.getElementsByClassName('aside-content')[0];
  } else if ('class' === 'id') {
    parent_div_git = document.getElementById('aside-content');
  } else {
    parent_div_git = document.getElementById('aside-content');
  }

  if(parent_div_git){
    var reference_el_before = null;
    var reference_el_after = parent_div_git.querySelector('.card-announcement');

    if(reference_el_before){
      parent_div_git.insertBefore(
        (function(){var temp = document.createElement('div'); temp.innerHTML = item_html; return temp;}()),
        reference_el_before
      );
    } else if(reference_el_after){
      reference_el_after.insertAdjacentHTML('afterend', item_html);
    } else {
      parent_div_git.insertAdjacentHTML('afterbegin', item_html);
    }
  }
}

console.log('已挂载 butterfly_clock_anzhiyu-yang 修复版');

// ---------- 全局变量声明 ----------
var cpage = location.pathname;
var epage = 'all';
var qweather_key = '0df3cf714a324957b16f3201e86fe931';
var qweather_api_host = 'https://p65ctvhqy4.re.qweatherapi.com';
var default_city = '';
var gaud_map_key = '296709bdb591a3523a2cf60e8e8f0ba3';

// ---------- 页面过滤 ----------
var elist = 'null'.split(',');
var flag = 0;
for(var i=0;i<elist.length;i++){
  if(cpage.includes(elist[i])) flag++;
}

if((epage === 'all') && (flag == 0)){
  hexo_butterfly_clock_remake_injector_config();
} else if(epage === cpage){
  hexo_butterfly_clock_remake_injector_config();
}
</script><script data-pjax src="/js/clock-min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementsByClassName('footer-other')[0];
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v8.1.1" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v5.5.4" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://cloud.tencent.com/" style="margin-inline:5px" data-title="本站由腾讯云提供服务器支持" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Server-Tencent%20Cloud-00A4FF?style=flat&amp;logo=qq&amp;logoColor=white" alt=""/></a><a class="github-badge" target="_blank" href="https://edgeone.ai/" style="margin-inline:5px" data-title="本站由腾讯云 EdgeOne 提供安全加速" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-EdgeOne-00A4FF?style=flat&amp;logo=iCloud&amp;logoColor=white" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn/" style="margin-inline:5px" data-title="工业和信息化部ICP备案管理系统" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E9%B2%81ICP%E5%A4%87-2025199346%E5%8F%B7--1-ba9132?style=flat&amp;labelColor=443d38" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="https://www.fomal.cc/static/js/runtime.js"></script><!-- hexo injector body_end end --></body></html>