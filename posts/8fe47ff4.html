<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><link rel=manifest href=/manifest.json><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>JDBC | Shelter</title><meta name="author" content="Shelter"><meta name="copyright" content="Shelter"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第01章 JDBC概述什么是JDBCJDBC（Java DataBase Connectivity）就是Java数据库连接，说白了就是用Java语言来操作数据库。原来我们操作数据库是在控制台使用SQL语句来操作数据库，JDBC是用Java语言向数据库发送SQL语句。  JDBC是一套连接数据库的api，什么是APi？就是平时所说的一套类库，通常包括三项：  API字节码（String.class）">
<meta property="og:type" content="article">
<meta property="og:title" content="JDBC">
<meta property="og:url" content="http://localhost:4000/posts/8fe47ff4.html">
<meta property="og:site_name" content="Shelter">
<meta property="og:description" content="第01章 JDBC概述什么是JDBCJDBC（Java DataBase Connectivity）就是Java数据库连接，说白了就是用Java语言来操作数据库。原来我们操作数据库是在控制台使用SQL语句来操作数据库，JDBC是用Java语言向数据库发送SQL语句。  JDBC是一套连接数据库的api，什么是APi？就是平时所说的一套类库，通常包括三项：  API字节码（String.class）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.dreamshelter.cn/blog/source/img/cover/3.png">
<meta property="article:published_time" content="2025-04-13T07:29:00.000Z">
<meta property="article:modified_time" content="2026-02-09T10:05:53.819Z">
<meta property="article:author" content="Shelter">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="jdbc">
<meta property="article:tag" content="sql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.dreamshelter.cn/blog/source/img/cover/3.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "JDBC",
  "url": "http://localhost:4000/posts/8fe47ff4.html",
  "image": "https://cdn.dreamshelter.cn/blog/source/img/cover/3.png",
  "datePublished": "2025-04-13T07:29:00.000Z",
  "dateModified": "2026-02-09T10:05:53.819Z",
  "author": [
    {
      "@type": "Person",
      "name": "Shelter",
      "url": "https://github.com/Shelter67"
    }
  ]
}</script><link rel="shortcut icon" href="https://cdn.dreamshelter.cn/blog/source/img/favicon.png"><link rel="canonical" href="http://localhost:4000/posts/8fe47ff4.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#49b1f5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/128.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="mask-icon" href="/img/siteicon/128.png" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":3,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JDBC',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><style>#waifu { left: auto !important; right: 20px !important; }</style><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/clock-min.css" /><link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.1.1"></head><body><div class="bg-animation" id="web_bg" style="background-image: url(https://cdn.dreamshelter.cn/blog/source/img/background.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/touxiang.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuifan.html"><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuiju.html"><i class="fa-fw fas fa-video"></i><span> 追剧</span></a></div><div class="menus_item"><a class="site-page" href="/gongxianban"><i class="fa-fw fab fa-github-alt"></i><span> 贡献板</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.dreamshelter.cn/blog/source/img/cover/3.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Shelter</span></a><a class="nav-page-title" href="/"><span class="site-name">JDBC</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuifan.html"><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuiju.html"><i class="fa-fw fas fa-video"></i><span> 追剧</span></a></div><div class="menus_item"><a class="site-page" href="/gongxianban"><i class="fa-fw fab fa-github-alt"></i><span> 贡献板</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">JDBC</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-13T07:29:00.000Z" title="发表于 2025-04-13 15:29:00">2025-04-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-09T10:05:53.819Z" title="更新于 2026-02-09 18:05:53">2026-02-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">21.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>81分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2026-02-09 18:05:53&quot;}" hidden></div><h1 id="第01章-JDBC概述"><a href="#第01章-JDBC概述" class="headerlink" title="第01章 JDBC概述"></a>第01章 JDBC概述</h1><h2 id="什么是JDBC"><a href="#什么是JDBC" class="headerlink" title="什么是JDBC"></a>什么是JDBC</h2><p>JDBC（Java DataBase Connectivity）就是Java数据库连接，说白了就是用Java语言来操作数据库。原来我们操作数据库是在控制台使用SQL语句来操作数据库，JDBC是用Java语言向数据库发送SQL语句。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402164726818.png" alt="image-20250402164726818"></p>
<p>JDBC是一套连接数据库的api，什么是APi？就是平时所说的一套类库，通常包括三项：</p>
<ul>
<li>API字节码（String.class）</li>
<li>API源码（String.java）</li>
<li>API帮助文档（String类的帮助文档）</li>
</ul>
<p>但是要注意查阅的版本要一致。</p>
<h2 id="JDBC原理"><a href="#JDBC原理" class="headerlink" title="JDBC原理"></a>JDBC原理</h2><p>早期SUN公司的天才们想编写一套可以连接天下所有数据库的API，但是当他们刚刚开始时就发现这是不可完成的任务，因为各个厂商的数据库服务器差异太大了。后来SUN开始与数据库厂商们讨论，最终得出的结论是，由SUN提供一套访问数据库的规范（就是一组接口），并提供连接数据库的协议标准，然后各个数据库厂商会遵循SUN的规范提供一套访问自己公司数据库服务器的API。SUN提供的规范命名为JDBC，而各个厂商提供的，遵循了JDBC规范的，可以访问自己数据库的API被称之为驱动！</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402170344437.png" alt="image-20250402170344437"></p>
<p>JDBC是接口，而JDBC驱动才是接口的实现，没有驱动无法完成数据库连接！每个数据库厂商都有自己的驱动，用来连接自己公司的数据库。<br>当然还有第三方公司专门为某一数据库提供驱动，这样的驱动往往不是开源免费的！</p>
<p>jdbc的本质：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/JDBC%E7%9A%84%E6%9C%AC%E8%B4%A8.png" alt="JDBC的本质"></p>
<h2 id="模拟JDBC接口"><a href="#模拟JDBC接口" class="headerlink" title="模拟JDBC接口"></a>模拟JDBC接口</h2><h3 id="模拟JDBC接口-1"><a href="#模拟JDBC接口-1" class="headerlink" title="模拟JDBC接口"></a>模拟JDBC接口</h3><p>Java中接口的作用主要有以下几个方面：</p>
<ol>
<li>定义标准：接口可以用于定义标准，规范应该如何完成某个任务或应该具有哪些属性、方法等。 </li>
<li>隐藏实现：接口隔离了类的实现和外界的逻辑使用，使得外部无论是访问接口的常量或是接口的方法都不需要关心接口的实现。 </li>
<li>实现多态：一个类实现多个接口，在实现接口的过程中，类便会具有接口中的所有方法。这样我们就可以在实际应用中方便的实现多态的效果。 </li>
<li>扩展性和灵活性：通过接口可以为项目提供更好的扩展性和灵活性，接口定义了一个共同的标准，使得新的类可以很容易地加入到已有的系统中，而且不需要修改现有的代码。</li>
</ol>
<p>总的来说，Java中的接口可以让我们通过规范来编写更加标准和灵活的代码，使得代码易于维护和扩展，并通过多态的特性来提高代码的重用性和可读性。**Java接口在使用场景中，一定是存在两个角色的，一个是接口的调用者，一个是接口的实现者，接口的出现让调用者和实现者解耦合了</p>
<h3 id="编写程序模拟JDBC接口"><a href="#编写程序模拟JDBC接口" class="headerlink" title="编写程序模拟JDBC接口"></a>编写程序模拟JDBC接口</h3><p><strong>接口的制定者</strong>：SUN公司负责制定的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SUN公司负责制定JDBC接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">JDBC</span> &#123;</span><br><span class="line">    <span class="comment">// 负责连接数据库的方法</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">getConnection</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>接口的实现者</strong>：各大数据库厂商分别对JDBC接口进行实现，实现类被称为<strong>驱动</strong><br>MySQL数据库厂商对JDBC接口的实现：MySQL驱动</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySQLDriver</span> <span class="keyword">implements</span> <span class="title class_">JDBC</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;与MySQL数据库连接建立成功，您正在操作MySQL数据库&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Oracle数据库厂商对JDBC接口的实现：Oracle驱动</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OracleDriver</span> <span class="keyword">implements</span> <span class="title class_">JDBC</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getConnection</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;与Oracle数据库连接建立成功，您正在操作Oracle数据库&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>接口的调用者</strong>：要操作数据库的Java程序员（我们）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">JDBC</span> <span class="variable">jdbc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MySQLDriver</span>();</span><br><span class="line">        <span class="type">JDBC</span> <span class="variable">jdbc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OracleDriver</span>();<span class="comment">//换成Oracle数据库</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 只需要面向接口编程即可，不需要关心具体的实现，不需要关心具体是哪个厂商的数据库</span></span><br><span class="line">        jdbc.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可能你会说，最终还是修改了java代码，不符合OCP原则呀，如果你想达到OCP，那可以将创建对象的任务交给反射机制，将类名配置到文件中，例如：<br>配置文件如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">MySQLDriver</span></span><br></pre></td></tr></table></figure>

<p>Java代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ResourceBundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">javaProgrammer</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">//读取jdbc.properties文件</span></span><br><span class="line">        <span class="comment">//ResourceBundle是资源绑定器，getString是获取key</span></span><br><span class="line">        <span class="type">ResourceBundle</span> <span class="variable">bundle</span> <span class="operator">=</span> ResourceBundle.getBundle(<span class="string">&quot;jdbc&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">driverClassName</span> <span class="operator">=</span> bundle.getString(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        <span class="comment">//String driverClassName = ResourceBundle.getBundle(&quot;jdbc&quot;).getString(&quot;driver&quot;);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//通过反射机制创建对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(driverClassName);</span><br><span class="line">        <span class="type">JDBC</span> <span class="variable">jdbc</span> <span class="operator">=</span> (JDBC)c.newInstance();<span class="comment">//不用泛型返回的是object，向下转型</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 只需要面向接口编程即可，不需要关心具体的实现，不需要关心具体是哪个厂商的数据库</span></span><br><span class="line">        jdbc.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JDBC的本质：它就是一套接口。</p>
<h2 id="配置CLASSPATH"><a href="#配置CLASSPATH" class="headerlink" title="配置CLASSPATH"></a>配置CLASSPATH</h2><h3 id="JDBC接口在哪"><a href="#JDBC接口在哪" class="headerlink" title="JDBC接口在哪"></a>JDBC接口在哪</h3><p>JDBC接口在JDK中。对应的包是：<strong>java.sql.*;</strong><br>JDBC API帮助文档就在JDK的帮助文档当中。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402192546822.png" alt="image-20250402192546822"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402192551502.png" alt="image-20250402192551502"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402192556358.png" alt="image-20250402192556358"></p>
<h3 id="驱动在哪"><a href="#驱动在哪" class="headerlink" title="驱动在哪"></a>驱动在哪</h3><p>打开页面：<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/connector/j/">https://dev.mysql.com/downloads/connector/j/</a></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402192624404.png" alt="image-20250402192624404"></p>
<p>解压：上图中的“mysql-connector-j-8.2.0.jar”就是mysql数据库的驱动，可以使用解压工具打开这个jar包</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402202217940.png" alt="image-20250402202217940"></p>
<p>可以看到这个jar包中都是xxx.class文件，这就是JDBC接口的实现类。这个jar包就是连接mysql数据库的驱动。如果是oracle的驱动就需要去oracle的官网下载了。这里不再赘述。</p>
<h3 id="如果使用文本编辑器开发"><a href="#如果使用文本编辑器开发" class="headerlink" title="如果使用文本编辑器开发"></a>如果使用文本编辑器开发</h3><p>如果使用文本编辑器开发，不使用集成开发环境的话，以上的jar包就需要手动配置到环境变量CLASSPATH当中，配置如下：<br>如果jar包放在这里：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402202245669.png" alt="image-20250402202245669"></p>
<p>就需要这样配置环境变量CLASSPATH：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402202257902.png" alt="image-20250402202257902"></p>
<p>注意：配置了这个目录路径就说明class文件会从这个jar包路径运行，如果默认的话是当前路径，就需要区分，用.来设置当前路径，用;来分开路径</p>
<h3 id="如果使用IDEA工具开发"><a href="#如果使用IDEA工具开发" class="headerlink" title="如果使用IDEA工具开发"></a>如果使用IDEA工具开发</h3><p>如果是采用集成开发工具，例如IDEA，就不需要手动配置CLASSPATH了，只需要将jar包放到IDEA中（实际上放到IDEA工具中的过程就是等同于在配置CLASSPATH）</p>
<p>第一步：创建lib目录，将jar包拷贝到lib目录</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402203157934.png" alt="image-20250402203157934"></p>
<p>第二步：把lib包引入项目环境</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402203201699.png" alt="image-20250402203201699"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250402203206669.png" alt="image-20250402203206669"></p>
<h1 id="第02章-JDBC的新增修改删除"><a href="#第02章-JDBC的新增修改删除" class="headerlink" title="第02章 JDBC的新增修改删除"></a>第02章 JDBC的新增修改删除</h1><h2 id="JDBC编程六步"><a href="#JDBC编程六步" class="headerlink" title="JDBC编程六步"></a>JDBC编程六步</h2><p>JDBC编程的步骤是很固定的，通常包含以下六步：</p>
<ul>
<li>第一步：注册驱动<ul>
<li>作用一：将 JDBC 驱动程序从硬盘上的文件系统中加载到内存中。</li>
<li>作用二：使得 DriverManager 可以通过一个统一的接口来管理该驱动程序的所有连接操作。</li>
</ul>
</li>
<li>第二步：获取数据库连接<ul>
<li>获取java.sql.Connection对象，该对象的创建标志着mysql进程和jvm进程之间的通道打开了。</li>
</ul>
</li>
<li>第三步：获取数据库操作对象<ul>
<li>获取java.sql.Statement对象，该对象负责将SQL语句发送给数据库，数据库负责执行该SQL语句。</li>
</ul>
</li>
<li>第四步：执行SQL语句<ul>
<li>执行具体的SQL语句，例如：insert delete update select等。</li>
</ul>
</li>
<li>第五步：处理查询结果集<ul>
<li>如果之前的操作是DQL查询语句，才会有处理查询结果集这一步。</li>
<li>执行DQL语句通常会返回查询结果集对象：java.sql.ResultSet。</li>
<li>对于ResultSet查询结果集来说，通常的操作是针对查询结果集进行结果集的遍历。</li>
</ul>
</li>
<li>第六步：释放资源<ul>
<li>释放资源可以避免资源的浪费。在 JDBC 编程中，每次使用完 Connection、Statement、ResultSet 等资源后，都需要显式地调用对应的 close() 方法来释放资源，避免资源的浪费。（有关闭顺序，从后往前关</li>
<li>释放资源可以避免出现内存泄露问题。在 Java 中，当一个对象不再被引用时，会被 JVM 的垃圾回收机制进行回收。但是在 JDBC 编程中，如果不显式地释放资源，那么这些资源就不会被 JVM 的垃圾回收机制自动回收，从而导致内存泄露问题。</li>
</ul>
</li>
</ul>
<h2 id="数据的准备"><a href="#数据的准备" class="headerlink" title="数据的准备"></a>数据的准备</h2><p>使用PowerDesigner设计用户表t_user。<br>使用Navicat for MySQL创建数据库，创建表，插入数据。</p>
<h3 id="PowerDesigner与Navicat-for-MySQL的区别"><a href="#PowerDesigner与Navicat-for-MySQL的区别" class="headerlink" title="PowerDesigner与Navicat for MySQL的区别"></a>PowerDesigner与Navicat for MySQL的区别</h3><p>Navicat for MySQL 是一款常用的 MySQL 数据库管理工具，提供了丰富的数据库管理和开发工具，可以方便地进行数据库的连接、查询、管理、模型设计等操作，是 MySQL 开发和管理的效率工具。</p>
<p>而 PowerDesigner 工具则是一款专业的建模工具，它支持多种数据库和操作系统，可以完成数据库设计、数据建模、过程建模、企业业务建模等工作。PowerDesigner 可以帮助开发人员在数据库设计和开发过程中更好地理解和管理数据，便于协同开发和项目管理。各种数据库技术的建模形式都可以实现，有单个数据库建模到多个数据库建模和业务建模等高级功能，<strong>非常适用于大型项目中的数据库设计和建模</strong>。同时，PowerDesigner 还支持 UML，Java 等编程语言的建模，可以与开发语言无缝整合。</p>
<p>因此，Navicat for MySQL 和 PowerDesigner 的功能是不同的，可以根据实际需要来选用。如果只是针对 MySQL 的数据库连接、查询、管理等操作，可以使用 Navicat for MySQL 工具，而如果需要进行更复杂的数据库设计、建模和整合等工作，可以使用 PowerDesigner 工具来实现。<strong>如果使用 MySQL 数据库进行开发，使用 Navicat for MySQL 和 PowerDesigner 这两个工具相互配合，可以提高开发效率和数据管理质量</strong>。</p>
<h3 id="PowerDesigner工具的安装"><a href="#PowerDesigner工具的安装" class="headerlink" title="PowerDesigner工具的安装"></a>PowerDesigner工具的安装</h3><p>来这里下载该工具：链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1lRWC069K8GE-8rxr259ArQ?pwd=2009">https://pan.baidu.com/s/1lRWC069K8GE-8rxr259ArQ?pwd=2009</a> 提取码：2009<br>双击安装包，选择香港，以及接受，替换文件，完成</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250404161430643.png" alt="image-20250404161430643"></p>
<h3 id="使用PowerDesigner进行物理数据建模"><a href="#使用PowerDesigner进行物理数据建模" class="headerlink" title="使用PowerDesigner进行物理数据建模"></a>使用PowerDesigner进行物理数据建模</h3><p><strong>什么是物理数据模型PDM？</strong><br>&#96;物理数据模型（Physical Data Model，PDM）是数据管理领域中表示数据库逻辑设计后，通过物理设计最终转化为实际数据结构的过程，即在逻辑模型的基础上，进行数据存储结构的设计。</p>
<p>注意：</p>
<ol>
<li>Name：用来设置显示的表名</li>
<li>Code：用来设置数据库中真实创建的表名</li>
<li>Comment：对表的注释说明</li>
</ol>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250404163131959.png" alt="image-20250404163131959"></p>
<p>从前往后是名字，真实表名，类型，长度，不知道，主键，不知道，是否为空。</p>
<p>双击这个1·会打开一个窗口，在comment里可以写注释，在preview里保存sql文件，打开数据库，新建数据库然后执行sql文件，就可以添加数据了</p>
<h2 id="JDBC完成新增操作"><a href="#JDBC完成新增操作" class="headerlink" title="JDBC完成新增操作"></a>JDBC完成新增操作</h2><p>新增操作就是让数据库执行insert语句。通过这个操作来学习一下JDBC编程的每一步。刚开始编写JDBC代码的时候，建议使用文本编辑器，先不借助任何IDE。</p>
<h3 id="JDBC编程第一步：注册驱动"><a href="#JDBC编程第一步：注册驱动" class="headerlink" title="JDBC编程第一步：注册驱动"></a>JDBC编程第一步：注册驱动</h3><p>注册驱动有两个作用：</p>
<ol>
<li>将 JDBC 驱动程序从硬盘上的文件系统中加载到内存。</li>
<li>让 DriverManager 可以通过一个统一的接口来管理该驱动程序的所有连接操作。</li>
</ol>
<p>API帮助文档：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250404171020290.png" alt="image-20250404171020290"></p>
<p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Driver;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1. 注册驱动</span></span><br><span class="line">            <span class="comment">// driver是继承了java.sql.Driver</span></span><br><span class="line">            <span class="comment">// com.mysql.cj.jdbc.Driver是mysql驱动最核心的类</span></span><br><span class="line"></span><br><span class="line">            <span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.mysql.cj.jdbc.Driver(); <span class="comment">// 创建MySQL驱动对象</span></span><br><span class="line">            <span class="comment">//第二种写法：java.sql.Driver driver = new com.mysql.cj.jdbc.Driver();</span></span><br><span class="line">            <span class="comment">//第三种写法：java.sql.Driver drive = new Driver();import com.mysql.cj.jdbc.Driver;</span></span><br><span class="line">            DriverManager.registerDriver(driver); <span class="comment">// 完成驱动注册，也可以和上面的合并</span></span><br><span class="line">             <span class="comment">// 2. 获取连接，代码看后面的</span></span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="JDBC编程第二步：获取连接"><a href="#JDBC编程第二步：获取连接" class="headerlink" title="JDBC编程第二步：获取连接"></a>JDBC编程第二步：获取连接</h3><p>获取java.sql.Connection对象，该对象的创建标志着mysql进程和jvm进程之间的通道打开了。</p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. 获取连接</span></span><br><span class="line">           <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/jdbc&quot;</span>;<span class="comment">//jdbc:mysql是协议，localhost是ip，3306是端口，jdbc是数据库</span></span><br><span class="line">           <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">           <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">           <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">		<span class="comment">//返回的Connection是个接口，运行后的结果是com.mysql.cj.jdbc.ConnectionImpl@489115ef</span></span><br><span class="line">		<span class="comment">//解释：com.mysql.cj.jdbc.ConnectionImpl是Mysql数据库厂家对java.sql.Connection接口的实现</span></span><br><span class="line">		<span class="comment">//java.sql.Connection是sun制定的接口，com.mysql.cj.jdbc.ConnectionImpl是该接口的实现类</span></span><br><span class="line">		<span class="comment">//注意：不需要关心具体的实现类是谁，我们只需要面向JDBC接口编写代码即可</span></span><br><span class="line"></span><br><span class="line">           System.out.println(<span class="string">&quot;连接对象：&quot;</span> + conn);</span><br></pre></td></tr></table></figure>

<h3 id="JDBC编程第三步：获取数据库操作对象"><a href="#JDBC编程第三步：获取数据库操作对象" class="headerlink" title="JDBC编程第三步：获取数据库操作对象"></a>JDBC编程第三步：获取数据库操作对象</h3><p>数据库操作对象是这个接口：java.sql.Statement。这个对象负责将SQL语句发送给数据库服务器，服务器接收到SQL后进行编译，然后执行SQL。</p>
<p>获取数据库操作对象代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Statement; </span><br><span class="line"><span class="comment">// 3. 获取数据库操作对象</span></span><br><span class="line">            <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">            System.out.println(<span class="string">&quot;数据库操作对象stmt = &quot;</span> + stmt);</span><br><span class="line">			</span><br><span class="line">			<span class="type">Statement</span> <span class="variable">stmt2</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">            System.out.println(<span class="string">&quot;数据库操作对象stmt = &quot;</span> + stmt);<span class="comment">//可以创建多个对象</span></span><br></pre></td></tr></table></figure>

<p>执行结果如下：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250405030709305.png" alt="image-20250405030709305"></p>
<p>同样可以看到：java.sql.Statement接口在MySQL驱动中的实现类是：com.mysql.cj.jdbc.StatementImpl。不过我们同样是不需要关心这个具体的实现类。因为后续的代码仍然是面向Statement接口写代码的。</p>
<h3 id="JDBC编程第四步：执行SQL"><a href="#JDBC编程第四步：执行SQL" class="headerlink" title="JDBC编程第四步：执行SQL"></a>JDBC编程第四步：执行SQL</h3><p>当获取到Statement对象后，调用这个接口中的相关方法即可执行SQL语句。通过execute(String sql)返回布尔值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. 执行SQL语句</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_user(name,password,realname,gender,tel) values(&#x27;tangsanzang&#x27;,&#x27;123&#x27;,&#x27;唐三藏&#x27;,&#x27;男&#x27;,&#x27;12566568956&#x27;);&quot;</span>; <span class="comment">// sql语句最后的分号&#x27;;&#x27;可以不写。</span></span><br><span class="line">			<span class="comment">//返回值的含义：当sql语句是一个DQL语句的时候，并且查询到了结果，返回true</span></span><br><span class="line">			<span class="comment">//当sql语句是dml语句或者没有查询到任何结果的时候，返回false。这个方法功能比较广泛（不够专业），适合所有的sql语句，很少用</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> stmt.execute(sql);</span><br><span class="line">            System.out.println(isSuccess ? <span class="string">&quot;插入失败&quot;</span> : <span class="string">&quot;插入成功&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>API帮助文档如下：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250405032249566.png" alt="image-20250405032249566"></p>
<p>返回1表示1条数据插入成功，返回2表示2条数据插入成功，以此类推。如果一条也没有插入，则返回0。</p>
<p>该方法适合执行的SQL语句是DML，包括：insert delete update。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. 执行SQL语句</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_user(name,password,realname,gender,tel) values(&#x27;tangsanzang&#x27;,&#x27;123&#x27;,&#x27;唐三藏&#x27;,&#x27;男&#x27;,&#x27;12566568956&#x27;)&quot;</span>; <span class="comment">// sql语句最后的分号&#x27;;&#x27;可以不写。</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> stmt.executeUpdate(sql);</span><br><span class="line">            System.out.println(<span class="string">&quot;插入了&quot;</span> + count + <span class="string">&quot;条记录&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="JDBC编程第六步：释放资源"><a href="#JDBC编程第六步：释放资源" class="headerlink" title="JDBC编程第六步：释放资源"></a>JDBC编程第六步：释放资源</h3><p>第五步去哪里了？第五步是处理查询结果集，以上操作不是select语句，所以第五步直接跳过，直接先看一下第六步释放资源。【后面学习查询语句的时候，再详细看第五步】</p>
<h4 id="为什么要释放资源"><a href="#为什么要释放资源" class="headerlink" title="为什么要释放资源"></a>为什么要释放资源</h4><p>在 JDBC 编程中，建立数据库连接、创建 Statement 对象等操作都需要申请系统资源，例如打开网络端口、申请内存等。为了避免占用过多的系统资源和避免出现内存泄漏等问题，我们需要在使用完资源后及时释放它们。</p>
<h4 id="释放资源的原则"><a href="#释放资源的原则" class="headerlink" title="释放资源的原则"></a>释放资源的原则</h4><p>原则1：在finally语句块中释放</p>
<ul>
<li>建议在finally语句块中释放，因为程序执行过程中如果出现了异常，finally语句块中的代码是一定会执行的。也就是说：我们需要保证程序在执行过程中，不管是否出现了异常，最后的关闭是一定要执行的。当然了，也可以使用Java7的新特性：Try-with-resources。Try-with-resources 是 Java 7 引入的新特性。它简化了资源管理的代码实现，可以自动释放资源，减少了代码出错的可能性，同时也可以提供更好的代码可读性和可维护性。</li>
</ul>
<p>原则2：释放有顺序</p>
<ul>
<li>从小到大依次释放，创建的时候，先创建Connection，再创建Statement。那么关闭的时候，先关闭Statement，再关闭Connection。</li>
</ul>
<p>原则3：分别进行try…catch…</p>
<ul>
<li>关闭的时候调用close()方法，该方法有异常需要处理，建议分别对齐try…catch…进行异常捕获。如果只编写一个try…catch…进行一块捕获，在关闭过程中，如果某个关闭失败，会影响下一个资源的关闭。</li>
</ul>
<h4 id="代码如何实现"><a href="#代码如何实现" class="headerlink" title="代码如何实现"></a>代码如何实现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">           <span class="comment">// 6. 释放资源</span></span><br><span class="line">    		<span class="comment">// 原则：从小到大按照这个顺序关闭</span></span><br><span class="line">    		<span class="comment">// 关闭前最好判断一下是否为空</span></span><br><span class="line">    		<span class="comment">// 分别对其进行try...catch</span></span><br><span class="line">           <span class="keyword">if</span>(stmt != <span class="literal">null</span>)&#123;</span><br><span class="line">               <span class="keyword">try</span>&#123;</span><br><span class="line">                   stmt.close();<span class="comment">//注意stmt是局部变量要改一下</span></span><br><span class="line">               &#125;<span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">if</span>(conn != <span class="literal">null</span>)&#123;</span><br><span class="line">               <span class="keyword">try</span>&#123;</span><br><span class="line">                   conn.close();</span><br><span class="line">               &#125;<span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<h3 id="什么是URL"><a href="#什么是URL" class="headerlink" title="什么是URL"></a>什么是URL</h3><p>URL 是统一资源定位符 (Uniform Resource Locator) 的缩写，是互联网上标识、定位、访问资源的字符串。它可以用来指定互联网上各种类型的资源的位置，如网页、图片、视频等。</p>
<p>URL 通常由协议、服务器名、服务器端口、路径和查询字符串组成。其中：</p>
<ul>
<li>协议是规定了访问资源所采用的通信协议，例如 HTTP、HTTPS、FTP 等；</li>
<li>服务器名是资源所在的服务器主机名或 IP 地址，可以是域名或 IP 地址；</li>
<li>服务器端口是资源所在的服务器的端口号；</li>
<li>路径是资源所在的服务器上的路径、文件名等信息；</li>
<li>查询字符串是向服务器提交的参数信息，用来定位更具体的资源。</li>
</ul>
<p>URL 在互联网中广泛应用，比如在浏览器中输入 URL 来访问网页或下载文件，在网站开发中使用 URL 来访问 API 接口或文件，在移动应用和桌面应用中使用 URL 来访问应用内部的页面或功能，在搜索引擎中使用 URL 来爬取网页内容等等。</p>
<p>总之，URL 是互联网上所有资源的唯一识别标识，是互联网通信的基础和核心技术之一。<br><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg"></p>
<h3 id="JDBC连接MySQL时的URL格式"><a href="#JDBC连接MySQL时的URL格式" class="headerlink" title="JDBC连接MySQL时的URL格式"></a>JDBC连接MySQL时的URL格式</h3><p>JDBC URL 是在使用 JDBC 连接数据库时的一个 URL 字符串，它用来标识要连接的数据库的位置、认证信息和其他配置参数等。JDBC URL 的格式可以因数据库类型而异，但通常包括以下几个部分：</p>
<ul>
<li>协议：表示要使用的数据库管理系统（DBMS）的类型，如 <code>jdbc:mysql</code> 表示要使用 MySQL 数据库，<code>jdbc:postgresql</code> 表示要使用 PostgreSQL 数据库。</li>
<li>主机地址和端口号：表示要连接的数据库所在的服务器的 IP 地址或域名，以及数据库所在服务器监听的端口号。</li>
<li>数据库名称：表示要连接的数据库的名称。</li>
<li>其他可选参数：这些参数包括连接的超时时间、使用的字符集、连接池相关配置等。</li>
</ul>
<p>例如，连接 MySQL 数据库的 JDBC URL 的格式一般如下：可以在?后面加用户名密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql://&lt;host&gt;:&lt;port&gt;/&lt;database_name&gt;?&lt;connection_parameters&gt;</span><br></pre></td></tr></table></figure>

<p>其中：</p>
<ul>
<li><code>&lt;host&gt;</code> 是 MySQL 数据库服务器的主机名或 IP 地址；</li>
<li><code>&lt;port&gt;</code> 是 MySQL 服务器的端口号（默认为 3306）；</li>
<li><code>&lt;database_name&gt;</code> 是要连接的数据库名称；</li>
<li><code>&lt;connection_parameters&gt;</code> 包括连接的额外参数，例如用户名、密码、字符集等。</li>
</ul>
<p>JDBC URL 是连接数据库的关键，通过 JDBC URL，应用程序可以通过特定的 JDBC 驱动程序与数据库服务器进行通信，从而实现与数据库的交互。在开发 Web 应用和桌面应用时，使用 JDBC URL 可以轻松地连接和操作各种类型的数据库，例如 MySQL、PostgreSQL、Oracle 等。</p>
<p>以下是一个常见的JDBC MySQL URL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql://localhost:3306/jdbc</span><br></pre></td></tr></table></figure>

<p><code>jdbc:mysql://</code>是协议<br><code>localhost</code>表示连接本地主机的MySQL数据库，也可以写作<code>127.0.0.1</code><br><code>3306</code>是MySQL数据库的端口号<br><code>jdbc</code>是数据库实例名</p>
<h3 id="MySQL-URL中的其它常用配置"><a href="#MySQL-URL中的其它常用配置" class="headerlink" title="MySQL URL中的其它常用配置"></a>MySQL URL中的其它常用配置</h3><p>在 JDBC MySQL URL 中，常用的配置参数有：</p>
<ul>
<li><code>serverTimezone</code>：MySQL 服务器时区，默认为 UTC，可以通过该参数来指定客户端和服务器的时区；</li>
</ul>
<p>在 JDBC URL 中设置 <code>serverTimezone</code> 的作用是指定数据库服务器的时区。这个时区信息会影响 JDBC 驱动在处理日期时间相关数据类型时如何将其映射到服务器上的日期时间值。<br><strong>如果不设置 <code>serverTimezone</code>，则 JDBC 驱动程序默认将使用本地时区，也就是客户端机器上的系统时区，来处理日期时间数据</strong>。在这种情况下，如果服务器的时区和客户端机器的时区不同，那么处理日期时间数据时可能会出现问题，从而导致数据错误或不一致。<br>例如，假设服务器位于美国加州，而客户端位于中国上海，如果不设置 <code>serverTimezone</code> 参数，在客户端执行类似下面的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> order_date <span class="operator">=</span> <span class="string">&#x27;2022-11-11&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>由于客户端和服务器使用了不同的时区，默认使用的是客户端本地的时区，那么实际查询的时间就是客户端本地时间对应的时间，而不是服务器的时间。这可能会导致查询结果不正确，因为服务器上的时间可能是比客户端慢或者快了多个小时。<br>通过在 JDBC URL 中设置 <code>serverTimezone</code> 参数，可以明确告诉 JDBC 驱动程序使用哪个时区来处理日期时间值，从而避免这种问题。在上述例子中，如果把时区设置为 <code>America/Los_Angeles</code>（即加州的时区）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql://localhost:3306/mydatabase?user=myusername&amp;password=mypassword&amp;serverTimezone=America/Los_Angeles</span><br></pre></td></tr></table></figure>

<p>那么上面的查询就会在数据库服务器上以加州的时间来执行，结果更加准确。</p>
<ul>
<li><code>useSSL</code>：是否使用 SSL 进行连接，默认为 true；</li>
</ul>
<p><code>useSSL</code> 参数用于配置是否使用 SSL（Secure Sockets Layer）安全传输协议来加密 JDBC 和 MySQL 数据库服务器之间的通信。其设置为 <code>true</code> 表示使用 SSL 连接，设置为 <code>false</code> 表示不使用 SSL 连接。其区别如下：</p>
<p>当设置为 <code>true</code> 时，JDBC 驱动程序将使用 SSL <strong>加密协议来保障客户端和服务器之间的通信安全</strong>。这种方式下，所有数据都会使用 SSL 加密后再传输，可以有效防止数据在传输过程中被窃听、篡改等安全问题出现。当然，也要求服务器端必须支持 SSL，否则会连接失败。</p>
<p>当设置为 <code>false</code> 时，JDBC 驱动程序会以明文方式传输数据，这种方式下，虽然数据传输的速度会更快，但也会存在被恶意攻击者截获和窃听数据的风险。因此，在不安全的网络环境下，或是要求数据传输安全性较高的情况下，建议使用 SSL 加密连接。</p>
<p>需要注意的是，使用 **SSL 连接会对系统资源和性能消耗有一定的影响，特别是当连接数较多时，对 CPU 和内存压力都比较大。**因此，在性能和安全之间需要权衡，根据实际应用场景合理设置 <code>useSSL</code> 参数。</p>
<ul>
<li>useUnicode：是否使用Unicode编码进行数据传输，默认是true启用</li>
</ul>
<p><code>useUnicode</code>是 JDBC 驱动程序连接数据库时的一个参数，用于告诉驱动程序在传输数据时是否使用 Unicode 编码。主要是为了跨平台</p>
<p>具体地说，如果设置 <code>useUnicode=true</code>，JDBC 驱动程序会在传输数据时使用 Unicode 编码。这意味着，无论数据源中使用的是什么编码方案，都会先将数据转换为 Unicode 编码进行传输，确保数据能够跨平台、跨数据库正确传输。当从数据库中获取数据时，驱动程序会根据 <code>characterEncoding</code> 参数指定的字符集编码将数据转换为指定编码格式，以便应用程序正确处理数据。</p>
<p>需要注意的是，如果设置 <code>useUnicode=false</code>，则表示使用当前平台默认的字符集进行数据传输。这可能会导致在跨平台或跨数据库时出现字符编码不一致的问题，因此通常建议在进行数据传输时启用 Unicode 编码。</p>
<ul>
<li><code>characterEncoding</code>：连接使用的字符编码，默认为 UTF-8；</li>
</ul>
<p><code>characterEncoding</code> 参数用于设置 MySQL 服务器和 JDBC 驱动程序之间进行字符集转换时使用的字符集编码。其设置为 <code>UTF-8</code> 表示使用 UTF-8 编码进行字符集转换，设置为 <code>GBK</code> 表示使用 GBK 编码进行字符集转换。其区别如下：<br>UTF-8 编码是一种可变长度的编码方式，可以表示世界上的所有字符，包括 ASCII、Unicode 和不间断空格等字符，是一种通用的编码方式。UTF-8 编码在国际化应用中被广泛使用，并且其使用的字节数较少，有利于提高数据传输的效率和节约存储空间。</p>
<p><strong>注意：useUnicode和characterEncoding有什么区别？</strong></p>
<ul>
<li><strong>useUnicode设置的是数据在传输过程中是否使用Unicode编码方式。</strong></li>
<li><strong>characterEncoding设置的是数据被传输到服务器之后，服务器采用哪一种字符集进行编码。</strong></li>
</ul>
<p>例如，连接 MySQL 数据库的 JDBC URL 可以如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql://localhost:3306/jdbc?useUnicode=true&amp;serverTimezone=Asia/Shanghai&amp;useSSL=true&amp;characterEncoding=utf-8</span><br></pre></td></tr></table></figure>

<p>这里演示的是使用本地 MySQL 数据库，使用Unicode编码进行数据传输，服务器时区为 Asia&#x2F;Shanghai，启用 SSL 连接，服务器接收到数据后使用 UTF-8 编码。</p>
<h2 id="注册驱动的常用方式"><a href="#注册驱动的常用方式" class="headerlink" title="注册驱动的常用方式"></a>注册驱动的常用方式</h2><p>上面在注册驱动的时候，执行了这样的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.sql.<span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.mysql.cj.jdbc.Driver();</span><br><span class="line">java.sql.DriverManager.registerDriver(driver);</span><br></pre></td></tr></table></figure>

<p>这种方式是自己new驱动对象，然后调用DriverManager的registerDriver()方法来完成驱动注册，还有另一种方式，并且这种方式是常用的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>为什么这种方式常用？</p>
<ul>
<li>第一：代码少了很多。</li>
<li>第二：这种方式可以很方便的将<code>com.mysql.cj.jdbc.Driver</code>类名配置到属性文件当中。</li>
</ul>
<p>实现原理是什么？找一下<code>com.mysql.cj.jdbc.Driver</code>的源码：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250406151334165.png" alt="image-20250406151334165"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250406151348702.png" alt="image-20250406151348702"></p>
<p>在<code>com.mysql.cj.jdbc.Driver</code>类中有一个静态代码块，在这个静态代码块中调用了<code>java.sql.DriverManager.registerDriver(new Driver());</code>完成了驱动的注册。而<code>Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</code>代码的作用就是让<code>com.mysql.cj.jdbc.Driver</code>类完成加载，执行它的静态代码块。</p>
<p>这样写也主要是为了方便在配置文件里改动，而不是写死在代码里</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	注册驱动的第二种方式：常用的。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest04</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">		<span class="comment">// 注册驱动</span></span><br><span class="line">		<span class="comment">// 第一种方式</span></span><br><span class="line">		<span class="comment">//Driver driver = new com.mysql.cj.jdbc.Driver();</span></span><br><span class="line">		<span class="comment">//DriverManager.registerDriver(driver);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 第二种方式</span></span><br><span class="line">		<span class="comment">// 本质上和第一种方式还是相同的。</span></span><br><span class="line">		<span class="comment">// 因为以下代码在执行的时候，会将com.mysql.cj.jdbc.Driver进行类加载。</span></span><br><span class="line">		<span class="comment">// 类加载的时候会执行 com.mysql.cj.jdbc.Driver 类中的静态代码块。</span></span><br><span class="line">		<span class="comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取连接</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/jdbc?useUnicode=true&amp;serverTimezone=Asia/Shanghai&amp;useSSL=true&amp;characterEncoding=utf-8&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;1234&quot;</span>;</span><br><span class="line">		<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">		System.out.println(conn);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个com.mysql.cj.jdbc.Driver类中的静态代码块如下：</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    static &#123;</span></span><br><span class="line"><span class="comment">        try &#123;</span></span><br><span class="line"><span class="comment">            java.sql.DriverManager.registerDriver(new Driver());</span></span><br><span class="line"><span class="comment">        &#125; catch (SQLException E) &#123;</span></span><br><span class="line"><span class="comment">            throw new RuntimeException(&quot;Can&#x27;t register driver!&quot;);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h2 id="JDBC-4-0后不用手动注册驱动（了解）"><a href="#JDBC-4-0后不用手动注册驱动（了解）" class="headerlink" title="JDBC 4.0后不用手动注册驱动（了解）"></a>JDBC 4.0后不用手动注册驱动（了解）</h2><p>从JDBC 4.0（<strong>也就是Java6</strong>）版本开始，驱动的注册不需要再手动完成，由系统自动完成。</p>
<p>也就是第一步可以不用写了。</p>
<p><strong>注意：虽然大部分情况下不需要进行手动注册驱动了，但在实际的开发中有些数据库驱动程序不支持自动发现功能，仍然需要手动注册。所以建议大家还是别省略了。</strong></p>
<h2 id="IDEA创建JDBK"><a href="#IDEA创建JDBK" class="headerlink" title="IDEA创建JDBK"></a>IDEA创建JDBK</h2><p>先新建一个project，然后点file里的<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250406184622739.png" alt="image-20250406184622739">设置一下jdk版本为21</p>
<p>然后新建一个目录<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250406184952984.png" alt="image-20250406184952984">，写上lib，然后把jdbc的jar包复制，选中lib粘贴就进去了，选中这个jar包右击有个add as library就添加进去了</p>
<h2 id="动态配置连接数据库的信息"><a href="#动态配置连接数据库的信息" class="headerlink" title="动态配置连接数据库的信息"></a>动态配置连接数据库的信息</h2><p>为了程序的通用性，为了切换数据库的时候不需要修改Java程序，为了符合OCP开闭原则，建议将连接数据库的信息配置到属性文件中，例如：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/jdbc?useUnicode=true&amp;serverTimezone=Asia/Shanghai&amp;useSSL=true&amp;characterEncoding=utf-8</span></span><br><span class="line"><span class="attr">user</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure>

<p>然后使用IO流读取属性文件，动态获取连接数据库的信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//读取属性配置文件，获取连接数据库信息</span></span><br><span class="line">        <span class="type">ResourceBundle</span> <span class="variable">bundle</span> <span class="operator">=</span> ResourceBundle.getBundle(<span class="string">&quot;com.powernode.jdbc.jdbc01&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> bundle.getString(<span class="string">&quot;driver&quot;</span>);<span class="comment">//这些是读取配置</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> bundle.getString(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> bundle.getString(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> bundle.getString(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1.注册驱动</span></span><br><span class="line">            Class.forName(driver);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2.获取连接</span></span><br><span class="line">            conn = DriverManager.getConnection(url, user, password);<span class="comment">//这个是发送读取到的信息</span></span><br><span class="line">            System.out.println(conn);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    conn.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="获取连接的其他方式（了解）"><a href="#获取连接的其他方式（了解）" class="headerlink" title="获取连接的其他方式（了解）"></a>获取连接的其他方式（了解）</h2><p>上面我们讲到了第一种获取连接的方式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br></pre></td></tr></table></figure>

<h3 id="getConnection-String-url"><a href="#getConnection-String-url" class="headerlink" title="getConnection(String url)"></a>getConnection(String url)</h3><p>这种方式参数只有一个url，那用户名和密码放在哪里呢？可以放到url当中，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getConnection(url)</span></span><br><span class="line">      Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/jdbc?user=root&amp;password=liuqi3711022&amp;useUnicode=true&amp;serverTimezone=Asia/Shanghai&amp;useSSL=true&amp;characterEncoding=utf-8&quot;</span>;</span><br><span class="line">      <span class="comment">//jdbc?user=root&amp;password=liuqi3711022密码写到这里面了</span></span><br><span class="line">      <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url);</span><br><span class="line">      System.out.println(conn);</span><br></pre></td></tr></table></figure>

<h3 id="getConnection-String-url-Properties-info"><a href="#getConnection-String-url-Properties-info" class="headerlink" title="getConnection(String url, Properties info)"></a>getConnection(String url, Properties info)</h3><p>这种方式有两个参数，一个是url，一个是Properties对象。</p>
<ul>
<li>url：可以单纯提供一个url地址</li>
<li>info：可以将url的参数存放到该对象中</li>
</ul>
<p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getConnection(url, info)</span></span><br><span class="line">       Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">       <span class="comment">// url</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/jdbc&quot;</span>;</span><br><span class="line">       <span class="comment">// info</span></span><br><span class="line">       <span class="type">Properties</span> <span class="variable">info</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">       info.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">       info.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;1234&quot;</span>);</span><br><span class="line">       info.setProperty(<span class="string">&quot;useUnicode&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">       info.setProperty(<span class="string">&quot;serverTimezone&quot;</span>, <span class="string">&quot;Asia/Shanghai&quot;</span>);</span><br><span class="line">       info.setProperty(<span class="string">&quot;useSSL&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">       info.setProperty(<span class="string">&quot;characterEncoding&quot;</span>, <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, info);</span><br><span class="line">       System.out.println(<span class="string">&quot;====&gt;&quot;</span> + conn);</span><br></pre></td></tr></table></figure>

<h1 id="第03章-JDBC的查询"><a href="#第03章-JDBC的查询" class="headerlink" title="第03章 JDBC的查询"></a>第03章 JDBC的查询</h1><h2 id="JDBC的查询操作"><a href="#JDBC的查询操作" class="headerlink" title="JDBC的查询操作"></a>JDBC的查询操作</h2><p>ResultSet 是 JDBC （Java 数据库连接） API 提供的接口，它用于表示 SQL 查询的结果集。ResultSet 对象中包含了查询结果的所有行，可以通过 next() 方法逐行地获取并处理每一行的数据。它最常用于执行 SELECT 语句查询出来的结果集。</p>
<p>ResultSet 的遍历是基于 JDBC 的流式处理机制的，即一行一行地获取结果，避免将所有结果全部取出后再进行处理导致内存溢出问题。</p>
<p>在使用完 ResultSet 对象之后，需要及时关闭它，有正确关闭它们的话，可能会导致数据库连接过多，从而影响系统的稳定性和性能。</p>
<h3 id="通过列索引获取数据（以String类型获取）"><a href="#通过列索引获取数据（以String类型获取）" class="headerlink" title="通过列索引获取数据（以String类型获取）"></a>通过列索引获取数据（以String类型获取）</h3><p>代码：jdbcTest03’</p>
<p>执行insert delete update语句的时候，调用Statement接口的executeUpdate()方法。<br>执行select语句的时候，<strong>调用Statement接口的executeQuery()方法</strong>。执行select语句后返回结果集对象：ResultSet。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4.执行sql</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select realname,id,name,password from t_user&quot;</span>;</span><br><span class="line">        rs = stmt.executeQuery(sql);<span class="comment">//query是查询的意思</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5.处理查询结果集</span></span><br><span class="line">        <span class="comment">//这里的处理方式是直接打印输出</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        +----------+----+----------+----------+</span></span><br><span class="line"><span class="comment">        | realname | id | name     | password |</span></span><br><span class="line"><span class="comment">        +----------+----+----------+----------+</span></span><br><span class="line"><span class="comment">        | 张三     |  1 | zhangsan | 123      |</span></span><br><span class="line"><span class="comment">        | 管理员   |  2 | admin    | admin123 |</span></span><br><span class="line"><span class="comment">        +----------+----+----------+----------+</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">         </span><br><span class="line">          <span class="comment">//写成循环</span></span><br><span class="line">        <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">            <span class="comment">// 取出当前光标指向的这一行的数据</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> rs.getString(<span class="number">1</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> rs.getString(<span class="number">2</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> rs.getString(<span class="number">3</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">s4</span> <span class="operator">=</span> rs.getString(<span class="number">4</span>);</span><br><span class="line">            System.out.println(s1 + <span class="string">&quot;\t&quot;</span> + s2 + <span class="string">&quot;\t&quot;</span> + s3 + <span class="string">&quot;\t&quot;</span> + s4);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>rs.next() 将游标移动到下一行，如果移动后指向的这一行有数据则返回true，没有数据则返回false。</strong></p>
</li>
<li><p><strong>while循环体当中的代码是处理当前游标指向的这一行的数据。（注意：是处理的一行数据）</strong></p>
</li>
<li><p><strong>rs.getString(int columnIndex) 其中 int columnIndex 是查询结果的列下标，列下标从1开始，以1递增。</strong></p>
</li>
<li><p>rs.getString(…) 方法在执行时，不管底层数据库中的数据类型是什么，统一以字符串String类型来获取。</p>
</li>
</ul>
<p>ResultSet最终也是需要关闭的。<strong>先关闭ResultSet，再关闭Statement，最后关闭Connection</strong>。</p>
<h3 id="通过列名获取数据（以String类型获取）"><a href="#通过列名获取数据（以String类型获取）" class="headerlink" title="通过列名获取数据（以String类型获取）"></a>通过列名获取数据（以String类型获取）</h3><p>获取当前行的数据，不仅可以通过列下标获取，还可以通过查询结果的列名来获取，通常这种方式是被推荐的，因为可读性好。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询所有员工信息</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql3</span> <span class="operator">=</span> <span class="string">&quot;select empno a, ename b, sal c from emp&quot;</span>;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            +------+--------+---------+</span></span><br><span class="line"><span class="comment">            | a    | b      | c       |</span></span><br><span class="line"><span class="comment">            +------+--------+---------+</span></span><br><span class="line"><span class="comment">            | 7369 | SMITH  |  800.00 |</span></span><br><span class="line"><span class="comment">            | 7499 | ALLEN  | 1600.00 |</span></span><br><span class="line"><span class="comment">            | 7521 | WARD   | 1250.00 |</span></span><br><span class="line"><span class="comment">                  */</span></span><br><span class="line">rs = stmt.executeQuery(sql3);</span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">empno</span> <span class="operator">=</span> rs.getInt(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">                <span class="comment">// 报错，原因：这是因为查询结果集中没有empno这个列。只有a这个列。</span></span><br><span class="line">                <span class="comment">// 要以最终的查询结果的那个列为准，不是表格中字段的名字</span></span><br><span class="line">                <span class="comment">//int empno = rs.getInt(&quot;empno&quot;);</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">sal</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">                System.out.println(empno + <span class="string">&quot;,&quot;</span> + ename + <span class="string">&quot;,&quot;</span> + sal);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>注意：是根据查询结果的列名，而不是表中的列名。以上查询的时候将字段起别名abc了，所以要根据abc来获取，而不能再根据以前的来获取了。</p>
<h3 id="以指定的类型获取数据"><a href="#以指定的类型获取数据" class="headerlink" title="以指定的类型获取数据"></a>以指定的类型获取数据</h3><p>前面的程序可以看到，不管数据库表中是什么数据类型，都以String类型返回。当然，也能以指定类型返回。</p>
<p>使用PowerDesigner再设计一张商品表：t_product，使用Navicat for MySQL工具准备数据如下：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250408173045702.png" alt="image-20250408173045702"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250408173051223.png" alt="image-20250408173051223"></p>
<p>id以long类型获取，name以String类型获取，price以double类型获取，create_time以java.sql.Date类型获取，代码如下：</p>
<p>createTime.getTime()是获取到毫秒级</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4.执行sql语句</span></span><br><span class="line">           <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,name,price,create_time from t_product&quot;</span>;</span><br><span class="line">           rs = stmt.executeQuery(sql);</span><br><span class="line">           <span class="comment">// 5.处理查询结果集</span></span><br><span class="line">           <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy年MM月dd日&quot;</span>);</span><br><span class="line">           <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">               <span class="comment">// 以特定的类型获取数据</span></span><br><span class="line">               <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> rs.getLong(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">               <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">               <span class="type">double</span> <span class="variable">price</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;price&quot;</span>);</span><br><span class="line">               <span class="comment">// 注意：从mysql数据库当中获取的日期类型的数据对应的java类型是：java.sql.Date。不是java.util.Date。</span></span><br><span class="line">               <span class="type">Date</span> <span class="variable">createTime</span> <span class="operator">=</span> rs.getDate(<span class="string">&quot;create_time&quot;</span>);</span><br><span class="line">               System.out.println(id + <span class="string">&quot;,&quot;</span> + name + <span class="string">&quot;,&quot;</span> + price + <span class="string">&quot;,&quot;</span> + createTime);</span><br><span class="line">               <span class="comment">// 将java.sql.Date 转换成 java.util.Date（通过构造方法来完成转换。）</span></span><br><span class="line">               java.util.<span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.util.Date(createTime.getTime());<span class="comment">//这里的getTime获取的是毫秒级，然后通过构造方法封装成utildate</span></span><br><span class="line">               <span class="comment">// 进行格式化显示</span></span><br><span class="line">               <span class="type">String</span> <span class="variable">strDate</span> <span class="operator">=</span> sdf.format(date);</span><br><span class="line">               System.out.println(strDate);</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取结果集的元数据信息（了解）"><a href="#获取结果集的元数据信息（了解）" class="headerlink" title="获取结果集的元数据信息（了解）"></a>获取结果集的元数据信息（了解）</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250408181241113.png" alt="image-20250408181241113"></p>
<p><strong>这组数据整个叫ResultSet对象，而id的那一行数据叫做结果集元数据对象ResultSetMetaData</strong><br>ResultSetMetaData 是一个接口，用于描述 ResultSet 中的元数据信息，即查询结果集的结构信息，例如查询结果集中包含了哪些列，每个列的数据类型、长度、标识符等。</p>
<p>ResultSetMetaData 可以通过 ResultSet 接口的 getMetaData() 方法获取，一般在对 ResultSet 进行元数据信息处理时使用。</p>
<ul>
<li>ResultSetMetaData rsmd &#x3D; rs.getMetaData();&#x2F;&#x2F;返回的是ResultSetMetaData</li>
<li>rsmd.getColumnCount();&#x2F;&#x2F;获取列的数量</li>
<li>rsmd.getColumnName(i);&#x2F;&#x2F; 获取列的名字</li>
<li>rsmd.getColumnTypeName(i);  &#x2F;&#x2F; 获取列的数据类型</li>
<li>rsmd.getColumnDisplaySize(i);  &#x2F;&#x2F; 获取列的长度</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4.执行sql语句</span></span><br><span class="line">          <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from t_product&quot;</span>;</span><br><span class="line">          rs = stmt.executeQuery(sql);</span><br><span class="line">          <span class="comment">// 5.处理查询结果集</span></span><br><span class="line">          <span class="comment">// 通过结果集ResultSet来获取结果集元数据ResultSetMetaData</span></span><br><span class="line">          <span class="comment">// 通过结果集元数据可以获取列的信息，例如：列名，列的数据类型，列的长度...</span></span><br><span class="line">          <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> rs.getMetaData();<span class="comment">//返回的是ResultSetMetaData</span></span><br><span class="line">          <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();<span class="comment">//获取列的数量</span></span><br><span class="line">          System.out.println(<span class="string">&quot;共&quot;</span> + columnCount + <span class="string">&quot;列&quot;</span>);</span><br><span class="line">          <span class="comment">// 遍历每一列</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; columnCount; i++) &#123;<span class="comment">// 1,2,3,4</span></span><br><span class="line">              <span class="comment">// i是列的下标。（注意：JDBC中所有的下标都是从1开始。）</span></span><br><span class="line">              <span class="comment">// 获取列的名字</span></span><br><span class="line">              <span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> rsmd.getColumnName(i);</span><br><span class="line">              System.out.println(<span class="string">&quot;第&quot;</span> + i + <span class="string">&quot;列的列名&quot;</span> + columnName);</span><br><span class="line">              <span class="comment">// 获取列的数据类型</span></span><br><span class="line">              <span class="type">String</span> <span class="variable">columnTypeName</span> <span class="operator">=</span> rsmd.getColumnTypeName(i);</span><br><span class="line">              System.out.println(<span class="string">&quot;第&quot;</span> + i + <span class="string">&quot;列的类型是&quot;</span> + columnTypeName);</span><br><span class="line">              <span class="comment">// 获取列的长度</span></span><br><span class="line">              <span class="type">int</span> <span class="variable">columnDisplaySize</span> <span class="operator">=</span> rsmd.getColumnDisplaySize(i);</span><br><span class="line">              System.out.println(<span class="string">&quot;第&quot;</span> + i + <span class="string">&quot;列的长度&quot;</span> + columnDisplaySize);</span><br><span class="line"></span><br><span class="line">          &#125;</span><br></pre></td></tr></table></figure>

<p>在上面的代码中，我们首先创建了一个 Statement 对象，然后执行了一条 SQL 查询语句，生成了一个 ResultSet 对象。接下来，我们通过 ResultSet 对象的 getMetaData() 方法获取了 ResultSetMetaData 对象，进而获取了查询结果中列的信息并进行输出。需要注意的是，在进行列信息的获取时，列的编号从 1 开始计算。该示例代码将获取查询结果集中所有列名、数据类型以及长度等信息。</p>
<h3 id="获取新增行的主键值"><a href="#获取新增行的主键值" class="headerlink" title="获取新增行的主键值"></a>获取新增行的主键值</h3><p>有很多表的主键字段值都是自增的，在某些特殊的业务环境下，当我们插入了新数据后，希望能够获取到这条新数据的主键值，应该如何获取呢？<br>在 JDBC 中，如果要获取插入数据后的主键值，可以使用 Statement 接口的 executeUpdate() 方法的重载版本，该方法接受一个额外的参数，用于指定是否需要获取自动生成的主键值。然后，通过以下两个步骤获取插入数据后的主键值：</p>
<ol>
<li>在执行 executeUpdate() 方法时指定一个标志位，表示需要返回插入的主键值。</li>
<li>调用 Statement 对象的 getGeneratedKeys() 方法，返回一个包含插入的主键值的 ResultSet 对象。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4.执行sql语句</span></span><br><span class="line">           <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_product(name,price,create_time) values(&#x27;小米su7&#x27;, 1.0, &#x27;2024-02-23&#x27;)&quot;</span>;</span><br><span class="line">           <span class="comment">// 注意：第二个参数是标志位，用来表示是否将新插入的数据行的主键值返回</span></span><br><span class="line">           <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> stmt.executeUpdate(sql, Statement.RETURN_GENERATED_KEYS);<span class="comment">//后面也可以写成1，但最好是写常量</span></span><br><span class="line">           System.out.println(<span class="string">&quot;插入了&quot;</span> + count + <span class="string">&quot;条记录&quot;</span>);</span><br><span class="line">           <span class="comment">// 获取这个新增行的主键值</span></span><br><span class="line">           <span class="comment">// 返回的这个rs结果集中就包含了新增行的主键值</span></span><br><span class="line">           rs = stmt.getGeneratedKeys();</span><br><span class="line">           <span class="comment">// 通过结果集取主键值</span></span><br><span class="line">           <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">               <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> rs.getLong(<span class="number">1</span>);<span class="comment">//第一列</span></span><br><span class="line">               System.out.println(<span class="string">&quot;新增行的主键值：&quot;</span> + id);</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure>

<h2 id="使用IDEA工具类-DbUtils-编写JDBC程序"><a href="#使用IDEA工具类-DbUtils-编写JDBC程序" class="headerlink" title="使用IDEA工具类(DbUtils)编写JDBC程序"></a>使用IDEA工具类(DbUtils)编写JDBC程序</h2><p>工具类的构造方法一般都是私有化的，因为工具类中的一般都是静态的，工具类就是为了方便编程，所以工具类中的方法都是直接采用“类名.”，的方式访问，因此不需要new对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.jdbc.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ResourceBundle;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ClassName: DbUtils</span></span><br><span class="line"><span class="comment"> * Description: JDBC工具类</span></span><br><span class="line"><span class="comment"> * Datetime: 2024/4/11 16:04</span></span><br><span class="line"><span class="comment"> * Author: 老杜@动力节点</span></span><br><span class="line"><span class="comment"> * Version: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DbUtils</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 工具类的构造方法一般都是私有化的，因为工具类中的一般都是静态的，</span></span><br><span class="line"><span class="comment">     * 工具类就是为了方便编程，所以工具类中的方法都是直接采用“类名.”</span></span><br><span class="line"><span class="comment">     * 的方式访问，因此不需要new对象。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">DbUtils</span><span class="params">()</span>&#123;&#125;<span class="comment">//工具类的构造方法私有化</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 静态变量，因为这些将来要在下面的静态代码块和构造方法里用，所以定义成静态变量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String user;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 静态代码块</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// 在这里读取属性配置文件，给静态变量赋值</span></span><br><span class="line">        <span class="type">ResourceBundle</span> <span class="variable">bundle</span> <span class="operator">=</span> ResourceBundle.getBundle(<span class="string">&quot;com.powernode.jdbc.jdbc01&quot;</span>);</span><br><span class="line">        driver = bundle.getString(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        url = bundle.getString(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        user = bundle.getString(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        password = bundle.getString(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 想要让注册驱动只执行一次</span></span><br><span class="line">        <span class="comment">// 在类加载的时候，注册驱动，对于整个应用程序来说，注册驱动只需要做一次即可。所以选择静态代码块。</span></span><br><span class="line">        <span class="comment">// 静态代码块在类加载时执行，并且只执行一次。</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(driver);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取数据库连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 释放资源</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> conn 连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stmt 数据库操作对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> rs 结果集对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt, ResultSet rs)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (stmt != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="第04章-SQL注入"><a href="#第04章-SQL注入" class="headerlink" title="第04章 SQL注入"></a>第04章 SQL注入</h1><h2 id="SQL注入问题"><a href="#SQL注入问题" class="headerlink" title="SQL注入问题"></a>SQL注入问题</h2><p>SQL注入问题说的是：用户输入的信息中含有SQL语句关键字，和程序中的SQL语句进行字符串拼接，导致程序中的SQL语句改变了原意。（SQL注入问题是一种系统安全问题）</p>
<p>业务描述：系统启动后，给出登录页面，用户可以输入用户名和密码，用户名和密码全部正确，则登录成功，反之，则登录失败。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest08</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="comment">// 初始化界面</span></span><br><span class="line">        System.out.println(<span class="string">&quot;欢迎使用用户管理系统，请登录！&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;用户名：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">loginName</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;密码：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">loginPwd</span> <span class="operator">=</span> scanner.next();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 链接数据库，验证用户名和密码是否正确</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">loginSuccess</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">realname</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//获取链接</span></span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="comment">// 获取数据库操作对象</span></span><br><span class="line">            stmt = conn.createStatement();</span><br><span class="line">            <span class="comment">// 执行SQL语句</span></span><br><span class="line">            <span class="comment">// name和password都是varchar字符串类型，在sql是要用单引号括起来的，然后用双引号双加号链接</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from t_user where name = &#x27;&quot;</span>+loginName+<span class="string">&quot;&#x27; and password = &#x27;&quot;</span>+loginPwd+<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            System.out.println(sql);</span><br><span class="line">            rs = stmt.executeQuery(sql);</span><br><span class="line">            <span class="comment">// 处理结果集（结果集中有数据，表示登录成功，反之表示登录失败）</span></span><br><span class="line">            <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">                <span class="comment">// 登录成功</span></span><br><span class="line">                loginSuccess = <span class="literal">true</span>;</span><br><span class="line">                <span class="comment">// 获取真实的名字放到下面的输出信息里</span></span><br><span class="line">                realname = rs.getString(<span class="string">&quot;realname&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, stmt, rs);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(loginSuccess ? <span class="string">&quot;登录成功，欢迎&quot;</span> + realname : <span class="string">&quot;登录失败，您的用户名不存在或者密码错误！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后把String loginName &#x3D; scanner.next();改为String loginName &#x3D; scanner.nextLine();每次读一行</p>
<p>用户提供的信息中如果还有sql语句的关键字，作为字符串的形式和java程序中的sql语句进行了字符串的拼接，可能会导致原sql语句的含义被扭曲</p>
<p>比如输入以下这样的信息<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250409041612076.png" alt="image-20250409041612076"></p>
<p>就会输出登录成功，欢迎张三，sql语句是select * from t_user where name &#x3D; ‘fdsa’ and password &#x3D; ‘gfds’ or ‘a’ &#x3D; ‘a’</p>
<p>这种现象就叫做：SQL注入。导致这个现象的根本原因是：先进行了sql语句的字符串拼接，然后再进行sql语句的编译。</p>
<h2 id="解决SQL注入问题"><a href="#解决SQL注入问题" class="headerlink" title="解决SQL注入问题"></a>解决SQL注入问题</h2><p>最根本的原因是：Statement造成的。</p>
<p>Statement执行原理是：先进行字符串的拼接，将拼接好的SQL语句发送给数据库服务器，数据库服务器进行SQL语句的编译，然后执行。因此用户提供的信息中如果含有SQL语句的关键字，那么这些关键字正好参加了SQL语句的编译，所以导致原SQL语句被扭曲。</p>
<p>因此，JDBC为了解决这个问题，引入了一个新的接口：PreparedStatement，我们称为：预编译的数据库操作对象。PreparedStatement是Statement接口的子接口。它俩是继承关系。</p>
<p>PreparedStatement执行原理是：先对SQL语句进行预先的编译，然后再向SQL语句指定的位置传值，也就是说：用户提供的信息中即使含有SQL语句的关键字，那么这个信息也只会被当做一个值传递给SQL语句，用户提供的信息不再参与SQL语句的编译了，这样就解决了SQL注入问题。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">这个程序在实现了基本的登录功能的同时，演示了SQL注入的现象。</span><br><span class="line"> 导致SQL注入现象的根本原因是什么？</span><br><span class="line">      第一：用户提供的信息中含有SQL语句的关键字了。</span><br><span class="line">      第二：这些用户提供的信息中的关键字参与了SQL语句的编译。</span><br><span class="line"></span><br><span class="line"> SQL注入是一种安全隐患。黑客通常使用SQL注入来攻击你的系统。</span><br><span class="line"> 怎么避免SQL注入现象呢？</span><br><span class="line">      java.sql.Statement 是存在SQL注入现象的，因为它的原理是：先拼接SQL语句字符串，然后再进行编译，所以它必然存在SQL注入的问题。</span><br><span class="line">      为了避免SQL注入的发生，JDBC API中为Statement接口提供了一个子接口：java.sql.PreparedStatement，被称为预编译的数据库操作对象。</span><br><span class="line">      java.sql.PreparedStatement可以解决SQL注入问题。</span><br><span class="line">      具体怎么解决的？PreparedStatement可以对SQL语句进行预先编译，然后给编译好的SQL语句占位符传值，通过这种方式来解决SQL注入问题。</span><br><span class="line">      最本质的解决方法是：用户虽然提供了SQL语句关键字，但是这些关键字不再参与SQL语句的编译了。因此解决了SQL注入的问题。</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 连接数据库，验证用户名和密码是否正确。</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="variable">loginSuccess</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">realname</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 获取连接</span></span><br><span class="line">    conn = DbUtils.getConnection();</span><br><span class="line">    <span class="comment">// 获取预编译的数据库操作对象</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from t_user where name = ? and password = ?&quot;</span>;</span><br><span class="line">    ps = conn.prepareStatement(sql);</span><br><span class="line">    <span class="comment">// 给 ? 占位符 传值</span></span><br><span class="line">    <span class="comment">// 再次强调：在JDBC当中，所有的下标都是从1开始。不是从0开始。</span></span><br><span class="line">    <span class="comment">// 以下代码的含义是：给第1个占位符 ? 传值，传入的是&#x27;name&#x27;</span></span><br><span class="line">    ps.setString(<span class="number">1</span>, loginName);</span><br><span class="line">    <span class="comment">// 以下代码的含义是：给第2个占位符 ? 传值，如果是传int类型就写setInt,传入100没有单引号</span></span><br><span class="line">    ps.setString(<span class="number">2</span>, loginPwd);</span><br><span class="line">    <span class="comment">// 执行SQL语句，ps里已经包含了sql语句所以不需要写</span></span><br><span class="line">    rs = ps.executeQuery();</span><br><span class="line">    <span class="comment">// 处理结果集（结果集中有数据，表示登录成功，反之表示登录失败）</span></span><br><span class="line">    <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">        <span class="comment">// 登录成功</span></span><br><span class="line">        loginSuccess = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// 获取真实的名字</span></span><br><span class="line">        realname = rs.getString(<span class="string">&quot;realname&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>PreparedStatement原理：</strong></p>
<ul>
<li>第一步：先对SQL语句进行预先编译</li>
<li>第二步：给SQL语句中占位符传值</li>
</ul>
<p>解决SQL注入的本质是：先将带有占位符的SQL语句进行预先编译，然后给占位符传值。</p>
<p>即使用户提供的信息中含有SQL语句关键字，但是这些关键字不会参与SQL语句的编译，自然不会扭曲SQL语句的原意。</p>
<p><strong>关于使用PreparedStatement要注意的是：</strong></p>
<ul>
<li>带有占位符 ? 的SQL语句我们称为：预处理SQL语句。</li>
<li>占位符 ? 不能使用单引号或双引号包裹。如果包裹，占位符则不再是占位符，是一个普通的问号字符。</li>
<li>在执行SQL语句前，必须给每一个占位符 ? 传值。</li>
<li>如何给占位符 ? 传值，通过以下的方法：<ul>
<li>pstmt.setXxx(第几个占位符, 传什么值)</li>
<li>“第几个占位符”：从1开始。第1个占位符则是1，第2个占位符则是2，以此类推。</li>
<li>“传什么值”：具体要看调用的什么方法？<ul>
<li>如果调用pstmt.setString方法，则传的值必须是一个字符串。</li>
<li>如果调用pstmt.setInt方法，则传的值必须是一个整数。</li>
<li>以此类推……</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>PreparedStatement和Statement都是用于执行SQL语句的接口，它们的主要区别在于：</strong></p>
<p>Statement：是先拼接字符串然后再编译，这里的查询语句的变量会发生变化，发生变化会导致sql语句跟之前的不一样，就需要重新编译，所以效率会低一点点，而PreparedStatement是编译1次执行n次，都是在ps &#x3D; conn.prepareStatement(sql);这里执行</p>
<ul>
<li>PreparedStatement预编译SQL语句，Statement直接提交SQL语句；</li>
<li>PreparedStatement执行速度更快，可以避免SQL注入攻击；(PreparedStatement对于同一条SQL语句来说，编译一次，执行N次。而Statement是每次都要进行编译的。因此PreparedStatement效率略微高一些。)</li>
<li>PreparedStatement会做类型检查，是类型安全的；</li>
</ul>
<h2 id="PreparedStatement的使用"><a href="#PreparedStatement的使用" class="headerlink" title="PreparedStatement的使用"></a>PreparedStatement的使用</h2><h3 id="新增操作"><a href="#新增操作" class="headerlink" title="新增操作"></a>新增操作</h3><p>需求：向 emp 表中插入这样一条记录：<br>empno：8888<br>ename：张三<br>job：销售员<br>mgr：7369<br>hiredate：2024-01-01<br>sal：1000.0<br>comm：500.0<br>deptno：10</p>
<p>怎么把字符串转换成需要的sql date？<br>LocalDate localDate &#x3D; LocalDate.parse(“2024-01-01”);&#x2F;&#x2F;parse是解析，将其转换成LocalDate这个类型<br>ps.setDate(5, java.sql.Date.valueOf(localDate));&#x2F;&#x2F;java.sql.Date的valueOf里面传入一个LocalDate就可以获取了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 因为是插入，不涉及结果集所以不写resultSet</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1.注册驱动（因为我们使用了DbUtils，因此这一步不需要写）</span></span><br><span class="line">            <span class="comment">// 2.获取连接</span></span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="comment">// 3.获取预编译的数据库操作对象</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(?,?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">            <span class="comment">// 程序执行到这里，会对“预处理的SQL语句”进行预编译操作</span></span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            <span class="comment">// 给 ? 占位符传值</span></span><br><span class="line">            ps.setInt(<span class="number">1</span>, <span class="number">8888</span>);</span><br><span class="line">            ps.setString(<span class="number">2</span>, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line">            ps.setString(<span class="number">3</span>, <span class="string">&quot;销售员&quot;</span>);</span><br><span class="line">            ps.setInt(<span class="number">4</span>, <span class="number">7369</span>);</span><br><span class="line">            <span class="comment">// 怎么把字符串转换成需要的sql date</span></span><br><span class="line">            <span class="type">LocalDate</span> <span class="variable">localDate</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;2024-01-01&quot;</span>);<span class="comment">//parse是解析，将其转换成LocalDate这个类型</span></span><br><span class="line">            ps.setDate(<span class="number">5</span>, java.sql.Date.valueOf(localDate));<span class="comment">//java.sql.Date的valueOf里面传入一个LocalDate就可以获取了</span></span><br><span class="line">            ps.setDouble(<span class="number">6</span>, <span class="number">1000.0</span>);</span><br><span class="line">            ps.setDouble(<span class="number">7</span>, <span class="number">500.0</span>);</span><br><span class="line">            ps.setInt(<span class="number">8</span>, <span class="number">10</span>);</span><br><span class="line">            <span class="comment">// 4.执行SQL语句</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">            System.out.println(<span class="string">&quot;插入了&quot;</span> + count + <span class="string">&quot;条记录&quot;</span>);</span><br><span class="line">            <span class="comment">// 5.处理查询结果集（因为现在是执行insert操作，所以这一步没有）</span></span><br></pre></td></tr></table></figure>

<h3 id="修改操作"><a href="#修改操作" class="headerlink" title="修改操作"></a>修改操作</h3><p>需求：将员工编号为8888的员工，姓名修改为李四，岗位修改为产品经理，月薪修改为5000.0，其他不变。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update emp set ename=?, job=?, sal=? where empno=?&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            ps.setString(<span class="number">1</span>, <span class="string">&quot;李四&quot;</span>);</span><br><span class="line">            ps.setString(<span class="number">2</span>, <span class="string">&quot;产品经理&quot;</span>);</span><br><span class="line">            ps.setDouble(<span class="number">3</span>, <span class="number">5000.0</span>);</span><br><span class="line">            ps.setInt(<span class="number">4</span>, <span class="number">8888</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">            System.out.println(<span class="string">&quot;更新了&quot;</span> + count + <span class="string">&quot;条数据&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn,ps,<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<h3 id="删除操作"><a href="#删除操作" class="headerlink" title="删除操作"></a>删除操作</h3><p>需求：将员工编号为8888的删除。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">      需求：将员工编号为8888的删除。</span></span><br><span class="line"><span class="comment">      使用 try-with-resources 语法。(Java7的新特性)</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span>  <span class="string">&quot;delete from emp where empno = ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span>(<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DbUtils.getConnection();</span><br><span class="line">          <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql)) &#123;</span><br><span class="line">          ps.setInt(<span class="number">1</span>, <span class="number">8888</span>);</span><br><span class="line">          <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">          System.out.println(<span class="string">&quot;删除了&quot;</span> + count + <span class="string">&quot;条记录&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br></pre></td></tr></table></figure>

<h3 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h3><p>需求：查询员工名字中第二个字母是 O 的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">       需求：查询员工名字中第二个字母是 O 的。</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           conn = DbUtils.getConnection();</span><br><span class="line">           <span class="comment">// 这样是错误的，占位符不能加引号</span></span><br><span class="line">           <span class="comment">//String sql = &quot;select ename from emp where ename like &#x27;_?%&#x27;&quot;;</span></span><br><span class="line">           <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select ename from emp where ename like ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">           ps = conn.prepareStatement(sql);</span><br><span class="line">           ps.setString(<span class="number">1</span>, <span class="string">&quot;_O%&quot;</span>);</span><br><span class="line"></span><br><span class="line">           <span class="comment">// 这样是错误的</span></span><br><span class="line">           <span class="comment">//ps.setString(1, &quot;O&quot;);</span></span><br><span class="line"></span><br><span class="line">           rs = ps.executeQuery();</span><br><span class="line">           <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">               <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;ename&quot;</span>);</span><br><span class="line">               System.out.println(ename);</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure>

<h3 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h3><p>对于MySQL来说，通用的分页SQL语句：<br>假设每页显示3条记录：pageSize &#x3D; 3<br>第1页：limit 0, 3<br>第2页：limit 3, 3<br>第3页：limit 6, 3<br>*<em>第pageNo页：limit (pageNo - 1)<em>pageSize, pageSize</em></em><br>需求：查询所有员工姓名，每页显示3条(pageSize)，显示第2页(pageNo)。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">       需求：查询所有员工姓名，每页显示3条(pageSize)，显示第2页(pageNo)。</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="comment">// 每页现实的记录条数</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">pageSize</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">       <span class="comment">// 显示第几页（页码）</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">       <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           conn = DbUtils.getConnection();</span><br><span class="line">           <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select ename from emp limit ?,?&quot;</span>;</span><br><span class="line">           ps = conn.prepareStatement(sql);</span><br><span class="line">           ps.setInt(<span class="number">1</span>, (pageNo - <span class="number">1</span>) * pageSize);</span><br><span class="line">           ps.setInt(<span class="number">2</span>, pageSize);</span><br><span class="line">           rs = ps.executeQuery();</span><br><span class="line">           <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">               <span class="type">String</span> <span class="variable">ename</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;ename&quot;</span>);</span><br><span class="line">               System.out.println(ename);</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure>

<h3 id="blob数据的插入和读取"><a href="#blob数据的插入和读取" class="headerlink" title="blob数据的插入和读取"></a>blob数据的插入和读取</h3><p>blob类型的全称是binary large object，二进制大对象，用来接受图片这种，底层运行原理是这样的，用io流从硬盘读取到内存，然后再输出到数据库里，但是executeUpdate()底层会自动输出，所以这个输出流是看不见的。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250410194604716.png" alt="image-20250410194604716"></p>
<p>准备一张表：t_img，三个字段，一个id主键，一个图片名字name，一个img。<br>建表语句如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> `t_img` (</span><br><span class="line">  `id` <span class="type">bigint</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">  `img` <span class="type">blob</span></span><br><span class="line">) engine<span class="operator">=</span>innodb;</span><br></pre></td></tr></table></figure>


<p>需求1：向t_img 表中插入一张图片。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">FileInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          conn = DbUtils.getConnection();</span><br><span class="line">          <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_img(name, img) values(?, ?)&quot;</span>;</span><br><span class="line">          ps = conn.prepareStatement(sql);</span><br><span class="line">          <span class="comment">// 给 ? 传值</span></span><br><span class="line">          ps.setString(<span class="number">1</span>, <span class="string">&quot;狗狗的图片&quot;</span>);</span><br><span class="line">          in = <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;F:\\动力节点全套资料\\07-JDBC教程,jdbc从零到精通,动力节点JDBC,老杜jdbc\\resources\\dog.jpg&quot;</span>);</span><br><span class="line">          ps.setBlob(<span class="number">2</span>, in);</span><br><span class="line">          <span class="comment">// 执行sql</span></span><br><span class="line">          <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">          System.out.println(<span class="string">&quot;插入了&quot;</span> + count + <span class="string">&quot;条记录&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">      &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">         <span class="keyword">if</span>(in != <span class="literal">null</span>)&#123;</span><br><span class="line">             <span class="keyword">try</span> &#123;</span><br><span class="line">                 in.close();</span><br><span class="line">             &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                 <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">          DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>需求2：从t_img 表中读取一张图片。（从数据库中读取一张图片保存到本地。）</p>
<p>需要输入流是因为要从数据库读取到内存里，然后再从内存输出到电脑硬盘上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           conn = DbUtils.getConnection();</span><br><span class="line">           <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select img from t_img where name = ?&quot;</span>;</span><br><span class="line">           ps = conn.prepareStatement(sql);</span><br><span class="line">           ps.setString(<span class="number">1</span>, <span class="string">&quot;狗狗的图片&quot;</span>);</span><br><span class="line">           rs = ps.executeQuery();</span><br><span class="line">           <span class="keyword">if</span> (rs.next())&#123;</span><br><span class="line">               <span class="comment">// 注意：图片就在结果集ResultSet对象当中。</span></span><br><span class="line">               <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> rs.getBinaryStream(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">               <span class="type">OutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;E:/dog.jpg&quot;</span>);</span><br><span class="line">               <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">               <span class="type">int</span> <span class="variable">readCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">               <span class="keyword">while</span>((readCount = in.read(bytes)) != -<span class="number">1</span>)&#123;</span><br><span class="line">                   out.write(bytes, <span class="number">0</span>, readCount);</span><br><span class="line">               &#125;</span><br><span class="line">               out.flush();</span><br><span class="line">               in.close();</span><br><span class="line">               out.close();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">       &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">           DbUtils.close(conn, ps, rs);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<h2 id="JDBC批处理（插入）操作"><a href="#JDBC批处理（插入）操作" class="headerlink" title="JDBC批处理（插入）操作"></a>JDBC批处理（插入）操作</h2><p>准备一张商品表：t_product<br>建表语句如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> t_product(</span><br><span class="line">  id <span class="type">bigint</span> <span class="keyword">primary key</span>,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="不使用批处理"><a href="#不使用批处理" class="headerlink" title="不使用批处理"></a>不使用批处理</h3><p>不使用批处理，向 t_product 表中插入一万条商品信息，并记录耗时！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_batch(id,name) values(?,?)&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">                ps.setLong(<span class="number">1</span>, i);</span><br><span class="line">                ps.setString(<span class="number">2</span>, <span class="string">&quot;batch&quot;</span> + i);</span><br><span class="line">                count += ps.executeUpdate();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;插入了&quot;</span> + count + <span class="string">&quot;条记录&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;总耗时&quot;</span> + (end - begin) + <span class="string">&quot;毫秒&quot;</span>); <span class="comment">// 总耗时特别久</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="使用批处理"><a href="#使用批处理" class="headerlink" title="使用批处理"></a>使用批处理</h3><p>使用批处理，向 t_product 表中插入一万条商品信息，并记录耗时！<br><strong>注意：启用批处理需要在URL后面添加这个的参数：rewriteBatchedStatements&#x3D;true</strong></p>
<p>ps.addBatch();&#x2F;&#x2F; 打包<br>executeBatch会批量执行处理一次，返回值是个int数组<br>executeBatch().length返回的是数组的长度</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_batch(id,name) values(?,?)&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">                ps.setLong(<span class="number">1</span>, i);</span><br><span class="line">                ps.setString(<span class="number">2</span>, <span class="string">&quot;batch&quot;</span> + i);</span><br><span class="line">                <span class="comment">// 打包</span></span><br><span class="line">                ps.addBatch();</span><br><span class="line">                <span class="comment">// 如果打包够500个，则执行一次（则磁盘IO一次）</span></span><br><span class="line">                <span class="comment">// 这500个可以测试其他数，看看哪个效率高就用哪个</span></span><br><span class="line">                <span class="comment">// executeBatch会批量执行处理一次，返回值是个int数组，executeBatch().length返回的是数组的长度</span></span><br><span class="line">                <span class="keyword">if</span>(i % <span class="number">500</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                    count += ps.executeBatch().length;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 循环结束之后，再次执行批处理，防止数据丢失。</span></span><br><span class="line">            <span class="comment">// 怕实际上是501条，会漏一条</span></span><br><span class="line">            count += ps.executeBatch().length;</span><br><span class="line">            System.out.println(<span class="string">&quot;插入了&quot;</span> + count + <span class="string">&quot;条记录&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;总耗时&quot;</span> + (end - begin) + <span class="string">&quot;毫秒&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>插入了9999条记录<br>总耗时3617毫秒</p>
<p>在进行大数据量插入时，批处理为什么可以提高程序的执行效率？</p>
<ol>
<li>减少了网络通信次数：JDBC 批处理会将多个 SQL 语句一次性发送给服务器，减少了客户端和服务器之间的通信次数，从而提高了数据写入的速度，特别是对于远程服务器而言，优化效果更为显著。 </li>
<li>减少了数据库操作次数：JDBC 批处理会将多个 SQL 语句合并成一条 SQL 语句进行执行，从而减少了数据库操作的次数，减轻了数据库的负担，大大提高了数据写入的速度。</li>
</ol>
<h1 id="第05章-JDBC事务"><a href="#第05章-JDBC事务" class="headerlink" title="第05章 JDBC事务"></a>第05章 JDBC事务</h1><h2 id="什么是事务"><a href="#什么是事务" class="headerlink" title="什么是事务"></a>什么是事务</h2><p>事务是一个完整的业务，在这个业务中需要多条DML语句共同联合才能完成，而事务可以保证多条DML语句同时成功或者同时失败，从而保证数据的安全。例如A账户向B账户转账一万，A账户减去一万(update)和B账户加上一万(update)，必须同时成功或者同时失败，才能保证数据是正确的。</p>
<p>另请参见老杜发布的2024版MySQL教学视频。在本套教程中详细讲解了数据库事务机制。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250411004704852.png" alt="image-20250411004704852"></p>
<h2 id="使用转账案例演示事务"><a href="#使用转账案例演示事务" class="headerlink" title="使用转账案例演示事务"></a>使用转账案例演示事务</h2><h3 id="表和数据的准备"><a href="#表和数据的准备" class="headerlink" title="表和数据的准备"></a>表和数据的准备</h3><p>t_act表</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250411004750039.png" alt="image-20250411004750039"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250411004802647.png" alt="image-20250411004802647"></p>
<h3 id="实现转账功能"><a href="#实现转账功能" class="headerlink" title="实现转账功能"></a>实现转账功能</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest19</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 转账金额</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">money</span> <span class="operator">=</span> <span class="number">10000.0</span>;</span><br><span class="line">        <span class="comment">// 实现转账功能</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps1</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将 act-001 账户的余额减去一万</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;update t_act set balance = balance - ? where actno = ?&quot;</span>;</span><br><span class="line">            ps1 = conn.prepareStatement(sql1);</span><br><span class="line">            ps1.setDouble(<span class="number">1</span>, money);</span><br><span class="line">            ps1.setString(<span class="number">2</span>, <span class="string">&quot;act-001&quot;</span>);</span><br><span class="line">            <span class="type">int</span> count1= ps1.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将 act-002 账户的余额加上一万</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update t_act set balance = balance + ? where actno = ?&quot;</span>;</span><br><span class="line">            ps2 = conn.prepareStatement(sql2);</span><br><span class="line">            ps2.setDouble(<span class="number">1</span>, money);</span><br><span class="line">            ps2.setString(<span class="number">2</span>, <span class="string">&quot;act-002&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">count2</span> <span class="operator">=</span> ps2.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 先关闭ps1 ps1再关闭conn</span></span><br><span class="line">            DbUtils.close(<span class="literal">null</span>, ps1, <span class="literal">null</span>);</span><br><span class="line">            DbUtils.close(<span class="literal">null</span>, ps2, <span class="literal">null</span>);</span><br><span class="line">            DbUtils.close(conn, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="JDBC事务默认是自动提交的"><a href="#JDBC事务默认是自动提交的" class="headerlink" title="JDBC事务默认是自动提交的"></a>JDBC事务默认是自动提交的</h3><p>DBC事务默认情况下是自动提交的，所谓的自动提交是指：只要执行一条DML语句则自动提交一次。测试一下，在以下代码位置添加断点：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250411152725401.png" alt="image-20250411152725401"></p>
<p>让代码执行到断点处看看数据库表中的数据是否发生变化：</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250411152747646.png" alt="image-20250411152747646"></p>
<p>因为JDBC事务默认情况下是自动提交，只要执行一条DML语句则自动提交一次。这种自动提交是极其危险的。如果在此时程序发生了异常，act-002账户的余额未成功更新，则钱会丢失一万。</p>
<h3 id="添加事务控制"><a href="#添加事务控制" class="headerlink" title="添加事务控制"></a>添加事务控制</h3><p>如何解决以上问题，分三步：<br>第一步：将JDBC事务的自动提交机制修改为手动提交（即开启事务）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn.setAutoCommit(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<p>第二步：当整个业务完整结束后，手动提交事务（即提交事务，事务结束）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn.commit();</span><br></pre></td></tr></table></figure>

<p>第三步：在处理业务过程中，如果发生异常，则进入catch语句块进行异常处理，手动回滚事务（即回滚事务，失败的事务提交后结束）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn.rollback();</span><br></pre></td></tr></table></figure>

<p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 第一步：开启事务（将JDBC事务的自动提交机制修改为手动提交）</span></span><br><span class="line">            conn.setAutoCommit(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将 act-001 账户的余额减去一万</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql1</span> <span class="operator">=</span> <span class="string">&quot;update t_act set balance = balance - ? where actno = ?&quot;</span>;</span><br><span class="line">            ps1 = conn.prepareStatement(sql1);</span><br><span class="line">            ps1.setDouble(<span class="number">1</span>, money);</span><br><span class="line">            ps1.setString(<span class="number">2</span>, <span class="string">&quot;act-001&quot;</span>);</span><br><span class="line">            <span class="type">int</span> count1= ps1.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将 act-002 账户的余额加上一万</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;update t_act set balance = balance + ? where actno = ?&quot;</span>;</span><br><span class="line">            ps2 = conn.prepareStatement(sql2);</span><br><span class="line">            ps2.setDouble(<span class="number">1</span>, money);</span><br><span class="line">            ps2.setString(<span class="number">2</span>, <span class="string">&quot;act-002&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">count2</span> <span class="operator">=</span> ps2.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 第二步：当整个业务流程成功的完整的结束了，提交事务（事务结束）</span></span><br><span class="line">            conn.commit();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// 第三步：只要有任何一个异常发生，则回滚事务（事务结束）</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conn.rollback();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(ex);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 先关闭ps1 ps1再关闭conn</span></span><br><span class="line">            DbUtils.close(<span class="literal">null</span>, ps1, <span class="literal">null</span>);</span><br><span class="line">            DbUtils.close(<span class="literal">null</span>, ps2, <span class="literal">null</span>);</span><br><span class="line">            DbUtils.close(conn, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h2 id="设置JDBC事务隔离级别"><a href="#设置JDBC事务隔离级别" class="headerlink" title="设置JDBC事务隔离级别"></a>设置JDBC事务隔离级别</h2><p>关于事务隔离级别相关内容另请参见：老杜发布的2024版MySQL教程</p>
<p>设置事务的隔离级别也是比较重要的，在JDBC程序中应该如何设置事务的隔离级别呢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn.setTransactionIsolation<span class="comment">//里面传的参数是int，也就是Connection这个类里面的一些常量</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest20</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 设置当前事务的事务隔离级别</span></span><br><span class="line">            conn.setTransactionIsolation(Connection.TRANSACTION_REPEATABLE_READ);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="第06章-JDBC调用存储过程"><a href="#第06章-JDBC调用存储过程" class="headerlink" title="第06章 JDBC调用存储过程"></a>第06章 JDBC调用存储过程</h1><h2 id="在MySQL中创建存储过程"><a href="#在MySQL中创建存储过程" class="headerlink" title="在MySQL中创建存储过程"></a>在MySQL中创建存储过程</h2><p>这是一个计算0-100之间所有偶数和的sql语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro(<span class="keyword">in</span> n <span class="type">int</span>, <span class="keyword">out</span> sum <span class="type">int</span>)<span class="operator">/</span><span class="operator">/</span>一个入参一个出参</span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">	<span class="keyword">set</span> sum :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	repeat </span><br><span class="line">		if n <span class="operator">%</span> <span class="number">2</span> <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line">		  <span class="keyword">set</span> sum :<span class="operator">=</span> sum <span class="operator">+</span> n;</span><br><span class="line">		<span class="keyword">end</span> if;</span><br><span class="line">		<span class="keyword">set</span> n :<span class="operator">=</span> n <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">		until n <span class="operator">&lt;=</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">end</span> repeat;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<h2 id="使用JDBC代码调用存储过程"><a href="#使用JDBC代码调用存储过程" class="headerlink" title="使用JDBC代码调用存储过程"></a>使用JDBC代码调用存储过程</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest21</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// 专门执行存储过程的。（CallableStatement 继承了 PreparedStatement）</span></span><br><span class="line">        <span class="type">CallableStatement</span> <span class="variable">cs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 调用存储过程的SQL语句</span></span><br><span class="line">            <span class="comment">// 注意：外边有一个大括号。</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;&#123; call mypro(?,?) &#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 对以上的SQL语句进行预编译</span></span><br><span class="line">            cs = conn.prepareCall(sql);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 给占位符 ? 传值</span></span><br><span class="line">            cs.setInt(<span class="number">1</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将第二个占位符 ? 注册为出参</span></span><br><span class="line">            <span class="comment">// 并且出参的数据类型是整数型</span></span><br><span class="line">            cs.registerOutParameter(<span class="number">2</span>, Types.INTEGER);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 调用存储过程</span></span><br><span class="line">            cs.execute();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取执行结果，执行结果在出参上。获取出参的值</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> cs.getInt(<span class="number">2</span>);</span><br><span class="line">            System.out.println(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, cs, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="第07章-JDBC实现员工管理"><a href="#第07章-JDBC实现员工管理" class="headerlink" title="第07章 JDBC实现员工管理"></a>第07章 JDBC实现员工管理</h1><h2 id="数据库表的准备"><a href="#数据库表的准备" class="headerlink" title="数据库表的准备"></a>数据库表的准备</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.powernode.jdbc.utils.DbUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ClassName: JDBCTest22</span></span><br><span class="line"><span class="comment"> * Description: 使用JDBC实现员工信息管理</span></span><br><span class="line"><span class="comment"> * Datetime: 2024/4/14 22:11</span></span><br><span class="line"><span class="comment"> * Author: 老杜@动力节点</span></span><br><span class="line"><span class="comment"> * Version: 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest22</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;欢迎使用员工信息管理，请认真阅读使用说明：&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;本系统的功能主要包括：查看员工列表、查看某个员工详细信息、新增员工、修改员工、删除员工&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入对应的功能编号选择功能：&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;[1]查看员工列表&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;[2]查看某个员工详细信息&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;[3]新增员工&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;[4]修改员工&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;[5]删除员工&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;[0]退出系统&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请输入功能编号：&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">no</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">            <span class="keyword">if</span>(<span class="number">1</span> == no)&#123;</span><br><span class="line">                <span class="comment">// 查看员工列表</span></span><br><span class="line">                System.out.println(<span class="string">&quot;员工信息列表如下：&quot;</span>);</span><br><span class="line">                doList();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">2</span> == no)&#123;</span><br><span class="line">                <span class="comment">// 查看某个员工的详细信息</span></span><br><span class="line">                doList();<span class="comment">//可以显示员工列表</span></span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工的id：&quot;</span>);</span><br><span class="line">                <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> scanner.nextLong();</span><br><span class="line">                System.out.println(<span class="string">&quot;员工[&quot;</span> + id + <span class="string">&quot;]的详细信息如下：&quot;</span>);</span><br><span class="line">                doDetail(id);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">3</span> == no)&#123;</span><br><span class="line">                <span class="comment">// 接收员工的信息</span></span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工姓名：&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工岗位：&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工月薪：&quot;</span>);</span><br><span class="line">                <span class="type">Double</span> <span class="variable">salary</span> <span class="operator">=</span> scanner.nextDouble();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工入职日期：&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">hiredate</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工住址：&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> scanner.next();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 新增员工</span></span><br><span class="line">                doSave(name, job, salary, hiredate, address);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">4</span> == no)&#123;</span><br><span class="line">                <span class="comment">// 显示员工列表</span></span><br><span class="line">                doList();</span><br><span class="line">                <span class="comment">// 显示员工详细信息</span></span><br><span class="line">                System.out.print(<span class="string">&quot;请输入您要修改的员工id：&quot;</span>);</span><br><span class="line">                <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> scanner.nextLong();</span><br><span class="line">                doDetail(id);</span><br><span class="line">                <span class="comment">// 接收新的信息（注意：修改员工时，id不能修改）</span></span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工姓名：&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工岗位：&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工月薪：&quot;</span>);</span><br><span class="line">                <span class="type">Double</span> <span class="variable">salary</span> <span class="operator">=</span> scanner.nextDouble();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工入职日期：&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">hiredate</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入员工住址：&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 修改员工</span></span><br><span class="line">                doModify(id, name, job, salary, hiredate, address);</span><br><span class="line">                System.out.println(<span class="string">&quot;员工[&quot;</span> + id + <span class="string">&quot;]的信息更新成功!!!!&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">5</span> == no)&#123;</span><br><span class="line">                doList();</span><br><span class="line">                System.out.print(<span class="string">&quot;请输入要删除的员工id：&quot;</span>);</span><br><span class="line">                <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> scanner.nextLong();</span><br><span class="line">                <span class="comment">// 删除员工</span></span><br><span class="line">                doDel(id);</span><br><span class="line">                System.out.println(<span class="string">&quot;删除员工[&quot;</span> + id + <span class="string">&quot;]成功了！&quot;</span>);</span><br><span class="line">                doList();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">0</span> == no)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;下次再见！&quot;</span>);</span><br><span class="line">                System.exit(<span class="number">0</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;对不起，您输入的功能暂不支持！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doDel</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from t_employee where id = ?&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            ps.setLong(<span class="number">1</span>, id);</span><br><span class="line">            <span class="comment">// 执行删除SQL</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doModify</span><span class="params">(<span class="type">long</span> id, String name, String job, Double salary, String hiredate, String address)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span>  <span class="string">&quot;update t_employee set name=?, job=?, salary=?, hiredate=?, address=? where id=?&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            <span class="comment">// 给 ? 传值</span></span><br><span class="line">            ps.setString(<span class="number">1</span>, name);</span><br><span class="line">            ps.setString(<span class="number">2</span>, job);</span><br><span class="line">            ps.setDouble(<span class="number">3</span>, salary);</span><br><span class="line">            ps.setString(<span class="number">4</span>, hiredate);</span><br><span class="line">            ps.setString(<span class="number">5</span>, address);</span><br><span class="line">            ps.setLong(<span class="number">6</span>, id);</span><br><span class="line">            <span class="comment">// 执行更新SQL</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doSave</span><span class="params">(String name, String job, Double salary, String hiredate, String address)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span>  <span class="string">&quot;insert into t_employee(name,job,salary,hiredate,address) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            <span class="comment">// 给 ? 传值</span></span><br><span class="line">            ps.setString(<span class="number">1</span>, name);</span><br><span class="line">            ps.setString(<span class="number">2</span>, job);</span><br><span class="line">            ps.setDouble(<span class="number">3</span>, salary);</span><br><span class="line">            ps.setString(<span class="number">4</span>, hiredate);</span><br><span class="line">            ps.setString(<span class="number">5</span>, address);</span><br><span class="line">            <span class="comment">// 执行保存SQL</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> ps.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doDetail</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from t_employee where id = ?&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            ps.setLong(<span class="number">1</span>, id);</span><br><span class="line">            rs = ps.executeQuery();</span><br><span class="line">           <span class="keyword">if</span> (rs.next())&#123;</span><br><span class="line">               <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">               <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;job&quot;</span>);</span><br><span class="line">               <span class="type">String</span> <span class="variable">hiredate</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;hiredate&quot;</span>);</span><br><span class="line">               <span class="type">Double</span> <span class="variable">salary</span> <span class="operator">=</span> rs.getDouble(<span class="string">&quot;salary&quot;</span>);</span><br><span class="line">               <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;address&quot;</span>);</span><br><span class="line">               System.out.println(<span class="string">&quot;id = &quot;</span> + id);</span><br><span class="line">               System.out.println(<span class="string">&quot;姓名 = &quot;</span> + name);</span><br><span class="line">               System.out.println(<span class="string">&quot;岗位 = &quot;</span> + job);</span><br><span class="line">               System.out.println(<span class="string">&quot;入职日期 = &quot;</span> + hiredate);</span><br><span class="line">               System.out.println(<span class="string">&quot;月薪 = &quot;</span> + salary);</span><br><span class="line">               System.out.println(<span class="string">&quot;住址 = &quot;</span> + address);</span><br><span class="line">           &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doList</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 编写JDBC代码，连接数据库，查询所有的员工信息，展示</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,name,job from t_employee&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            rs = ps.executeQuery();</span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> rs.getLong(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;job&quot;</span>);</span><br><span class="line">                System.out.println(id + <span class="string">&quot;\t&quot;</span> + name + <span class="string">&quot;\t&quot;</span> + job);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="第08章-DAO"><a href="#第08章-DAO" class="headerlink" title="第08章 DAO"></a>第08章 DAO</h1><h2 id="什么是DAO"><a href="#什么是DAO" class="headerlink" title="什么是DAO"></a>什么是DAO</h2><p>DAO是：Data Access Object，翻译为：数据访问对象。<br>一种JavaEE的设计模式，专门用来做数据增删改查的类。<br>在实际的开发中，通常我们会将数据库的操作封装为一个单独的DAO去完成，这样做的目的是：提高代码的复用性，另外也可以降低程序的耦合度，提高扩展力。<br>例如：操作用户数据的叫做UserDao，操作员工数据的叫做EmployeeDao，操作产品数据的叫做ProductDao，操作订单数据的叫做OrderDao等。</p>
<h2 id="使用DAO改造员工信息管理"><a href="#使用DAO改造员工信息管理" class="headerlink" title="使用DAO改造员工信息管理"></a>使用DAO改造员工信息管理</h2><h3 id="定义Employee封装数据"><a href="#定义Employee封装数据" class="headerlink" title="定义Employee封装数据"></a>定义Employee封装数据</h3><p>Employee类是一个Java Bean，这个类被称为bean，或者pojo类，专门用来封装员工的信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DbUtils</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 工具类的构造方法一般都是私有化的，因为工具类中的一般都是静态的，</span></span><br><span class="line"><span class="comment">     * 工具类就是为了方便编程，所以工具类中的方法都是直接采用“类名.”</span></span><br><span class="line"><span class="comment">     * 的方式访问，因此不需要new对象。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">DbUtils</span><span class="params">()</span>&#123;&#125;<span class="comment">//工具类的构造方法私有化</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 静态变量，因为这些将来要在下面的静态代码块和构造方法里用，所以定义成静态变量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String user;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 静态代码块</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// 在这里读取属性配置文件，给静态变量赋值</span></span><br><span class="line">        <span class="type">ResourceBundle</span> <span class="variable">bundle</span> <span class="operator">=</span> ResourceBundle.getBundle(<span class="string">&quot;com.powernode.jdbc.jdbc01&quot;</span>);</span><br><span class="line">        driver = bundle.getString(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        url = bundle.getString(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        user = bundle.getString(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        password = bundle.getString(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 想要让注册驱动只执行一次</span></span><br><span class="line">        <span class="comment">// 在类加载的时候，注册驱动，对于整个应用程序来说，注册驱动只需要做一次即可。所以选择静态代码块。</span></span><br><span class="line">        <span class="comment">// 静态代码块在类加载时执行，并且只执行一次。</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(driver);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取数据库连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 释放资源</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> conn 连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stmt 数据库操作对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> rs 结果集对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt, ResultSet rs)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (stmt != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="定义EmployeeDao"><a href="#定义EmployeeDao" class="headerlink" title="定义EmployeeDao"></a>定义EmployeeDao</h3><p>定义五个方法，分别完成五个功能：新增，修改，删除，查看一个，查看所有。增删改查也被简称为：CRUD。C:Create 增,R:Read 查，U:Update 改，D:Delete 删</p>
<p>注意：</p>
<ul>
<li>DAO不负责任何业务逻辑的处理。只负责CRUD操作。</li>
<li>DAO是JavaEE的设计模式之一。</li>
<li>DAO中方法名起名也有讲究，一般都是以：insert delete update select开头。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeDao</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新增员工</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee 员工数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 1表示新增了1条记录。返回其他值表示新增失败。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insert</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_employee(name,job,salary,hiredate,address) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            ps.setString(<span class="number">1</span>, employee.getName());</span><br><span class="line">            ps.setString(<span class="number">2</span>, employee.getJob());</span><br><span class="line">            ps.setDouble(<span class="number">3</span>, employee.getSalary());</span><br><span class="line">            ps.setString(<span class="number">4</span>, employee.getHiredate());</span><br><span class="line">            ps.setString(<span class="number">5</span>, employee.getAddress());</span><br><span class="line">            count = ps.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id删除员工信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 员工id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 1表示删除成功，其他值表示删除失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteByid</span><span class="params">(Long id)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from t_employee where id = ?&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            ps.setLong(<span class="number">1</span>, id);</span><br><span class="line">            count = ps.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改员工信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> newEmployee 新的员工信息（注意：新的员工信息和旧的员工信息id是不变的。）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 1表示修改成功，其他值表示修改失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(Employee newEmployee)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update t_employee set name=?, job=?, salary=?, hiredate=?, address=? where id=?&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            ps.setString(<span class="number">1</span>, newEmployee.getName());</span><br><span class="line">            ps.setString(<span class="number">2</span>, newEmployee.getJob());</span><br><span class="line">            ps.setDouble(<span class="number">3</span>, newEmployee.getSalary());</span><br><span class="line">            ps.setString(<span class="number">4</span>, newEmployee.getHiredate());</span><br><span class="line">            ps.setString(<span class="number">5</span>, newEmployee.getAddress());</span><br><span class="line">            ps.setLong(<span class="number">6</span>, newEmployee.getId());</span><br><span class="line">            count = ps.executeUpdate();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id获取员工信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 员工id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 员工信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Employee <span class="title function_">selectById</span><span class="params">(Long id)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select name,job,salary,hiredate,address from t_employee where id = ?&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            ps.setLong(<span class="number">1</span>, id);</span><br><span class="line">            rs = ps.executeQuery();</span><br><span class="line">            <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">                <span class="comment">// 完成数据的封装，将数据库表查询出来的数据封装成员工对象。</span></span><br><span class="line">                <span class="comment">//有数据就需要返回个对象，new出来然后赋值</span></span><br><span class="line">                employee = <span class="keyword">new</span> <span class="title class_">Employee</span>();</span><br><span class="line">                employee.setId(id);</span><br><span class="line">                employee.setName(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">                employee.setJob(rs.getString(<span class="string">&quot;job&quot;</span>));</span><br><span class="line">                employee.setSalary(rs.getDouble(<span class="string">&quot;salary&quot;</span>));</span><br><span class="line">                employee.setHiredate(rs.getString(<span class="string">&quot;hiredate&quot;</span>));</span><br><span class="line">                employee.setAddress(rs.getString(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, rs);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> employee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取所有员工信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 员工列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">selectAll</span><span class="params">()</span>&#123;<span class="comment">//一次性全返回</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        List&lt;Employee&gt; employeeList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DbUtils.getConnection();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select id,name,job,salary,hiredate,address from t_employee&quot;</span>;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            rs = ps.executeQuery();</span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                <span class="comment">// 完成数据的封装，将数据库表查询出来的数据封装成员工对象。</span></span><br><span class="line">                <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Employee</span>();</span><br><span class="line">                employee.setId(rs.getLong(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">                employee.setName(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">                employee.setJob(rs.getString(<span class="string">&quot;job&quot;</span>));</span><br><span class="line">                employee.setSalary(rs.getDouble(<span class="string">&quot;salary&quot;</span>));</span><br><span class="line">                employee.setHiredate(rs.getString(<span class="string">&quot;hiredate&quot;</span>));</span><br><span class="line">                employee.setAddress(rs.getString(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">                <span class="comment">// 将员工对象添加到List集合中</span></span><br><span class="line">                employeeList.add(employee);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DbUtils.close(conn, ps, rs);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> employeeList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用dao优化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">EmployeeDao</span> <span class="variable">employeeDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EmployeeDao</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doDel</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">            employeeDao.deleteByid(id);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doModify</span><span class="params">(<span class="type">long</span> id, String name, String job, Double salary, String hiredate, String address)</span> &#123;</span><br><span class="line">            <span class="comment">// update需要传入一个employee对象</span></span><br><span class="line">            <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Employee</span>(id, name, job, salary, hiredate, address);</span><br><span class="line">            employeeDao.update(employee);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doSave</span><span class="params">(String name, String job, Double salary, String hiredate, String address)</span> &#123;</span><br><span class="line">            <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Employee</span>(name, job, salary, hiredate, address);</span><br><span class="line">            employeeDao.insert(employee);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doDetail</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">            <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> employeeDao.selectById(id);</span><br><span class="line">            System.out.println(<span class="string">&quot;id = &quot;</span> + employee.getId());</span><br><span class="line">            System.out.println(<span class="string">&quot;姓名 = &quot;</span> + employee.getName());</span><br><span class="line">            System.out.println(<span class="string">&quot;岗位 = &quot;</span> + employee.getJob());</span><br><span class="line">            System.out.println(<span class="string">&quot;入职日期 = &quot;</span> + employee.getHiredate());</span><br><span class="line">            System.out.println(<span class="string">&quot;月薪 = &quot;</span> + employee.getSalary());</span><br><span class="line">            System.out.println(<span class="string">&quot;住址 = &quot;</span> + employee.getAddress());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doList</span><span class="params">()</span> &#123;</span><br><span class="line">            List&lt;Employee&gt; employees = employeeDao.selectAll();</span><br><span class="line">            System.out.println(<span class="string">&quot;id\tname\tjob&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;----------------------------&quot;</span>);</span><br><span class="line">            <span class="comment">// 遍历List集合</span></span><br><span class="line">            <span class="keyword">for</span> (Employee e : employees) &#123;</span><br><span class="line">                System.out.println(e.getId() + <span class="string">&quot;\t&quot;</span> + e.getName() + <span class="string">&quot;\t&quot;</span> + e.getJob());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="BaseDao的封装"><a href="#BaseDao的封装" class="headerlink" title="BaseDao的封装"></a>BaseDao的封装</h2><p>可以写一个basedao，然后让EmployeeDao继承basedao，调用里面的方法，方法一个是查询，一个是增删改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 这是一个通用的执行insert delete update语句的方法。</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> sql</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> params</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="comment">//这里应该传一个sql语句，而？的参数有可能是一个也可能是多个，用可变长参数</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">executeUpdate</span><span class="params">(String sql, Object... params)</span>&#123;</span><br><span class="line">      <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          conn = DbUtils.getConnection();</span><br><span class="line">          ps = conn.prepareStatement(sql);</span><br><span class="line">          <span class="comment">// 给 ? 占位符传值，因为可能是没有参数的</span></span><br><span class="line">          <span class="keyword">if</span>(params != <span class="literal">null</span> &amp;&amp; params.length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">              <span class="comment">// 有占位符 ?</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">                  ps.setObject(i + <span class="number">1</span>,params[i]);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 执行SQL语句</span></span><br><span class="line">          count = ps.executeUpdate();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">      &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">          DbUtils.close(conn, ps, <span class="literal">null</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> count;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>之前的EmployeeDao就改成</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeDao</span> <span class="keyword">extends</span> <span class="title class_">BaseDao</span>&#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新增员工</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee 员工数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 1表示新增了1条记录。返回其他值表示新增失败。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insert</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">         <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_employee(name,job,salary,hiredate,address) values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> executeUpdate(sql, employee.getName(), employee.getJob(), employee.getSalary(), employee.getHiredate(), employee.getAddress());</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id删除员工信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 员工id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 1表示删除成功，其他值表示删除失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteByid</span><span class="params">(Long id)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from t_employee where id = ?&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> executeUpdate(sql, id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改员工信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> newEmployee 新的员工信息（注意：新的员工信息和旧的员工信息id是不变的。）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 1表示修改成功，其他值表示修改失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(Employee newEmployee)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update t_employee set name=?, job=?, salary=?, hiredate=?, address=? where id=?&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> executeUpdate(sql, newEmployee.getName(), newEmployee.getJob(), newEmployee.getSalary(), newEmployee.getHiredate(), newEmployee.getAddress(),newEmployee.getId());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而查询里的数组是需要创建对象的，但这个对象每次传入的都不一样，比如userDao extends BaseDao，需要传入的就是List<User>，这里就需要使用泛型了，而泛型获取对象是通过反射机制也就是class clazz，clazz.newInstance();</p>
<p>另外只返回一个也可以当做list集合对待<br>可变长参数必须是最后一个</p>
<h1 id="第09章-连接池"><a href="#第09章-连接池" class="headerlink" title="第09章 连接池"></a>第09章 连接池</h1><h2 id="连接池的理解"><a href="#连接池的理解" class="headerlink" title="连接池的理解"></a>连接池的理解</h2><h3 id="不使用连接池有啥问题"><a href="#不使用连接池有啥问题" class="headerlink" title="不使用连接池有啥问题"></a>不使用连接池有啥问题</h3><p>Connection对象是重量级对象，创建Connection对象就是建立两个进程之间的通信，非常耗费资源。一次完整的数据库操作，大部分时间都耗费在连接对象的创建。<br>第一个问题：每一次请求都创建一个Connection连接对象，效率较低。<br>第二个问题：连接对象的数量无法限制。如果连接对象的数量过高，会导致mysql数据库服务器崩溃。</p>
<h3 id="使用连接池来解决什么问题"><a href="#使用连接池来解决什么问题" class="headerlink" title="使用连接池来解决什么问题"></a>使用连接池来解决什么问题</h3><p>提前创建好N个连接对象，将其存放到一个集合中（这个集合就是一个缓存）。<br>用户请求时，需要连接对象直接从连接池中获取，不需要创建连接对象，因此效率较高。<br>另外，连接对象只能从连接池中获取，如果没有空闲的连接对象，只能等待，这样连接对象创建的数量就得到了控制。<br>从连接池拿到的conn对象也要调用close，但是并不是关闭连接，而是归还到连接池里并设置状态为null</p>
<h3 id="javax-sql-DataSource"><a href="#javax-sql-DataSource" class="headerlink" title="javax.sql.DataSource"></a>javax.sql.DataSource</h3><p>连接池有很多，不过所有的连接池都实现了 javax.sql.DataSource 接口。也就是说我们程序员在使用连接池的时候，不管使用哪家的连接池产品，只要面向javax.sql.DataSource接口调用方法即可。</p>
<p>另外，实际上我们也可以自定义属于我们自己的连接池。只要实现DataSource接口即可。</p>
<p>连接池也可以叫做数据源</p>
<h3 id="连接池的属性"><a href="#连接池的属性" class="headerlink" title="连接池的属性"></a>连接池的属性</h3><p>对于一个基本的连接池来说，一般都包含以下几个常见的属性：</p>
<ol>
<li>初始化连接数（initialSize）：连接池初始化时创建的连接数。 </li>
<li>最大连接数（maxActive）：连接池中最大的连接数，也就是连接池所能容纳的最大连接数量，当连接池中的连接数量达到此值时，后续请求会被阻塞并等待连接池中有连接被释放后再处理。 </li>
<li>最小空闲连接数量（minIdle）： 指连接池中最小的空闲连接数，也就是即使当前没有请求，连接池中至少也要保持一定数量的空闲连接，以便应对高并发请求或突发连接请求的情况。</li>
<li>最大空闲连接数量（maxIdle）： 指连接池中最大的空闲连接数，也就是连接池中最多允许保持的空闲连接数量。当连接池中的空闲连接数量达到了maxIdle设定的值后，多余的空闲连接将会被连接池释放掉。</li>
<li>最大等待时间（maxWait）：当连接池中的连接数量达到最大值时，后续请求需要等待的最大时间，如果超过这个时间，则会抛出异常。 </li>
<li>连接有效性检查（testOnBorrow、testOnReturn）：为了确保连接池中只有可用的连接，一些连接池会定期对连接进行有效性检查，这里的属性就是配置这些检查的选项。 </li>
<li>连接的driver、url、user、password等。</li>
</ol>
<p>以上这些属性是连接池中较为常见的一些属性，不同的连接池在实现时可能还会有其他的一些属性，不过大多数连接池都包含了以上几个属性，对于使用者来说需要根据自己的需要进行灵活配置。</p>
<h2 id="常用的连接池"><a href="#常用的连接池" class="headerlink" title="常用的连接池"></a>常用的连接池</h2><p>市面上常用的数据库连接池有许多，以下是其中几种：</p>
<ol>
<li>DBCP（不用了）<ol>
<li>2001年诞生，最早的连接池。</li>
<li>Apache Software Foundation的一个开源项目。</li>
<li>DBCP的设计初衷是为了满足Tomcat服务器对连接池管理的需求。</li>
</ol>
</li>
<li>c3p0（不用了）<ol>
<li>2004年诞生</li>
<li>c3p0是由Steve Waldman于2004年推出的，它是一个高性能、高可靠性、易配置的数据库连接池。c3p0能够提供连接池的容错能力、自动重连等功能，适用于高并发场景和数据量大的应用。</li>
</ol>
</li>
<li>Druid（多功能豪华版）<ol>
<li>2012年诞生</li>
<li>Druid连接池由阿里巴巴集团开发，于2011年底开始对外公开，2012年正式发布。Druid是一个具有高性能、高可靠性、丰富功能的数据库连接池，不仅可以做连接池，还能做监控、分析和管理数据库，支持SQL防火墙、统计分析、缓存和访问控制等功能。</li>
</ol>
</li>
<li>HikariCP（专精的非豪华版<ol>
<li>2012年诞生</li>
<li>HikariCP是由Brett Wooldridge于2012年创建的开源项目，它被认为是Java语言下最快的连接池之一，具有快速启动、低延迟、低资源消耗等优点。HikariCP连接池适用于高并发场景和云端应用。</li>
<li>很单纯的一个连接池，这个产品只做连接池应该做的，其他的不做。所以性能是极致的。相对于Druid来说，它更加轻量级。</li>
<li>Druid连接池在连接管理之外提供了更多的功能，例如SQL防火墙、统计分析、缓存、访问控制等，适用于在数据库访问过程中，需要进行细粒度控制的场景</li>
<li>HikariCP则更侧重于性能方面的优化，对各种数据库的兼容性也更好</li>
</ol>
</li>
<li>BoneCP<ol>
<li>2015年诞生</li>
<li>BoneCP是一款Java语言下的高性能连接池，于2015年由Dominik Gruntz在GitHub上发布。BoneCP具有分布式事务、连接空闲检查、SQL语句跟踪和性能分析、特定类型的连接池等特点。BoneCP连接池适用于大型应用系统和高并发的负载场景</li>
</ol>
</li>
</ol>
<h2 id="连接池的使用"><a href="#连接池的使用" class="headerlink" title="连接池的使用"></a>连接池的使用</h2><h3 id="Druid的使用"><a href="#Druid的使用" class="headerlink" title="Druid的使用"></a>Druid的使用</h3><p>第一步：引入Druid的jar包<br><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1713164785681-0fdb049c-2a06-40e4-83cd-bfc876d8b696.png#averageHue=%23fdfcfb&clientId=u80e8c903-6055-4&from=paste&height=66&id=u7fa2aef7&originHeight=66&originWidth=180&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1594&status=done&style=shadow&taskId=u1da80432-7b19-4905-a407-56e3e288d88&title=&width=180" alt="image.png"><br>第二步：配置文件<br>在类的根路径下创建一个属性资源文件：jdbc.properties，也可以在JDBC_study目录下建立一个文件夹叫resources，然后右击选择<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250413145501319.png" alt="image-20250413145501319">等同于放在src根目录下面</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/jdbc</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">1234</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">5</span></span><br><span class="line"><span class="attr">minIdle</span>=<span class="string">10</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">20</span></span><br></pre></td></tr></table></figure>

<p>第三步：编写代码，从连接池中获取连接对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;<span class="comment">//注意导包不要导错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取一个输入流，指向一个属性资源文件</span></span><br><span class="line"><span class="comment">//当前线程的类加载器，去累的根路径下加载资源，并以流的方式返回</span></span><br><span class="line"><span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span>Thread.currentThread().getContextClassLoader().getResourceAsStream(<span class="string">&quot;jdbc.properties&quot;</span>);</span><br><span class="line"><span class="comment">// 创建属性类对象</span></span><br><span class="line"><span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"><span class="comment">// 将属性配置文件的资源加载到属性类对象当中</span></span><br><span class="line">prop.load(in);</span><br><span class="line"><span class="comment">// 获取连接池对象，德鲁伊数据来源工厂，里面传入一个properties对象</span></span><br><span class="line"><span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> DruidDataSourceFactory.createDataSource(prop);</span><br><span class="line"><span class="comment">// 通过连接池获取连接对象</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> dataSource.getConnection();</span><br><span class="line">System.out.println(conn);</span><br><span class="line"><span class="comment">// CRUD操作....</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭资源（这个不是真正的关闭，只是将连接池中的连接对象状态修改为空闲）</span></span><br><span class="line">conn.close();</span><br></pre></td></tr></table></figure>

<p>第四步：关闭连接<br>仍然调用Connection的close()方法，但是这个close()方法并不是真正的关闭连接，只是将连接归还到连接池，让其称为空闲连接对象。这样其他线程可以继续使用该空闲连接。</p>
<h3 id="DbUtils的升级改造"><a href="#DbUtils的升级改造" class="headerlink" title="DbUtils的升级改造"></a>DbUtils的升级改造</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DbUtils2</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">DbUtils2</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DataSource dataSource;<span class="comment">//在类加载的静态代码块里被赋值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> Thread.currentThread().getContextClassLoader().getResourceAsStream(<span class="string">&quot;jdbc.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">prop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            prop.load(in);</span><br><span class="line">            dataSource = DruidDataSourceFactory.createDataSource(prop);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取数据库连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> dataSource.getConnection();<span class="comment">//返回的是conn</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 释放资源</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> conn 连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> stmt 数据库操作对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> rs 结果集对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection conn, Statement stmt, ResultSet rs)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (stmt != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HikariCP的使用"><a href="#HikariCP的使用" class="headerlink" title="HikariCP的使用"></a>HikariCP的使用</h3><p>第一步：引入jar包</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/NoteImg/JDBC/JDBC/image-20250413152910785.png" alt="image-20250413152910785"> </p>
<p>第二步：编写配置文件<br>在类的根路径下创建一个属性资源文件：jdbc2.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbcUrl</span>=<span class="string">jdbc:mysql://localhost:3306/jdbc</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">1234</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">minimumIdle</span>=<span class="string">5</span></span><br><span class="line"><span class="attr">maximumPoolSize</span>=<span class="string">20</span></span><br></pre></td></tr></table></figure>

<p>第三步：编写代码，从连接池中获取连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCTest26</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> Thread.currentThread().getContextClassLoader().getResourceAsStream(<span class="string">&quot;jdbc2.properties&quot;</span>);</span><br><span class="line">        <span class="comment">// 创建属性类对象</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        properties.load(in);</span><br><span class="line">        <span class="comment">// 创建配置信息对象</span></span><br><span class="line">        <span class="type">HikariConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HikariConfig</span>(properties);</span><br><span class="line">        <span class="comment">// 获取连接池</span></span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HikariDataSource</span>(config);</span><br><span class="line"></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> dataSource.getConnection();</span><br><span class="line">        System.out.println(conn);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">        conn.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第四步：关闭连接（调用conn.close()，将连接归还到连接池，连接对象为空闲状态。）</p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="-1"><a href="#-1" class="headerlink" title=""></a></h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/Shelter67">Shelter</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://localhost:4000/posts/8fe47ff4.html">http://localhost:4000/posts/8fe47ff4.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://localhost:4000" target="_blank">Shelter</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/jdbc/">jdbc</a><a class="post-meta__tags" href="/tags/sql/">sql</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.dreamshelter.cn/blog/source/img/cover/3.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/7273cdc.html" title="Maven"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/16.jpg" onerror="onerror=null;src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Maven</div></div><div class="info-2"><div class="info-item-1">什么是MavenMaven的概念Maven 是 Apache 软件基金会组织维护的一款自动化构建工具，专注服务于 Java 平台的项目构建和依赖管理。Maven 这个单词的本意是：专家，内行。 它是一个一键式的自动化的构建工具.首先,Maven可以自动的帮助我们下载jar包.其次可以进行多个项目同时的编译运行.还有在开发的过程中需要进行测试运行,Maven提供了自动化的测试插件帮助我们进行项目测试功能的运行.最后项目是需要进行资源文件,配置文件的整合,来进行打包和部署,Maven可以轻松搞定. 为什么要使用Maven我们知道，项目开发不仅仅是写写代码而已，期间会伴随着各种必不可少的事情要做，例如：  我们需要引用各种 jar 包，尤其是比较大的工程，引用的 jar 包往往有几十个乃至上百个，每个都要到不同的官网去下载，而且每次用到的 jar 包，都需要手动引入工程目录，而且经常遇到各种让人抓狂的 jar 包冲突，版本冲突，Maven可以自动下载jar包及依赖包添加到项目中，大大减轻了工作负担。 我们开发的 Java 文件，都是需要将它编译成二进制字节码文件。好在这项工作可以由各种...</div></div></div></a><a class="pagination-related" href="/posts/14ea6df7.html" title="数据库"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/28.png" onerror="onerror=null;src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">数据库</div></div><div class="info-2"><div class="info-item-1">数据库概述什么是数据库 数据库对应的英文单词是DataBase，简称DB java的端口号：8080，mysql的3306  数据库类型 关系型数据库 关系型数据库是依据关系模型来创建的数据库。所谓关系模型就是“一对一、一对多、多对多”等关系模型   非关系型数据库（NoSQL）  数据库管理系统 数据库管理系统（Database Management System，简称DBMS）是为管理数据库而设计的电脑软件系统，一般具有存储、截取、安全保障、备份等基础功能。 数据库管理系统是数据库系统的核心组成部分，主要完成对数据库的操作与管理功能，实现数据库对象的创建、数据库存储数据的查询、添加、修改与删除操作和数据库的用户管理、权限管理等。 常见的数据库管理系统有：MySQL、Oracle、DB2、MS SQL Server、SQLite、PostgreSQL、Sybase等。  什么是SQL 结构化查询语言（Structured Query Language）简称SQL，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统。 DBMS...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/14ea6df7.html" title="数据库"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/28.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-01</div><div class="info-item-2">数据库</div></div><div class="info-2"><div class="info-item-1">数据库概述什么是数据库 数据库对应的英文单词是DataBase，简称DB java的端口号：8080，mysql的3306  数据库类型 关系型数据库 关系型数据库是依据关系模型来创建的数据库。所谓关系模型就是“一对一、一对多、多对多”等关系模型   非关系型数据库（NoSQL）  数据库管理系统 数据库管理系统（Database Management System，简称DBMS）是为管理数据库而设计的电脑软件系统，一般具有存储、截取、安全保障、备份等基础功能。 数据库管理系统是数据库系统的核心组成部分，主要完成对数据库的操作与管理功能，实现数据库对象的创建、数据库存储数据的查询、添加、修改与删除操作和数据库的用户管理、权限管理等。 常见的数据库管理系统有：MySQL、Oracle、DB2、MS SQL Server、SQLite、PostgreSQL、Sybase等。  什么是SQL 结构化查询语言（Structured Query Language）简称SQL，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统。 DBMS...</div></div></div></a><a class="pagination-related" href="/posts/4d910bb8.html" title="Servlet-JSP-课堂笔记"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/10.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-14</div><div class="info-item-2">Servlet-JSP-课堂笔记</div></div><div class="info-2"><div class="info-item-1">关于直播 什么时间直播？ 晚上8:00到10:00   每周直播几天？ 3天（周一、周三、周五） 本周比较特殊：周四周五周六三天直播，从下周开始就是一三五直播。   直播什么内容？ 从JavaWEB开始。（Servlet为核心，从Servlet开始学习。） JSP（JSP使用较少了，但是还有用，所以时间上少一些。快速地学习一下JSP。） AJAX（异步通信技术。） jQuery（JavaScript库。） MyBatis Spring SpringMVC SpringBoot SpringCloud ….    需要提前准备了哪些技术，接下来的课才能听懂？ JavaSE（Java语言的标准版，Java提供的最基本的类库） Java的开发环境搭建 Java的基础语法 Java的面向对象 数组 常用类 异常 集合 多线程 IO流 反射机制 注解Annotation …..   MySQL（数据库） 最基本的要求是：能够编写增删改查等简单的SQL语句即可。   JDBC（Java语言链接数据库） 这是一套Java语言链接数据库的接口。   WEB前端（会一些） HTML（网页） CSS...</div></div></div></a><a class="pagination-related" href="/posts/9c933fc9.html" title="学习Maven"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/12.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-14</div><div class="info-item-2">学习Maven</div></div><div class="info-2"><div class="info-item-1">maven简介https://www.bilibili.com/video/BV1uApMeWErY?spm_id_from=333.788.videopod.sections&amp;vd_source=b0128143be22d1783a42f5fbf34d9d25 pom.xml 定义了项目的配置、依赖、插件、以及构建的过程 Maven仓库就是存放jiar包的地方，按照作用范围可以分为  本地仓库  就是电脑上的本地目录，默认在  一定要是一个没有中文的路径下。    远程仓库  一般是一个公司或者组织内部搭建的一个仓库，用来给内部的项目提供统一的依赖管理，避免jar包的重复下载 也可以通过中央仓库下载，是Maven官方维护的一个仓库 ，开源jar包都可以在这里找到   私服   maven安装和下载Maven官网：https://maven.apache.org/ Maven下载地址：https://maven.apache.org/download.cgi Nexus下载地址：https://help.sonatype.com/en/download.html 环境变量...</div></div></div></a><a class="pagination-related" href="/posts/da77c56c.html" title="MVC架构设计模式"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-11-15</div><div class="info-item-2">MVC架构设计模式</div></div><div class="info-2"><div class="info-item-1">不使用mvc架构的缺陷在不使用MVC架构模式的前提下，完成银行账户转账。分析这个程序存在哪些问题?  缺点1&gt;代码的复用性太差。(代码的重用性太差) 导致缺点1的原因? 因为没有进行”职能分工”，没有独立组件的概念，所以没有办法进行代码复用。代码和代码之间的耦合度太高，扩展力太差。  缺点2&gt;耦合度高，导致了代码很难护展。  缺点3&gt;操作数据库的代码和业务逻辑混杂在一起，很容易出错。编写代码的时候很容易出错，无法专注业务逻辑的编写。   分析以下AccountTransferServlet他都负责了什么?   负责了数据接收    负责了核心的业务处理    负责了数据库表中数据的CRUD操作 (Create【增】 Retrieve【査】 Update【改】 Delete【删】)    负责了页面的数据展示    公司中一般都有很多员工，每个员工都各司其职，为什么要这样?	保洁阿姨负责打扫卫生	杜老师负责教学大纲的指定	郭老师负责上课	王老师负责学习就业*我们公司只有一个员工。这个员工负责所有的事情。生病了。–&gt;公司倒闭了。 理论基础 javaEE设计模式...</div></div></div></a><a class="pagination-related" href="/posts/7d713e54.html" title="Spirng速成"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/29.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-18</div><div class="info-item-2">Spirng速成</div></div><div class="info-2"><div class="info-item-1"> 给分成了三层，后面的mapper就是mybatis的，如果要获取其他对象就需要在这里面创建类，比如BookService2 b &#x3D; new BookService2这样，但只要一改名字，就需要把所有的对象名字都改，这样耦合度太高。就需要用到spring容器来进行统一管理 ioc就是控制反转的意思，把创建对象的权利交给spring容器  会有一个配置文件叫applicationcontext.xml，里面存放了bean这个，id就是名字，class是类型，然后他自动通过反射机制创建对象，然后放到spring容器里，这个容器可以理解成一个筐，苹果放一个筐梨放一个筐，然后再从这个容器里读取到java程序    1234&lt;bean id = &quot;b&quot; class = &#x27;com.msb.pojo.Book&#x27;&gt;	&lt;property name=&quot;id&quot; value=&quot;1&quot;&gt;&lt;/property&gt;    &lt;property name=&quot;name&quot;...</div></div></div></a><a class="pagination-related" href="/posts/6c92115f.html" title="Spring"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/33.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-20</div><div class="info-item-2">Spring</div></div><div class="info-2"><div class="info-item-1">十五、面向切面编程AOPIoC使软件组件松耦合。AOP让你能够捕捉系统中经常使用的功能，把它转化成组件。AOP（Aspect Oriented Programming）：面向切面编程，面向方面编程。（AOP是一种编程技术）AOP是对OOP的补充延伸。AOP底层使用的就是动态代理来实现的。Spring的AOP使用的动态代理是：JDK动态代理 + CGLIB动态代理技术。Spring在这两种动态代理中灵活切换，如果是代理接口，会默认使用JDK动态代理，如果要代理某个类，这个类没有实现接口，就会切换使用CGLIB。当然，你也可以强制通过一些配置让Spring只使用CGLIB。 15.1 AOP介绍一般一个系统当中都会有一些系统服务，例如：日志、事务管理、安全等。这些系统服务被称为：交叉业务这些交叉业务几乎是通用的，不管你是做银行账户转账，还是删除用户数据。日志、事务管理、安全，这些都是需要做的。如果在每一个业务处理过程当中，都掺杂这些交叉业务代码进去的话，存在两方面问题：  第一：交叉业务代码在多个业务流程中反复出现，显然这个交叉业务代码没有得到复用。并且修改这些交叉业务代码的话，需要...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/touxiang.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Shelter</div><div class="author-info-description">记录自己的成长日志</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Shelter67"><i class="fab fa-github"></i><span>没有什么star的github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Shelter67" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1830191738@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/8416212" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #fb7299;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的小小博客！都是基于hexo框架使用，魔改了一些地方，表现得有些二次元，有个博客希望能在未来工作简历上成为加分项吧，但是弄起来还真的挺好玩的</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC01%E7%AB%A0-JDBC%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">第01章 JDBC概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFJDBC"><span class="toc-number">1.1.</span> <span class="toc-text">什么是JDBC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JDBC%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">JDBC原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9FJDBC%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.3.</span> <span class="toc-text">模拟JDBC接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9FJDBC%E6%8E%A5%E5%8F%A3-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">模拟JDBC接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%A8%8B%E5%BA%8F%E6%A8%A1%E6%8B%9FJDBC%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.3.2.</span> <span class="toc-text">编写程序模拟JDBC接口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AECLASSPATH"><span class="toc-number">1.4.</span> <span class="toc-text">配置CLASSPATH</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JDBC%E6%8E%A5%E5%8F%A3%E5%9C%A8%E5%93%AA"><span class="toc-number">1.4.1.</span> <span class="toc-text">JDBC接口在哪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A9%B1%E5%8A%A8%E5%9C%A8%E5%93%AA"><span class="toc-number">1.4.2.</span> <span class="toc-text">驱动在哪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E6%9E%9C%E4%BD%BF%E7%94%A8%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8%E5%BC%80%E5%8F%91"><span class="toc-number">1.4.3.</span> <span class="toc-text">如果使用文本编辑器开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E6%9E%9C%E4%BD%BF%E7%94%A8IDEA%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91"><span class="toc-number">1.4.4.</span> <span class="toc-text">如果使用IDEA工具开发</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC02%E7%AB%A0-JDBC%E7%9A%84%E6%96%B0%E5%A2%9E%E4%BF%AE%E6%94%B9%E5%88%A0%E9%99%A4"><span class="toc-number">2.</span> <span class="toc-text">第02章 JDBC的新增修改删除</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JDBC%E7%BC%96%E7%A8%8B%E5%85%AD%E6%AD%A5"><span class="toc-number">2.1.</span> <span class="toc-text">JDBC编程六步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E5%87%86%E5%A4%87"><span class="toc-number">2.2.</span> <span class="toc-text">数据的准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PowerDesigner%E4%B8%8ENavicat-for-MySQL%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.2.1.</span> <span class="toc-text">PowerDesigner与Navicat for MySQL的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PowerDesigner%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">2.2.2.</span> <span class="toc-text">PowerDesigner工具的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8PowerDesigner%E8%BF%9B%E8%A1%8C%E7%89%A9%E7%90%86%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1"><span class="toc-number">2.2.3.</span> <span class="toc-text">使用PowerDesigner进行物理数据建模</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JDBC%E5%AE%8C%E6%88%90%E6%96%B0%E5%A2%9E%E6%93%8D%E4%BD%9C"><span class="toc-number">2.3.</span> <span class="toc-text">JDBC完成新增操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JDBC%E7%BC%96%E7%A8%8B%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E6%B3%A8%E5%86%8C%E9%A9%B1%E5%8A%A8"><span class="toc-number">2.3.1.</span> <span class="toc-text">JDBC编程第一步：注册驱动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JDBC%E7%BC%96%E7%A8%8B%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E8%8E%B7%E5%8F%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.3.2.</span> <span class="toc-text">JDBC编程第二步：获取连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.3.3.</span> <span class="toc-text">代码实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JDBC%E7%BC%96%E7%A8%8B%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.3.4.</span> <span class="toc-text">JDBC编程第三步：获取数据库操作对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JDBC%E7%BC%96%E7%A8%8B%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E6%89%A7%E8%A1%8CSQL"><span class="toc-number">2.3.5.</span> <span class="toc-text">JDBC编程第四步：执行SQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JDBC%E7%BC%96%E7%A8%8B%E7%AC%AC%E5%85%AD%E6%AD%A5%EF%BC%9A%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90"><span class="toc-number">2.3.6.</span> <span class="toc-text">JDBC编程第六步：释放资源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90"><span class="toc-number">2.3.6.1.</span> <span class="toc-text">为什么要释放资源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8A%E6%94%BE%E8%B5%84%E6%BA%90%E7%9A%84%E5%8E%9F%E5%88%99"><span class="toc-number">2.3.6.2.</span> <span class="toc-text">释放资源的原则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.3.6.3.</span> <span class="toc-text">代码如何实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFURL"><span class="toc-number">2.3.7.</span> <span class="toc-text">什么是URL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JDBC%E8%BF%9E%E6%8E%A5MySQL%E6%97%B6%E7%9A%84URL%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.3.8.</span> <span class="toc-text">JDBC连接MySQL时的URL格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-URL%E4%B8%AD%E7%9A%84%E5%85%B6%E5%AE%83%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">2.3.9.</span> <span class="toc-text">MySQL URL中的其它常用配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E9%A9%B1%E5%8A%A8%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">2.4.</span> <span class="toc-text">注册驱动的常用方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JDBC-4-0%E5%90%8E%E4%B8%8D%E7%94%A8%E6%89%8B%E5%8A%A8%E6%B3%A8%E5%86%8C%E9%A9%B1%E5%8A%A8%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">2.5.</span> <span class="toc-text">JDBC 4.0后不用手动注册驱动（了解）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IDEA%E5%88%9B%E5%BB%BAJDBK"><span class="toc-number">2.6.</span> <span class="toc-text">IDEA创建JDBK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-number">2.7.</span> <span class="toc-text">动态配置连接数据库的信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%BF%9E%E6%8E%A5%E7%9A%84%E5%85%B6%E4%BB%96%E6%96%B9%E5%BC%8F%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">2.8.</span> <span class="toc-text">获取连接的其他方式（了解）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#getConnection-String-url"><span class="toc-number">2.8.1.</span> <span class="toc-text">getConnection(String url)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getConnection-String-url-Properties-info"><span class="toc-number">2.8.2.</span> <span class="toc-text">getConnection(String url, Properties info)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC03%E7%AB%A0-JDBC%E7%9A%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.</span> <span class="toc-text">第03章 JDBC的查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JDBC%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">3.1.</span> <span class="toc-text">JDBC的查询操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%88%97%E7%B4%A2%E5%BC%95%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%EF%BC%88%E4%BB%A5String%E7%B1%BB%E5%9E%8B%E8%8E%B7%E5%8F%96%EF%BC%89"><span class="toc-number">3.1.1.</span> <span class="toc-text">通过列索引获取数据（以String类型获取）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%88%97%E5%90%8D%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%EF%BC%88%E4%BB%A5String%E7%B1%BB%E5%9E%8B%E8%8E%B7%E5%8F%96%EF%BC%89"><span class="toc-number">3.1.2.</span> <span class="toc-text">通过列名获取数据（以String类型获取）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E6%8C%87%E5%AE%9A%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">3.1.3.</span> <span class="toc-text">以指定的类型获取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%BB%93%E6%9E%9C%E9%9B%86%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E4%BF%A1%E6%81%AF%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">3.1.4.</span> <span class="toc-text">获取结果集的元数据信息（了解）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%96%B0%E5%A2%9E%E8%A1%8C%E7%9A%84%E4%B8%BB%E9%94%AE%E5%80%BC"><span class="toc-number">3.1.5.</span> <span class="toc-text">获取新增行的主键值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8IDEA%E5%B7%A5%E5%85%B7%E7%B1%BB-DbUtils-%E7%BC%96%E5%86%99JDBC%E7%A8%8B%E5%BA%8F"><span class="toc-number">3.2.</span> <span class="toc-text">使用IDEA工具类(DbUtils)编写JDBC程序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC04%E7%AB%A0-SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">4.</span> <span class="toc-text">第04章 SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E9%97%AE%E9%A2%98"><span class="toc-number">4.1.</span> <span class="toc-text">SQL注入问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3SQL%E6%B3%A8%E5%85%A5%E9%97%AE%E9%A2%98"><span class="toc-number">4.2.</span> <span class="toc-text">解决SQL注入问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PreparedStatement%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.3.</span> <span class="toc-text">PreparedStatement的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E6%93%8D%E4%BD%9C"><span class="toc-number">4.3.1.</span> <span class="toc-text">新增操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C"><span class="toc-number">4.3.2.</span> <span class="toc-text">修改操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C"><span class="toc-number">4.3.3.</span> <span class="toc-text">删除操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.3.4.</span> <span class="toc-text">模糊查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.3.5.</span> <span class="toc-text">分页查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#blob%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8F%92%E5%85%A5%E5%92%8C%E8%AF%BB%E5%8F%96"><span class="toc-number">4.3.6.</span> <span class="toc-text">blob数据的插入和读取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JDBC%E6%89%B9%E5%A4%84%E7%90%86%EF%BC%88%E6%8F%92%E5%85%A5%EF%BC%89%E6%93%8D%E4%BD%9C"><span class="toc-number">4.4.</span> <span class="toc-text">JDBC批处理（插入）操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E4%BD%BF%E7%94%A8%E6%89%B9%E5%A4%84%E7%90%86"><span class="toc-number">4.4.1.</span> <span class="toc-text">不使用批处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%89%B9%E5%A4%84%E7%90%86"><span class="toc-number">4.4.2.</span> <span class="toc-text">使用批处理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC05%E7%AB%A0-JDBC%E4%BA%8B%E5%8A%A1"><span class="toc-number">5.</span> <span class="toc-text">第05章 JDBC事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E5%8A%A1"><span class="toc-number">5.1.</span> <span class="toc-text">什么是事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%BD%AC%E8%B4%A6%E6%A1%88%E4%BE%8B%E6%BC%94%E7%A4%BA%E4%BA%8B%E5%8A%A1"><span class="toc-number">5.2.</span> <span class="toc-text">使用转账案例演示事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%92%8C%E6%95%B0%E6%8D%AE%E7%9A%84%E5%87%86%E5%A4%87"><span class="toc-number">5.2.1.</span> <span class="toc-text">表和数据的准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E8%BD%AC%E8%B4%A6%E5%8A%9F%E8%83%BD"><span class="toc-number">5.2.2.</span> <span class="toc-text">实现转账功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JDBC%E4%BA%8B%E5%8A%A1%E9%BB%98%E8%AE%A4%E6%98%AF%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E7%9A%84"><span class="toc-number">5.2.3.</span> <span class="toc-text">JDBC事务默认是自动提交的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6"><span class="toc-number">5.2.4.</span> <span class="toc-text">添加事务控制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEJDBC%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">5.3.</span> <span class="toc-text">设置JDBC事务隔离级别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC06%E7%AB%A0-JDBC%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">6.</span> <span class="toc-text">第06章 JDBC调用存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8MySQL%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">6.1.</span> <span class="toc-text">在MySQL中创建存储过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8JDBC%E4%BB%A3%E7%A0%81%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">6.2.</span> <span class="toc-text">使用JDBC代码调用存储过程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC07%E7%AB%A0-JDBC%E5%AE%9E%E7%8E%B0%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">第07章 JDBC实现员工管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%9A%84%E5%87%86%E5%A4%87"><span class="toc-number">7.1.</span> <span class="toc-text">数据库表的准备</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC08%E7%AB%A0-DAO"><span class="toc-number">8.</span> <span class="toc-text">第08章 DAO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFDAO"><span class="toc-number">8.1.</span> <span class="toc-text">什么是DAO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8DAO%E6%94%B9%E9%80%A0%E5%91%98%E5%B7%A5%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86"><span class="toc-number">8.2.</span> <span class="toc-text">使用DAO改造员工信息管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89Employee%E5%B0%81%E8%A3%85%E6%95%B0%E6%8D%AE"><span class="toc-number">8.2.1.</span> <span class="toc-text">定义Employee封装数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89EmployeeDao"><span class="toc-number">8.2.2.</span> <span class="toc-text">定义EmployeeDao</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BaseDao%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-number">8.3.</span> <span class="toc-text">BaseDao的封装</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC09%E7%AB%A0-%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">9.</span> <span class="toc-text">第09章 连接池</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">9.1.</span> <span class="toc-text">连接池的理解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E4%BD%BF%E7%94%A8%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%9C%89%E5%95%A5%E9%97%AE%E9%A2%98"><span class="toc-number">9.1.1.</span> <span class="toc-text">不使用连接池有啥问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%9D%A5%E8%A7%A3%E5%86%B3%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"><span class="toc-number">9.1.2.</span> <span class="toc-text">使用连接池来解决什么问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#javax-sql-DataSource"><span class="toc-number">9.1.3.</span> <span class="toc-text">javax.sql.DataSource</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-number">9.1.4.</span> <span class="toc-text">连接池的属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">9.2.</span> <span class="toc-text">常用的连接池</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">9.3.</span> <span class="toc-text">连接池的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Druid%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">9.3.1.</span> <span class="toc-text">Druid的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DbUtils%E7%9A%84%E5%8D%87%E7%BA%A7%E6%94%B9%E9%80%A0"><span class="toc-number">9.3.2.</span> <span class="toc-text">DbUtils的升级改造</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HikariCP%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">9.3.3.</span> <span class="toc-text">HikariCP的使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">10.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-1"><span class="toc-number">11.</span> <span class="toc-text"></span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/da77c56c.html" title="MVC架构设计模式"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/2.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="MVC架构设计模式"/></a><div class="content"><a class="title" href="/posts/da77c56c.html" title="MVC架构设计模式">MVC架构设计模式</a><time datetime="2026-11-14T16:24:00.000Z" title="发表于 2026-11-15 00:24:00">2026-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e25feb6e.html" title="黑马程序员SSM"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/31.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="黑马程序员SSM"/></a><div class="content"><a class="title" href="/posts/e25feb6e.html" title="黑马程序员SSM">黑马程序员SSM</a><time datetime="2026-02-03T03:14:00.000Z" title="发表于 2026-02-03 11:14:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/eedaddf.html" title="博客笔记"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/21.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="博客笔记"/></a><div class="content"><a class="title" href="/posts/eedaddf.html" title="博客笔记">博客笔记</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5764bc58.html" title="饱了么前端"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/26.jpg" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="饱了么前端"/></a><div class="content"><a class="title" href="/posts/5764bc58.html" title="饱了么前端">饱了么前端</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2821e645.html" title="饱了么后端"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.dreamshelter.cn/blog/source/img/cover/6.png" onerror="this.onerror=null;this.src='https://cdn.dreamshelter.cn/blog/source/img/404.jpg'" alt="饱了么后端"/></a><div class="content"><a class="title" href="/posts/2821e645.html" title="饱了么后端">饱了么后端</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Shelter</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><script src="/js/tw_cn.js?v=5.5.4"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://blog.dreamshelter.cn/twikooapi/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://blog.dreamshelter.cn/twikooapi/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script src="https://fastly.jsdelivr.net/npm/live2d-widgets@1.0.0/dist/autoload.js"></script><div class="aplayer no-destroy" data-id="17745883873" data-server="netease" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-autoplay="true" data-mutex="true" ></div><script>var checkAP=setInterval(function(){var m=document.querySelector(".aplayer");if(m&&m.aplayer){m.aplayer.volume(0.1,true);console.log("初始音量已设为10%");clearInterval(checkAP)}},200);</script><script id="canvas_nest" defer="defer" color="255,192,203" opacity="0" zIndex="-1" count="80" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      false
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><div id="app-refresh" style="position: fixed; top: -2.2rem; left: 0; right: 0; z-index: 99999; padding: 0 1rem; font-size: 15px; height: 2.2rem; transition: all 0.3s ease;"><div class="app-refresh-wrap" style="display: flex; color: #fff; height: 100%; align-items: center; justify-content: center;"><label>🚀 有新内容发布啦！</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color: #fff; text-decoration: underline; cursor: pointer; margin-left: 8px;">点击刷新</span></a></div></div><script>if ('serviceWorker' in navigator) {
  // 如果当前页面受 Service Worker 控制，监听控制权变化
  if (navigator.serviceWorker.controller) {
    navigator.serviceWorker.addEventListener('controllerchange', function() {
      showNotification();
    });
  }

  // 页面加载完成后注册 sw.js
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js').catch(err => {
      console.error('PWA 注册失败:', err);
    });
  });
}

function showNotification() {
  // 优先使用主题自带的 Snackbar 弹窗
  if (window.GLOBAL_CONFIG && GLOBAL_CONFIG.Snackbar) {
    var snackbarBg = document.documentElement.getAttribute('data-theme') === 'light' ?
      GLOBAL_CONFIG.Snackbar.bgLight :
      GLOBAL_CONFIG.Snackbar.bgDark;
    
    var snackbarPos = GLOBAL_CONFIG.Snackbar.position;

    Snackbar.show({
      text: '🚀 有新文章发布啦！',
      backgroundColor: snackbarBg,
      duration: 10000, // 持续 10 秒
      pos: snackbarPos,
      actionText: '点击刷新',
      actionTextColor: '#fff',
      onActionClick: function(e) {
        location.reload();
      },
    });
  } else {
    // 如果没有 Snackbar，则显示顶部的 app-refresh 栏
    var showBg = document.documentElement.getAttribute('data-theme') === 'light' ? '#49b1f5' : '#1f1f1f';
    var appRefresh = document.getElementById('app-refresh');
    if (appRefresh) {
      appRefresh.style.cssText = 'top: 0; background: ' + showBg + ';';
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索点什么呢………" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://vercelapi.dreamshelter.cn/api?user=shelter67";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="shelter67";
            var parent_div_git = document.getElementsByClassName('layout')[0];
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/gongxianban/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementsByClassName('layout')[0]){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><script data-pjax>
function hexo_butterfly_clock_remake_injector_config(){
  var parent_div_git;
  var item_html = `<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>`;

  // 按类型获取容器
  if ('class' === 'class') {
    parent_div_git = document.getElementsByClassName('aside-content')[0];
  } else if ('class' === 'id') {
    parent_div_git = document.getElementById('aside-content');
  } else {
    parent_div_git = document.getElementById('aside-content');
  }

  if(parent_div_git){
    var reference_el_before = null;
    var reference_el_after = parent_div_git.querySelector('.card-announcement');

    if(reference_el_before){
      parent_div_git.insertBefore(
        (function(){var temp = document.createElement('div'); temp.innerHTML = item_html; return temp;}()),
        reference_el_before
      );
    } else if(reference_el_after){
      reference_el_after.insertAdjacentHTML('afterend', item_html);
    } else {
      parent_div_git.insertAdjacentHTML('afterbegin', item_html);
    }
  }
}

console.log('已挂载 butterfly_clock_anzhiyu-yang 修复版');

// ---------- 全局变量声明 ----------
var cpage = location.pathname;
var epage = 'all';
var qweather_key = '0df3cf714a324957b16f3201e86fe931';
var qweather_api_host = 'https://p65ctvhqy4.re.qweatherapi.com';
var default_city = '';
var gaud_map_key = '296709bdb591a3523a2cf60e8e8f0ba3';

// ---------- 页面过滤 ----------
var elist = 'null'.split(',');
var flag = 0;
for(var i=0;i<elist.length;i++){
  if(cpage.includes(elist[i])) flag++;
}

if((epage === 'all') && (flag == 0)){
  hexo_butterfly_clock_remake_injector_config();
} else if(epage === cpage){
  hexo_butterfly_clock_remake_injector_config();
}
</script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-veeink@1.0.7/lib/clock-min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementsByClassName('footer-other')[0];
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v8.1.1" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v5.5.4" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://cloud.tencent.com/" style="margin-inline:5px" data-title="本站由腾讯云提供服务器支持" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Server-Tencent%20Cloud-00A4FF?style=flat&amp;logo=qq&amp;logoColor=white" alt=""/></a><a class="github-badge" target="_blank" href="https://edgeone.ai/" style="margin-inline:5px" data-title="本站由腾讯云 EdgeOne 提供安全加速" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-EdgeOne-00A4FF?style=flat&amp;logo=iCloud&amp;logoColor=white" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn/" style="margin-inline:5px" data-title="工业和信息化部ICP备案管理系统" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E9%B2%81ICP%E5%A4%87-2025199346%E5%8F%B7--1-ba9132?style=flat&amp;labelColor=443d38" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="https://www.fomal.cc/static/js/runtime.js"></script><!-- hexo injector body_end end --></body></html>