<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>sql题目 | Shelter</title><meta name="author" content="Shelter"><meta name="copyright" content="Shelter"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第一题![1.jpg](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680103320228-5ed4903b-6a54-4ce8-81c6-e3f1738eac95.jpeg#averageHue&#x3D;%2385868b&amp;clientId&#x3D;uaa2e6f21-7481-4&amp;from&#x3D;paste&amp;height&#x3D;9">
<meta property="og:type" content="article">
<meta property="og:title" content="sql题目">
<meta property="og:url" content="http://localhost:4000/posts/4fe508cd.html">
<meta property="og:site_name" content="Shelter">
<meta property="og:description" content="第一题![1.jpg](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680103320228-5ed4903b-6a54-4ce8-81c6-e3f1738eac95.jpeg#averageHue&#x3D;%2385868b&amp;clientId&#x3D;uaa2e6f21-7481-4&amp;from&#x3D;paste&amp;height&#x3D;9">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://localhost:4000/img/cover/15.jpg">
<meta property="article:published_time" content="2025-04-01T08:23:00.000Z">
<meta property="article:modified_time" content="2026-02-04T11:08:57.755Z">
<meta property="article:author" content="Shelter">
<meta property="article:tag" content="sql Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/img/cover/15.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "sql题目",
  "url": "http://localhost:4000/posts/4fe508cd.html",
  "image": "http://localhost:4000/img/cover/15.jpg",
  "datePublished": "2025-04-01T08:23:00.000Z",
  "dateModified": "2026-02-04T11:08:57.755Z",
  "author": [
    {
      "@type": "Person",
      "name": "Shelter",
      "url": "https://github.com/Shelter67"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://localhost:4000/posts/4fe508cd.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#49b1f5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/128.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32/png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="mask-icon" href="/img/siteicon/128.png" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":3,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'sql题目',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><style>#waifu { left: auto !important; right: 20px !important; }</style><meta name="generator" content="Hexo 8.1.1"></head><body><div class="bg-animation" id="web_bg" style="background-image: url(/img/background.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuifan.html"><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuiju.html"><i class="fa-fw fas fa-video"></i><span> 追剧</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover/15.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Shelter</span></a><a class="nav-page-title" href="/"><span class="site-name">sql题目</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuifan.html"><i class="fa-fw fas fa-tv"></i><span> 追番</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/zhuiju.html"><i class="fa-fw fas fa-video"></i><span> 追剧</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">sql题目</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-01T08:23:00.000Z" title="发表于 2025-04-01 16:23:00">2025-04-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-04T11:08:57.755Z" title="更新于 2026-02-04 19:08:57">2026-02-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">9.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>52分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2026-02-04 19:08:57&quot;}" hidden></div><h1 id="第一题"><a href="#第一题" class="headerlink" title="第一题"></a>第一题</h1><p>![1.jpg](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680103320228-5ed4903b-6a54-4ce8-81c6-e3f1738eac95.jpeg#averageHue&#x3D;%2385868b&amp;clientId&#x3D;uaa2e6f21-7481-4&amp;from&#x3D;paste&amp;height&#x3D;960&amp;id&#x3D;u7e7ddb69&amp;originHeight&#x3D;960&amp;originWidth&#x3D;541&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;33263&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u7351acee-03a5-4cf0-9f72-98dcc8c9a08&amp;title&#x3D;&amp;width&#x3D;541)</p>
<p>第一题：<br>用一条sql语句，查询出每门课程都大于80分的学生姓名</p>
<p>建表语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t_student;</span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	kecheng <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	fenshu <span class="keyword">double</span>(<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;语文&#x27;</span>, <span class="number">81</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="number">75</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student <span class="keyword">values</span>(<span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="number">90</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br></pre></td></tr></table></figure>

<p>思路：查询出小于80分的所欲学生姓名（去重），然后使用not in，不去重会有多个少于80分的重复名字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 第一步：找小于等于<span class="number">80</span>分的学员姓名</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> name <span class="keyword">from</span> t_student <span class="keyword">where</span> fenshu <span class="operator">&lt;=</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"># 第二步：<span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> name <span class="keyword">from</span> t_student <span class="keyword">where</span> name <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> <span class="keyword">distinct</span> name <span class="keyword">from</span> t_student <span class="keyword">where</span> fenshu <span class="operator">&lt;=</span> <span class="number">80</span>)</span><br></pre></td></tr></table></figure>
<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;hEKZG&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第二题"><a href="#第二题" class="headerlink" title="第二题"></a>第二题</h1><p>![2.jpg](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680103877015-ca07133d-716e-4cce-82f3-52118ff4c9ad.jpeg#averageHue&#x3D;%2389857c&amp;clientId&#x3D;uaa2e6f21-7481-4&amp;from&#x3D;paste&amp;height&#x3D;461&amp;id&#x3D;u0043cb44&amp;originHeight&#x3D;461&amp;originWidth&#x3D;615&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;35758&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u25d031eb-03ec-419c-8119-34b901a3a42&amp;title&#x3D;&amp;width&#x3D;615)<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680104265213-8afaf5de-a962-47c6-a1cd-72aefe28f616.png#averageHue&#x3D;%23dbe3e9&amp;clientId&#x3D;uaa2e6f21-7481-4&amp;from&#x3D;paste&amp;height&#x3D;342&amp;id&#x3D;uc0c3fef4&amp;originHeight&#x3D;342&amp;originWidth&#x3D;750&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;9419&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u12d9f5f8-e531-4fd6-99b6-10f4ed7a039&amp;title&#x3D;&amp;width&#x3D;750)<br>其中，两个表的关联字段为申请单号。<br>1）查询身份证号为440401430103082的申请日期。<br>2）查询同一个身份证号码有两条以上记录的身份证号码及记录个数。<br>3）将身份证号码为440401430103082的记录在两个表中的申请状态均改为07。<br>4）删除g_cardapplydetail表中所有姓李的记录。<br>模拟数据：考试做这种题目最重要的是要冷静下来，只有静下来SQL才能写好。要模拟数据。看到数据SQL就好写了。<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680105543048-1dd227b9-f2e8-4daf-8b1b-155db36db813.png#averageHue&#x3D;%23e4eaef&amp;clientId&#x3D;uaa2e6f21-7481-4&amp;from&#x3D;paste&amp;height&#x3D;434&amp;id&#x3D;uc9094a08&amp;originHeight&#x3D;434&amp;originWidth&#x3D;1027&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;10053&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u69af6e14-873e-4d37-bf9f-8090081fc11&amp;title&#x3D;&amp;width&#x3D;1027)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> g_cardapply;</span><br><span class="line"><span class="keyword">create table</span> g_cardapply(</span><br><span class="line">	g_applyno <span class="type">varchar</span>(<span class="number">8</span>) <span class="keyword">primary key</span>,</span><br><span class="line">	g_applydate <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	g_state <span class="type">varchar</span>(<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> g_cardapply <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;2008-08-08&#x27;</span>, <span class="string">&#x27;01&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapply <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;2022-10-11&#x27;</span>, <span class="string">&#x27;01&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapply <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;2023-03-23&#x27;</span>, <span class="string">&#x27;01&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapply <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">&#x27;2007-12-12&#x27;</span>, <span class="string">&#x27;02&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapply <span class="keyword">values</span>(<span class="number">5</span>,<span class="string">&#x27;2009-12-11&#x27;</span>, <span class="string">&#x27;02&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> g_cardapply;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> g_cardapplydetail;</span><br><span class="line"><span class="keyword">create table</span> g_cardapplydetail(</span><br><span class="line">	g_applyno <span class="type">varchar</span>(<span class="number">8</span>),</span><br><span class="line">	g_name <span class="type">varchar</span>(<span class="number">8</span>),</span><br><span class="line">	g_idcard <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">	g_state <span class="type">varchar</span>(<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapplydetail <span class="keyword">values</span>(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;440401430103082&#x27;</span>,<span class="string">&#x27;01&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapplydetail <span class="keyword">values</span>(<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;440401430103082&#x27;</span>,<span class="string">&#x27;01&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapplydetail <span class="keyword">values</span>(<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;440401430103082&#x27;</span>,<span class="string">&#x27;01&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapplydetail <span class="keyword">values</span>(<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;440401430111111&#x27;</span>,<span class="string">&#x27;02&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> g_cardapplydetail <span class="keyword">values</span>(<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;440401430122222&#x27;</span>,<span class="string">&#x27;02&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> g_cardapplydetail;</span><br></pre></td></tr></table></figure>

<p>1)查询身份证号为440401430103082的申请日期。<br>bigint转date，可以使用from_unixtime函数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.g_applydate <span class="keyword">from</span> g_cardapply a <span class="keyword">join</span> g_cardapplydetail b <span class="keyword">on</span> a.g_applyno <span class="operator">=</span> b.g_applyno <span class="keyword">where</span> b.g_idcard <span class="operator">=</span> <span class="string">&#x27;440401430103082&#x27;</span></span><br></pre></td></tr></table></figure>
<p>2）查询同一个身份证号码有两条以上记录的身份证号码及记录个数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(g_idcard),g_idcard <span class="keyword">from</span> g_cardapplydetail <span class="keyword">group</span> <span class="keyword">by</span> g_idcard <span class="keyword">having</span> <span class="built_in">count</span>(g_idcard) <span class="operator">&gt;=</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>3）将身份证号码为440401430103082的记录在两个表中的申请状态均改为07。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> </span><br><span class="line">	g_cardapply</span><br><span class="line"><span class="keyword">JOIN</span> </span><br><span class="line">	g_cardapplydetail </span><br><span class="line"><span class="keyword">ON</span> </span><br><span class="line">	g_cardapply.g_applyno <span class="operator">=</span> g_cardapplydetail.g_applyno </span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line">	g_cardapplydetail.g_idcard <span class="operator">=</span> <span class="string">&#x27;440401430103082&#x27;</span></span><br><span class="line"><span class="keyword">SET</span> g_cardapply.g_state <span class="operator">=</span> <span class="string">&#x27;07&#x27;</span>,</span><br><span class="line">g_cardapplydetail.g_state <span class="operator">=</span> <span class="string">&#x27;07&#x27;</span></span><br></pre></td></tr></table></figure>
<p>4）删除g_cardapplydetail表中所有姓李的记录。</p>
<p>要注意a表符合姓李的相关日期记录也需要删除</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> t1,t2 <span class="keyword">from</span> g_cardapply t1 <span class="keyword">join</span> g_cardapplydetail t2 <span class="keyword">on</span> t1.g_applyno<span class="operator">=</span>t2.g_applyno <span class="keyword">where</span> t2.g_name <span class="keyword">like</span> <span class="string">&#x27;李%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;fFC65&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第三题"><a href="#第三题" class="headerlink" title="第三题"></a>第三题</h1><p>![面试题3.jpg](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680142491993-8e350bec-9af7-4304-b7d6-92f2f313997e.jpeg#averageHue&#x3D;%23a59f9a&amp;clientId&#x3D;uc0287a15-0bb5-4&amp;from&#x3D;paste&amp;height&#x3D;1136&amp;id&#x3D;u22aaff9c&amp;originHeight&#x3D;1136&amp;originWidth&#x3D;852&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;71883&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u55012cef-437e-448d-8cc9-d45d69e6cbe&amp;title&#x3D;&amp;width&#x3D;852)<br>![面试题5.jpg](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680142491981-3d90f70c-a859-4937-bdb7-60988985ea54.jpeg#averageHue&#x3D;%239c9691&amp;clientId&#x3D;uc0287a15-0bb5-4&amp;from&#x3D;paste&amp;height&#x3D;1136&amp;id&#x3D;SqUCT&amp;originHeight&#x3D;1136&amp;originWidth&#x3D;852&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;66386&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u1d4c868e-fd06-437f-b678-0dc4870d944&amp;title&#x3D;&amp;width&#x3D;852)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> stuscore;</span><br><span class="line"><span class="keyword">create table</span> stuscore(</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	subject <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	score <span class="type">int</span>,</span><br><span class="line">	stuid <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> stuscore <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="number">89</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert into</span> stuscore <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;语文&#x27;</span>,<span class="number">80</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert into</span> stuscore <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="number">70</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert into</span> stuscore <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="number">90</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert into</span> stuscore <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;语文&#x27;</span>,<span class="number">70</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert into</span> stuscore <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="number">80</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stuscore;</span><br></pre></td></tr></table></figure>

<p>表名：stuscore<br>1)统计如下：课程不及格[0<del>59]的多少个，良[60</del>80]多少个，优[81-100]多少个。<br>多种方式：可以采用union实现，也可以采用case when then when then else and实现<br>case把符合的都转换成了字符串，后续可以再用group by进行分组<br>then是加上条件，as是起名字，count来统计条数，然后再分组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">case</span> </span><br><span class="line"><span class="keyword">when</span> score<span class="operator">&gt;=</span><span class="number">0</span> <span class="keyword">and</span> score<span class="operator">&lt;=</span><span class="number">59</span> <span class="keyword">then</span> <span class="string">&#x27;0-59&#x27;</span></span><br><span class="line"><span class="keyword">when</span> score<span class="operator">&gt;=</span><span class="number">60</span> <span class="keyword">and</span> score<span class="operator">&lt;=</span> <span class="number">80</span> <span class="keyword">then</span> <span class="string">&#x27;60-80&#x27;</span></span><br><span class="line"><span class="keyword">when</span> score<span class="operator">&gt;=</span><span class="number">81</span> <span class="keyword">and</span> score<span class="operator">&lt;=</span><span class="number">100</span> <span class="keyword">then</span> <span class="string">&#x27;81-100&#x27;</span></span><br><span class="line"><span class="keyword">else</span> <span class="string">&#x27;其他&#x27;</span> <span class="keyword">end</span> <span class="keyword">as</span> score_range, <span class="built_in">count</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">from</span> stuscore <span class="keyword">group</span> <span class="keyword">by</span> score_range;</span><br></pre></td></tr></table></figure>

<p>2)计算科科及格的人的平均成绩。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span> name,<span class="built_in">avg</span>(score) <span class="keyword">as</span> avgscore</span><br><span class="line"><span class="keyword">from</span> stuscore </span><br><span class="line"><span class="keyword">where</span></span><br><span class="line"> name <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> name <span class="keyword">from</span> stuscore <span class="keyword">where</span> score<span class="operator">&lt;</span><span class="number">60</span>)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name;</span><br></pre></td></tr></table></figure>



<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;f1E8i&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第四题"><a href="#第四题" class="headerlink" title="第四题"></a>第四题</h1><p>![QQ图片20151126234632.jpg](.&#x2F;images&#x2F;第11章 企业真题&#x2F;auto-orient,1#averageHue&#x3D;%23c1c3be&amp;clientId&#x3D;uc0287a15-0bb5-4&amp;from&#x3D;paste&amp;height&#x3D;1136&amp;id&#x3D;u9a38f7f2&amp;originHeight&#x3D;1136&amp;originWidth&#x3D;852&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;80491&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;udaf33971-93f4-47eb-aaf8-2c246beec8b&amp;title&#x3D;&amp;width&#x3D;852)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> WCMEmploy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> WCMEmploy(</span><br><span class="line">	<span class="keyword">no</span> <span class="type">int</span>,</span><br><span class="line">	name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	dname <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	job <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	sal <span class="keyword">double</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">1500</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">2</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">2800</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">3</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;油漆工&#x27;</span>, <span class="number">3000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">4</span>, <span class="string">&#x27;赵六&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;水电工&#x27;</span>, <span class="number">4500</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">5</span>, <span class="string">&#x27;钱七&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">1800</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">6</span>, <span class="string">&#x27;小毛&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">2600</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">7</span>, <span class="string">&#x27;小明&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;油漆工&#x27;</span>, <span class="number">2800</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">8</span>, <span class="string">&#x27;小刚&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;水电工&#x27;</span>, <span class="number">5000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">9</span>, <span class="string">&#x27;孙悟空&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;油漆工&#x27;</span>, <span class="number">6000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">10</span>, <span class="string">&#x27;猪八戒&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">11</span>, <span class="string">&#x27;沙和尚&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;水电工&#x27;</span>, <span class="number">5000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">12</span>, <span class="string">&#x27;武松&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">13</span>, <span class="string">&#x27;阮小七&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;水电工&#x27;</span>, <span class="number">5000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">14</span>, <span class="string">&#x27;哪吒&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;油漆工&#x27;</span>, <span class="number">2500</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">15</span>, <span class="string">&#x27;三太子&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">3000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">16</span>, <span class="string">&#x27;龙王&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">4000</span>);</span><br><span class="line"><span class="keyword">insert into</span> WCMEmploy <span class="keyword">values</span>(<span class="number">17</span>, <span class="string">&#x27;露西&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;钳工&#x27;</span>, <span class="number">3300</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> WCMEmploy;</span><br></pre></td></tr></table></figure>

<p>1)请用一条SQL语句查询出不同部门中担任“钳工”的职工平均工资。</p>
<p>先筛选钳工，再分组，分组可以用dname和job的联合分组</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dname,job,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> WCMEmploy <span class="keyword">where</span> job<span class="operator">=</span><span class="string">&#x27;钳工&#x27;</span> <span class="keyword">group</span> <span class="keyword">by</span> dname,job;</span><br></pre></td></tr></table></figure>

<p>2)请用一条SQL语句查询出不同部门中担任“钳工”的职工平均工资高于2000的部门。</p>
<p>使用having可以对分组结果再过滤</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dname,job,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> WCMEmploy <span class="keyword">where</span> job<span class="operator">=</span><span class="string">&#x27;钳工&#x27;</span> <span class="keyword">group</span> <span class="keyword">by</span> dname,job <span class="keyword">having</span> <span class="built_in">avg</span>(sal)<span class="operator">&gt;</span><span class="number">2000</span>;</span><br></pre></td></tr></table></figure>



<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;dWqMk&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第五题"><a href="#第五题" class="headerlink" title="第五题"></a>第五题</h1><p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680398222140-816dc325-2887-46aa-96ba-57b6f1c52c25.png#averageHue&#x3D;%238b8f8e&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;460&amp;id&#x3D;ucad96633&amp;originHeight&#x3D;460&amp;originWidth&#x3D;1221&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;226374&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uc063bf61-cb24-4b98-ad3d-ddb2222fa62&amp;title&#x3D;&amp;width&#x3D;1221)<br>Employee是雇员信息表：<br>雇员姓名（主键）：person-name<br>街道：street<br>城市：city<br>Company是公司信息表：<br>公司名称（主键）：company-name<br>城市：city<br>Works是雇员工作信息表：<br>雇员姓名（主键）：person-name<br>公司名称：company-name<br>年薪：salary<br>Manages是雇员工作关系表：<br>雇员姓名（主键）：person-name<br>经理姓名：manager-name<br>模拟数据：<br>员工表：employee<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680402378306-a5369a92-0751-468b-8ef2-2e65aee24d31.png#averageHue&#x3D;%23f6f4f3&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;266&amp;id&#x3D;ufe13588e&amp;originHeight&#x3D;266&amp;originWidth&#x3D;333&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;13936&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uf127c7fa-aa8a-48cb-b32c-eb68c2e0d1f&amp;title&#x3D;&amp;width&#x3D;333)<br>公司表：company<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680402457539-3684d5f1-8e7e-470b-95f7-56b3d48e4cee.png#averageHue&#x3D;%23dab674&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;112&amp;id&#x3D;u3dddee1e&amp;originHeight&#x3D;112&amp;originWidth&#x3D;349&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;4687&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u91f1036e-127c-4b16-a5b1-b79ca7a55cb&amp;title&#x3D;&amp;width&#x3D;349)<br>雇员工作信息表：Works<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680402493037-5384139c-9959-4e34-8ce8-d0be11ea4563.png#averageHue&#x3D;%23f8f7f5&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;274&amp;id&#x3D;u49603cde&amp;originHeight&#x3D;274&amp;originWidth&#x3D;440&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;13746&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u536e509d-d220-49d9-afe8-e8c265f9aa8&amp;title&#x3D;&amp;width&#x3D;440)<br>雇员工作关系表：Manages<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680402526039-fe04bfb3-e33b-4cbb-bc94-f680f0ae2a8e.png#averageHue&#x3D;%23f9f9f8&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;265&amp;id&#x3D;uf9a3f0d7&amp;originHeight&#x3D;265&amp;originWidth&#x3D;311&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;8183&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u487349a5-5eeb-43e5-8753-1e37c60eca7&amp;title&#x3D;&amp;width&#x3D;311)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> Employee;</span><br><span class="line"><span class="keyword">create table</span> Employee(</span><br><span class="line">	`person<span class="operator">-</span>name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">primary key</span>,</span><br><span class="line">	street <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	city <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;bob&#x27;</span>,<span class="string">&#x27;街道1&#x27;</span>,<span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;frank&#x27;</span>,<span class="string">&#x27;街道2&#x27;</span>,<span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;街道3&#x27;</span>,<span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;lucy&#x27;</span>,<span class="string">&#x27;街道4&#x27;</span>,<span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;周二&#x27;</span>,<span class="string">&#x27;街道5&#x27;</span>,<span class="string">&#x27;石家庄&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;街道6&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;街道7&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;街道8&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;赵六&#x27;</span>,<span class="string">&#x27;街道9&#x27;</span>,<span class="string">&#x27;石家庄&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Employee <span class="keyword">values</span>(<span class="string">&#x27;钱七&#x27;</span>,<span class="string">&#x27;街道10&#x27;</span>,<span class="string">&#x27;石家庄&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> Company;</span><br><span class="line"><span class="keyword">create table</span> Company(</span><br><span class="line">	`company<span class="operator">-</span>name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">primary key</span>,</span><br><span class="line">	city <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> Company <span class="keyword">values</span>(<span class="string">&#x27;Small Bank Corporation&#x27;</span>, <span class="string">&#x27;北京&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Company <span class="keyword">values</span>(<span class="string">&#x27;公司B&#x27;</span>, <span class="string">&#x27;石家庄&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Company <span class="keyword">values</span>(<span class="string">&#x27;公司C&#x27;</span>, <span class="string">&#x27;天津&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> Works;</span><br><span class="line"><span class="keyword">create table</span> Works(</span><br><span class="line">	`person<span class="operator">-</span>name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">primary key</span>,</span><br><span class="line">	`company<span class="operator">-</span>name` <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	salary <span class="keyword">double</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;bob&#x27;</span>,<span class="string">&#x27;公司C&#x27;</span>, <span class="number">22000</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;frank&#x27;</span>,<span class="string">&#x27;公司C&#x27;</span>, <span class="number">99999</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;公司C&#x27;</span>, <span class="number">6000</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;lucy&#x27;</span>,<span class="string">&#x27;公司C&#x27;</span>, <span class="number">11000</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;周二&#x27;</span>,<span class="string">&#x27;公司B&#x27;</span>, <span class="number">31000</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;Small Bank Corporation&#x27;</span>, <span class="number">11000</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;Small Bank Corporation&#x27;</span>, <span class="number">5000</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;Small Bank Corporation&#x27;</span>, <span class="number">8000</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;赵六&#x27;</span>,<span class="string">&#x27;公司B&#x27;</span>, <span class="number">12000</span>);</span><br><span class="line"><span class="keyword">insert into</span> Works <span class="keyword">values</span>(<span class="string">&#x27;钱七&#x27;</span>,<span class="string">&#x27;公司B&#x27;</span>, <span class="number">21000</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Works;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> Manages;</span><br><span class="line"><span class="keyword">create table</span> Manages(</span><br><span class="line">	`person<span class="operator">-</span>name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">primary key</span>,</span><br><span class="line">	`manager<span class="operator">-</span>name` <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;bob&#x27;</span>,<span class="string">&#x27;frank&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;frank&#x27;</span>,<span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;lucy&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;lucy&#x27;</span>,<span class="string">&#x27;bob&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;周二&#x27;</span>,<span class="string">&#x27;jack&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>,<span class="string">&#x27;李四&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>,<span class="string">&#x27;王五&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;王五&#x27;</span>,<span class="string">&#x27;赵六&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;赵六&#x27;</span>,<span class="string">&#x27;钱七&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Manages <span class="keyword">values</span>(<span class="string">&#x27;钱七&#x27;</span>,<span class="string">&#x27;周二&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Manages;</span><br></pre></td></tr></table></figure>

<p>请给出下面每一个查询的SQL语句：</p>
<ol>
<li><p>找出所有居住地与工作的公司在同一城市的员工的姓名。</p>
<p>employee e<br>company c<br>works w<br>将以上三张表进行连接，连接条件：<br>e join w on e.<code>person-name</code>&#x3D;w.<code>person-name</code>员工表和工作表连接<br>join c on w.<code>company-name</code>&#x3D;c.<code>company-name</code><br>select可以先不写 ，用where进行过滤</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.`person<span class="operator">-</span>name`</span><br><span class="line"><span class="keyword">from</span> employee e </span><br><span class="line"><span class="keyword">join</span> works w <span class="keyword">on</span> e.`person<span class="operator">-</span>name`<span class="operator">=</span>w.`person<span class="operator">-</span>name` </span><br><span class="line"><span class="keyword">join</span> company c <span class="keyword">on</span> w.`company<span class="operator">-</span>name`<span class="operator">=</span>c.`company<span class="operator">-</span>name`</span><br><span class="line"><span class="keyword">where</span> e.city<span class="operator">=</span>c.city;</span><br></pre></td></tr></table></figure>
</li>
<li><p>找出比Small Bank Corporation的所有员工收入都高的所有员工的姓名。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> `person<span class="operator">-</span>name` <span class="keyword">from</span> works <span class="keyword">where</span> salary<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">max</span>(salary) <span class="keyword">as</span> maxsal <span class="keyword">from</span> works <span class="keyword">where</span> `company<span class="operator">-</span>name`<span class="operator">=</span><span class="string">&#x27;Small Bank Corporation&#x27;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>找出平均年薪在10000美元以上的公司及其平均年薪。</p>
<p>思路：按照公司进行分组，对年薪求平均值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(salary) avgsal,`company<span class="operator">-</span>name` <span class="keyword">from</span> works <span class="keyword">group</span> <span class="keyword">by</span> `company<span class="operator">-</span>name` <span class="keyword">having</span> avgsal<span class="operator">&gt;</span><span class="number">10000</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;VQuap&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第六题"><a href="#第六题" class="headerlink" title="第六题"></a>第六题</h1><p>![IMG_1621.JPG](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680399293094-1a4ca298-63ad-48db-9e8b-27ce4a6846a2.jpeg#averageHue&#x3D;%2388868c&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;768&amp;id&#x3D;u5a98a01b&amp;originHeight&#x3D;768&amp;originWidth&#x3D;1280&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;41934&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u2b8b1cba-0a2f-487e-966a-9ddd6d32e5b&amp;title&#x3D;&amp;width&#x3D;1280)<br>客户表Client<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680399899003-07e5e8a6-78d4-4939-b914-bf9280dcc3eb.png#averageHue&#x3D;%23f2f0ee&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;185&amp;id&#x3D;u038cbc02&amp;originHeight&#x3D;185&amp;originWidth&#x3D;389&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;13762&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;ud65f66b7-4ffc-4fdf-af31-a7e7ea4e872&amp;title&#x3D;&amp;width&#x3D;389)<br>订单表Order<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680400992647-08ba0bcf-1ff6-45c7-a82e-3918a9f9e950.png#averageHue&#x3D;%23fbfaf9&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;208&amp;id&#x3D;uab01aaf9&amp;originHeight&#x3D;208&amp;originWidth&#x3D;244&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;4140&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;ue1ebe17e-18ee-4fc4-b5a4-f6193b774b9&amp;title&#x3D;&amp;width&#x3D;244)<br>客户订单表ClientOrder<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680400979869-ea2a1837-751b-4744-98a5-e04c9808b568.png#averageHue&#x3D;%23fbfaf9&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;211&amp;id&#x3D;ud9ab36c4&amp;originHeight&#x3D;211&amp;originWidth&#x3D;223&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;3731&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;ub22f900e-39a8-459b-9e78-cb15fa4fed4&amp;title&#x3D;&amp;width&#x3D;223)<br>图书表Book<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680401007501-200e3826-48ed-4638-8095-7be52757bdf1.png#averageHue&#x3D;%23f5f3f1&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;131&amp;id&#x3D;u364c289b&amp;originHeight&#x3D;131&amp;originWidth&#x3D;320&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;7145&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u790fb5ee-03be-4efd-aa17-6f70cf09106&amp;title&#x3D;&amp;width&#x3D;320)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> Client;</span><br><span class="line"><span class="keyword">create table</span> Client(</span><br><span class="line">	client_id <span class="type">int</span>,</span><br><span class="line">	client_name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	phone <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	address <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> Client <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;Zhao&#x27;</span>, <span class="number">12522542470</span>, <span class="string">&#x27;海淀区&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Client <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;Wang&#x27;</span>, <span class="number">12522542471</span>, <span class="string">&#x27;朝阳区&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Client <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;Sun&#x27;</span>, <span class="number">12522542472</span>, <span class="string">&#x27;大兴区&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> Client <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">&#x27;Li&#x27;</span>, <span class="number">12522542473</span>, <span class="string">&#x27;东城区&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> `<span class="keyword">Order</span>`;</span><br><span class="line"><span class="keyword">create table</span> `<span class="keyword">Order</span>`(</span><br><span class="line">	order_id <span class="type">int</span>,</span><br><span class="line">	book_id <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> `<span class="keyword">Order</span>` <span class="keyword">values</span>(<span class="number">11</span>,<span class="number">21</span>);</span><br><span class="line"><span class="keyword">insert into</span> `<span class="keyword">Order</span>` <span class="keyword">values</span>(<span class="number">12</span>,<span class="number">22</span>);</span><br><span class="line"><span class="keyword">insert into</span> `<span class="keyword">Order</span>` <span class="keyword">values</span>(<span class="number">13</span>,<span class="number">23</span>);</span><br><span class="line"><span class="keyword">insert into</span> `<span class="keyword">Order</span>` <span class="keyword">values</span>(<span class="number">14</span>,<span class="number">24</span>);</span><br><span class="line"><span class="keyword">insert into</span> `<span class="keyword">Order</span>` <span class="keyword">values</span>(<span class="number">15</span>,<span class="number">21</span>);</span><br><span class="line"><span class="keyword">insert into</span> `<span class="keyword">Order</span>` <span class="keyword">values</span>(<span class="number">16</span>,<span class="number">22</span>);</span><br><span class="line"><span class="keyword">insert into</span> `<span class="keyword">Order</span>` <span class="keyword">values</span>(<span class="number">17</span>,<span class="number">23</span>);</span><br><span class="line"><span class="keyword">insert into</span> `<span class="keyword">Order</span>` <span class="keyword">values</span>(<span class="number">18</span>,<span class="number">24</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> `<span class="keyword">Order</span>`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> ClientOrder;</span><br><span class="line"><span class="keyword">create table</span> ClientOrder(</span><br><span class="line">	client_id <span class="type">int</span>,</span><br><span class="line">	order_id <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> ClientOrder <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">11</span>);</span><br><span class="line"><span class="keyword">insert into</span> ClientOrder <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">12</span>);</span><br><span class="line"><span class="keyword">insert into</span> ClientOrder <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">13</span>);</span><br><span class="line"><span class="keyword">insert into</span> ClientOrder <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">14</span>);</span><br><span class="line"><span class="keyword">insert into</span> ClientOrder <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">15</span>);</span><br><span class="line"><span class="keyword">insert into</span> ClientOrder <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">16</span>);</span><br><span class="line"><span class="keyword">insert into</span> ClientOrder <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">17</span>);</span><br><span class="line"><span class="keyword">insert into</span> ClientOrder <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">18</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ClientOrder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> Book;</span><br><span class="line"><span class="keyword">create table</span> Book(</span><br><span class="line">	book_id <span class="type">int</span>,</span><br><span class="line">	book_name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	price <span class="keyword">double</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> Book <span class="keyword">values</span>(<span class="number">21</span>, <span class="string">&#x27;管理学&#x27;</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">insert into</span> Book <span class="keyword">values</span>(<span class="number">22</span>, <span class="string">&#x27;计算机网络&#x27;</span>, <span class="number">50</span>);</span><br><span class="line"><span class="keyword">insert into</span> Book <span class="keyword">values</span>(<span class="number">23</span>, <span class="string">&#x27;国家地理杂志&#x27;</span>, <span class="number">90</span>);</span><br><span class="line"><span class="keyword">insert into</span> Book <span class="keyword">values</span>(<span class="number">24</span>, <span class="string">&#x27;西游记&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Book;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li><p>请写出一条SQL语句，查询出每个客户的所有订单并按照地址排序，要求输出格式为：address client_name phone order_id</p>
<p>分成client c<br>clientorder co<br>c.client_id&#x3D;co.client_id </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> c.address,c.client_name,c.phone,co.order_id <span class="keyword">from</span> client c <span class="keyword">join</span> clientorder co <span class="keyword">on</span> c.client_id<span class="operator">=</span>co.client_id <span class="keyword">order</span> <span class="keyword">by</span> c.address;</span><br></pre></td></tr></table></figure>
</li>
<li><p>请写出一条SQL语句，查询出每个客户订购的图书总价。要求输出格式为：client_name total_price</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> c.client_name,<span class="built_in">sum</span>(b.price) <span class="keyword">as</span> total_price </span><br><span class="line"><span class="keyword">from</span> client c <span class="keyword">join</span> clientorder co <span class="keyword">on</span> c.client_id<span class="operator">=</span>co.client_id </span><br><span class="line"><span class="keyword">join</span> `<span class="keyword">order</span>` o <span class="keyword">on</span> co.order_id<span class="operator">=</span>o.order_id </span><br><span class="line"><span class="keyword">join</span> book b <span class="keyword">on</span> o.book_id<span class="operator">=</span>b.book_id </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> c.client_name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果要求每个订单可以包含多种图书，应该如何修改Order表的主键？为了保证每个订单只被一个客户拥有，应该在ClientOrder表上增加怎样的约束？</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#把<span class="keyword">order</span>表的order_id和book_id做复合主键</span><br><span class="line">#加上唯一性约束：<span class="keyword">unique</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;oCFYf&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第七题"><a href="#第七题" class="headerlink" title="第七题"></a>第七题</h1><p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680403317776-7cd6d3bc-b547-4d94-9521-186a89ab67df.png#averageHue&#x3D;%23afafa9&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;505&amp;id&#x3D;uc9118435&amp;originHeight&#x3D;505&amp;originWidth&#x3D;665&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;207077&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uc5e6c887-ea47-4872-a5f6-b36d3aa2b8b&amp;title&#x3D;&amp;width&#x3D;665)<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680403354657-0faf25ca-bb17-44ea-ade0-8a4e386756f3.png#averageHue&#x3D;%23cfcec7&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;367&amp;id&#x3D;u9dbd6b45&amp;originHeight&#x3D;367&amp;originWidth&#x3D;744&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;108642&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u9ec2ce66-95d7-4dce-a926-f781ad60236&amp;title&#x3D;&amp;width&#x3D;744)<br>模拟数据：<br>学生表：student<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680405687756-49b16a32-1f8b-42b5-b4a3-cd8c231e79f0.png#averageHue&#x3D;%23f6f5f4&amp;clientId&#x3D;ucbeccebf-714c-4&amp;from&#x3D;paste&amp;height&#x3D;128&amp;id&#x3D;uf6f677b4&amp;originHeight&#x3D;128&amp;originWidth&#x3D;323&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;5058&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u94b42f3c-0e0a-431b-a8dd-5f00291873a&amp;title&#x3D;&amp;width&#x3D;323)<br>课程表：course<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680405700061-a86b3354-1d10-4be5-96fe-63ba01c8d7b4.png#averageHue&#x3D;%23f9f8f7&amp;clientId&#x3D;ucbeccebf-714c-4&amp;from&#x3D;paste&amp;height&#x3D;124&amp;id&#x3D;udbbec214&amp;originHeight&#x3D;124&amp;originWidth&#x3D;268&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;4188&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u0c263cf1-ed36-4356-bbed-7a7af2c520a&amp;title&#x3D;&amp;width&#x3D;268)<br>成绩表：sc<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680405996312-907e4929-7d55-4d62-9e8d-1281bdafe91a.png#averageHue&#x3D;%23fbfbfa&amp;clientId&#x3D;ucbeccebf-714c-4&amp;from&#x3D;paste&amp;height&#x3D;337&amp;id&#x3D;uf86bf234&amp;originHeight&#x3D;337&amp;originWidth&#x3D;291&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;7772&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u704f40c5-1d25-4641-8565-6d3da624398&amp;title&#x3D;&amp;width&#x3D;291)<br>教师表：teacher<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680406005728-731d61b6-02a6-448d-8a66-000b0aa3a9e6.png#averageHue&#x3D;%23d8b571&amp;clientId&#x3D;ucbeccebf-714c-4&amp;from&#x3D;paste&amp;height&#x3D;92&amp;id&#x3D;u506eaf98&amp;originHeight&#x3D;92&amp;originWidth&#x3D;197&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;1920&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u357535c2-7d55-4cb7-b7c7-95439dea833&amp;title&#x3D;&amp;width&#x3D;197)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> student;</span><br><span class="line"><span class="keyword">create table</span> student(</span><br><span class="line">	`s#` <span class="type">int</span>,</span><br><span class="line">	sname <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	sage <span class="type">int</span>,</span><br><span class="line">	ssex <span class="type">char</span>(<span class="number">1</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> student <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;学生1&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> student <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;学生2&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> student <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;学生3&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> student <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">&#x27;学生4&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;男&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> course;</span><br><span class="line"><span class="keyword">create table</span> course(</span><br><span class="line">	`c#` <span class="type">int</span>,</span><br><span class="line">	cname <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	`t#` <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> course <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert into</span> course <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;语文&#x27;</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert into</span> course <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert into</span> course <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">&#x27;政治&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> course;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> sc;</span><br><span class="line"><span class="keyword">create table</span> sc(</span><br><span class="line">	`s#` <span class="type">int</span>,</span><br><span class="line">	`c#` <span class="type">int</span>,</span><br><span class="line">	score <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">65</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">66</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">3</span>,<span class="number">66</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">4</span>,<span class="number">69</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">1</span>,<span class="number">55</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">2</span>,<span class="number">66</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">3</span>,<span class="number">75</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">4</span>,<span class="number">86</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">1</span>,<span class="number">96</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">2</span>,<span class="number">99</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">3</span>,<span class="number">70</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">4</span>,<span class="number">60</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">3</span>,<span class="number">65</span>);</span><br><span class="line"><span class="keyword">insert into</span> sc <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">4</span>,<span class="number">99</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> teacher;</span><br><span class="line"><span class="keyword">create table</span> teacher(</span><br><span class="line">	`t#` <span class="type">int</span>,</span><br><span class="line">	tname <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> teacher <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;叶平&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> teacher <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;李白&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> teacher;</span><br></pre></td></tr></table></figure>



<ol>
<li><p>查询1号课比2号课成绩高的所有学生学号。</p>
<p>主要是c#，查询出1号和2号课的学生后，要确定两表的s#是一样的，才是同一个人，然后去对比<br>select * from sc where <code>c#</code>&#x3D;1;<br>select * from sc where <code>c#</code>&#x3D;2;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.`s#` </span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sc <span class="keyword">where</span> `c#`<span class="operator">=</span><span class="number">1</span>) a </span><br><span class="line"><span class="keyword">join</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sc <span class="keyword">where</span> `c#`<span class="operator">=</span><span class="number">2</span>) b </span><br><span class="line"><span class="keyword">on</span> a.`s#`<span class="operator">=</span>b.`s#` <span class="keyword">where</span> a.score<span class="operator">&gt;</span>b.score;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询平均成绩大于60分的学号和平均成绩。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> `s#`,<span class="built_in">avg</span>(score) <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> `s#` <span class="keyword">having</span> <span class="built_in">avg</span>(score) <span class="operator">&gt;</span> <span class="number">60</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询所有学生学号、姓名、选课数、总成绩。</p>
<p>求选课数就是count，总成绩sum，联合分组后才可以一起显示学号姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  s.`s#`,s.sname,<span class="built_in">count</span>(sc.`c#`),<span class="built_in">sum</span>(sc.score)</span><br><span class="line"><span class="keyword">from</span> student s <span class="keyword">join</span> sc <span class="keyword">on</span> s.`s#`<span class="operator">=</span>sc.`s#` <span class="keyword">group</span> <span class="keyword">by</span> s.`s#`,s.sname;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询姓“李”的老师的个数。</p>
<p>count(tname)记录不为null的个数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(tname) <span class="keyword">from</span> teacher <span class="keyword">where</span> tname <span class="keyword">like</span> <span class="string">&#x27;李%&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询没学过“叶平”老师课的学号、姓名。</p>
<p>select <code>t#</code> from teacher where tname&#x3D;’叶平’这是叶平老师的编号<br>select <code>c#</code> from course where <code>t#</code>&#x3D;(上面)这是查叶平老师的课的编号<br>select distinct <code>s#</code> from sc where <code>c#</code> in(上面)，c#是查询的字段，in就是要查询的内容</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> student <span class="keyword">where</span> `s#` <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> <span class="keyword">distinct</span> `s#` <span class="keyword">from</span> sc <span class="keyword">where</span> `c#` <span class="keyword">in</span>(<span class="keyword">select</span> `c#` <span class="keyword">from</span> course <span class="keyword">where</span> `t#`<span class="operator">=</span>(<span class="keyword">select</span> `t#` <span class="keyword">from</span> teacher <span class="keyword">where</span> tname<span class="operator">=</span><span class="string">&#x27;叶平&#x27;</span>)));</span><br></pre></td></tr></table></figure></li>
</ol>
<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;c1vSE&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第八题"><a href="#第八题" class="headerlink" title="第八题"></a>第八题</h1><p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680403650729-b44beed8-c599-4077-8f43-8f862b94bfcd.png#averageHue&#x3D;%239c9b98&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;591&amp;id&#x3D;DrAUb&amp;originHeight&#x3D;591&amp;originWidth&#x3D;603&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;153164&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uc128e8d0-6f55-4639-ac54-76e70d093f6&amp;title&#x3D;&amp;width&#x3D;603)<br>学生表：student<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680406785079-9ec12300-6db8-48b8-ad77-7d64ebcf4292.png#averageHue&#x3D;%23f7f6f5&amp;clientId&#x3D;ucbeccebf-714c-4&amp;from&#x3D;paste&amp;height&#x3D;130&amp;id&#x3D;uf5187384&amp;originHeight&#x3D;130&amp;originWidth&#x3D;195&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;3024&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uc537588f-10dd-49d1-a430-9d7acff4a7d&amp;title&#x3D;&amp;width&#x3D;195)<br>课程表：class<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680406801984-082cd575-80cc-432e-9c19-c247c194fa40.png#averageHue&#x3D;%23faf9f8&amp;clientId&#x3D;ucbeccebf-714c-4&amp;from&#x3D;paste&amp;height&#x3D;116&amp;id&#x3D;ub01fb31c&amp;originHeight&#x3D;116&amp;originWidth&#x3D;220&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;2858&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u459c368e-0955-44ae-9c9f-d5d651392ae&amp;title&#x3D;&amp;width&#x3D;220)<br>选课表：chosen_class<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680406813282-256975bc-ab6c-49f9-8d83-e5f60d2a00ed.png#averageHue&#x3D;%23faf9f8&amp;clientId&#x3D;ucbeccebf-714c-4&amp;from&#x3D;paste&amp;height&#x3D;200&amp;id&#x3D;u4ba72e6a&amp;originHeight&#x3D;200&amp;originWidth&#x3D;340&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;5464&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u9afb016e-e693-452b-966b-4e45c9b7191&amp;title&#x3D;&amp;width&#x3D;340)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li><p>没有选修课程编号为C1的学生姓名</p>
<p>select s_id from chosen_class where c_id&#x3D;’c1’;选择了的<br>select s_id from chosen_class where s_id not in(没选择的</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname <span class="keyword">from</span> student <span class="keyword">where</span> s_id <span class="keyword">in</span>(<span class="keyword">select</span> s_id <span class="keyword">from</span> chosen_class <span class="keyword">where</span> s_id <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> s_id <span class="keyword">from</span> chosen_class <span class="keyword">where</span> c_id<span class="operator">=</span><span class="string">&#x27;c1&#x27;</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>列出每门课程名称和平均成绩，并按照成绩排序</p>
<p>class c<br>chosen_class cc<br>c.c_id&#x3D;cc.c_id </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> c.c_name,<span class="built_in">avg</span>(cc.grade) <span class="keyword">as</span> avgscore  <span class="keyword">from</span> `class` c <span class="keyword">join</span> chosen_class cc <span class="keyword">on</span> c.c_id<span class="operator">=</span>cc.c_id <span class="keyword">group</span> <span class="keyword">by</span> c.c_name <span class="keyword">order</span> <span class="keyword">by</span> avgscore;</span><br></pre></td></tr></table></figure>
</li>
<li><p>选了2门课以上的学生姓名。</p>
<p>思路：按照学生姓名分组，计数<br>student s<br>chosen_class cc<br>条件：s.s_id&#x3D;cc.s_id</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.sname,<span class="built_in">count</span>(c_id) <span class="keyword">from</span> student s <span class="keyword">join</span> chosen_class cc <span class="keyword">on</span> s.s_id<span class="operator">=</span>cc.s_id <span class="keyword">group</span> <span class="keyword">by</span> s.sname <span class="keyword">having</span> <span class="built_in">count</span>(c_id) <span class="operator">&gt;</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;KSbuE&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第九题"><a href="#第九题" class="headerlink" title="第九题"></a>第九题</h1><p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680403903386-c1b30b13-93ed-4b1a-a331-e4107c17d411.png#averageHue&#x3D;%239f9ea3&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;460&amp;id&#x3D;uc48a45dc&amp;originHeight&#x3D;460&amp;originWidth&#x3D;556&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;171582&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;ue743e685-010a-4d7d-88d4-fb389bafa94&amp;title&#x3D;&amp;width&#x3D;556)<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688106505123-a5edeb3b-0cdb-4ee3-befd-4a462fccbddd.png#averageHue&#x3D;%23f6f4f3&amp;clientId&#x3D;u5ffc187d-9c9e-4&amp;from&#x3D;paste&amp;height&#x3D;275&amp;id&#x3D;u5ecb421a&amp;originHeight&#x3D;275&amp;originWidth&#x3D;461&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;17297&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uc5832d94-4aea-449c-a8e5-af7238887f0&amp;title&#x3D;&amp;width&#x3D;461)<br>要转换成：<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688106694493-9f831520-223c-4904-963a-3df0a7edb66a.png#averageHue&#x3D;%23ca9c57&amp;clientId&#x3D;u5ffc187d-9c9e-4&amp;from&#x3D;paste&amp;height&#x3D;82&amp;id&#x3D;u6c20837f&amp;originHeight&#x3D;82&amp;originWidth&#x3D;391&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;3574&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uf2fa2d09-dc7d-4be0-bdc8-c9f4d5e4ef5&amp;title&#x3D;&amp;width&#x3D;391)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">第九题</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t_temp;</span><br><span class="line"><span class="keyword">create table</span> t_temp(</span><br><span class="line">	<span class="keyword">year</span> <span class="type">int</span>,</span><br><span class="line">	season <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">	count <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> t_temp <span class="keyword">values</span>(<span class="number">2010</span>,<span class="string">&#x27;一季度&#x27;</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_temp <span class="keyword">values</span>(<span class="number">2010</span>,<span class="string">&#x27;二季度&#x27;</span>,<span class="number">200</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_temp <span class="keyword">values</span>(<span class="number">2010</span>,<span class="string">&#x27;三季度&#x27;</span>,<span class="number">300</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_temp <span class="keyword">values</span>(<span class="number">2010</span>,<span class="string">&#x27;四季度&#x27;</span>,<span class="number">400</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_temp <span class="keyword">values</span>(<span class="number">2011</span>,<span class="string">&#x27;一季度&#x27;</span>,<span class="number">150</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_temp <span class="keyword">values</span>(<span class="number">2011</span>,<span class="string">&#x27;二季度&#x27;</span>,<span class="number">250</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_temp <span class="keyword">values</span>(<span class="number">2011</span>,<span class="string">&#x27;三季度&#x27;</span>,<span class="number">350</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_temp <span class="keyword">values</span>(<span class="number">2011</span>,<span class="string">&#x27;四季度&#x27;</span>,<span class="number">450</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_temp;</span><br></pre></td></tr></table></figure>



<h2 id="MySQL行转列"><a href="#MySQL行转列" class="headerlink" title="MySQL行转列"></a>MySQL行转列</h2><p>MySQL行转列又叫做<strong>数据透视</strong>。什么叫做行转列？将原本横向排列的数据透视成纵向排列的数据，进而进行计算、分析、展示等操作。</p>
<p>假设有一个学生选课成绩表，包含学生姓名（stu_name）、课程名称（course_name）和分数（score）三个字段。在原始数据中，每个学生在不同的课程中都有自己的得分情况，数据样例如下：</p>
<table>
<thead>
<tr>
<th>stu_name</th>
<th>course_name</th>
<th>score</th>
</tr>
</thead>
<tbody><tr>
<td>张三</td>
<td>数学</td>
<td>80</td>
</tr>
<tr>
<td>张三</td>
<td>英语</td>
<td>85</td>
</tr>
<tr>
<td>张三</td>
<td>历史</td>
<td>90</td>
</tr>
<tr>
<td>李四</td>
<td>数学</td>
<td>75</td>
</tr>
<tr>
<td>李四</td>
<td>英语</td>
<td>92</td>
</tr>
<tr>
<td>李四</td>
<td>历史</td>
<td>85</td>
</tr>
<tr>
<td>王五</td>
<td>数学</td>
<td>88</td>
</tr>
<tr>
<td>王五</td>
<td>英语</td>
<td>90</td>
</tr>
<tr>
<td>王五</td>
<td>历史</td>
<td>95</td>
</tr>
</tbody></table>
<p>可以使用行转列操作，将每个学生在不同课程中的分数拆分成多条记录，每条记录包含一个课程以及对应的分数。转换后的数据样例如下：</p>
<table>
<thead>
<tr>
<th>stu_name</th>
<th>数学</th>
<th>英语</th>
<th>历史</th>
</tr>
</thead>
<tbody><tr>
<td>张三</td>
<td>80</td>
<td>85</td>
<td>90</td>
</tr>
<tr>
<td>李四</td>
<td>75</td>
<td>92</td>
<td>85</td>
</tr>
<tr>
<td>王五</td>
<td>88</td>
<td>90</td>
<td>95</td>
</tr>
</tbody></table>
<p>从上表中可以看出，在行转列之后，每一行记录都表示了一个学生在不同课程中的分数。这样更便于对不同科目的分数进行比较、计算平均值等分析操作。</p>
<h3 id="使用case-when-group-by完成"><a href="#使用case-when-group-by完成" class="headerlink" title="使用case when+group by完成"></a>使用case when+group by完成</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t_student;</span><br><span class="line"><span class="keyword">create table</span> t_student(</span><br><span class="line">  stu_name <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">  course_name <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">  score <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="number">85</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;历史&#x27;</span>, <span class="number">90</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="number">75</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="number">92</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;历史&#x27;</span>, <span class="number">85</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="number">88</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>, <span class="number">90</span>);</span><br><span class="line"><span class="keyword">insert into</span> t_student(stu_name, course_name, score) <span class="keyword">values</span>(<span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;历史&#x27;</span>, <span class="number">95</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br></pre></td></tr></table></figure>
<p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688106054073-451f919c-a97a-4c49-af03-991c86d78107.png#averageHue&#x3D;%23f5f3f2&amp;clientId&#x3D;u5ffc187d-9c9e-4&amp;from&#x3D;paste&amp;height&#x3D;297&amp;id&#x3D;u9e9bf1f5&amp;originHeight&#x3D;297&amp;originWidth&#x3D;362&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;16318&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u17210bc5-00ed-4815-96ea-db8ea540918&amp;title&#x3D;&amp;width&#x3D;362)<br>行转列后的效果是：<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688106114109-3c583e45-5324-47f7-b53c-f90e31dcdc82.png#averageHue&#x3D;%23d8ad68&amp;clientId&#x3D;u5ffc187d-9c9e-4&amp;from&#x3D;paste&amp;height&#x3D;107&amp;id&#x3D;u69df24d2&amp;originHeight&#x3D;107&amp;originWidth&#x3D;337&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;4879&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u712979ed-c054-40d3-97fe-a85e23959e9&amp;title&#x3D;&amp;width&#x3D;337)<br>sql如下：</p>
<p>当course_name为数学时输出成绩，否则都输出0，然后输出最大值，就筛选出来了，列的名字都是后面起名字获得</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">	stu_name,</span><br><span class="line">	<span class="built_in">max</span>(<span class="keyword">case</span> course_name <span class="keyword">when</span> <span class="string">&#x27;数学&#x27;</span> <span class="keyword">then</span> score <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">&#x27;数学&#x27;</span>,</span><br><span class="line">	<span class="built_in">max</span>(<span class="keyword">case</span> course_name <span class="keyword">when</span> <span class="string">&#x27;英语&#x27;</span> <span class="keyword">then</span> score <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">&#x27;英语&#x27;</span>, </span><br><span class="line">	<span class="built_in">max</span>(<span class="keyword">case</span> course_name <span class="keyword">when</span> <span class="string">&#x27;历史&#x27;</span> <span class="keyword">then</span> score <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">&#x27;历史&#x27;</span> </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">	t_student</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">	stu_name;</span><br></pre></td></tr></table></figure>

<p>通过以上内容的学习，我们这个面试题就迎刃而解了：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">	<span class="keyword">year</span>,</span><br><span class="line">	<span class="built_in">max</span>(<span class="keyword">case</span> season <span class="keyword">when</span> <span class="string">&#x27;一季度&#x27;</span> <span class="keyword">then</span> count <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">&#x27;一季度&#x27;</span>,</span><br><span class="line">	<span class="built_in">max</span>(<span class="keyword">case</span> season <span class="keyword">when</span> <span class="string">&#x27;二季度&#x27;</span> <span class="keyword">then</span> count <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">&#x27;二季度&#x27;</span>,</span><br><span class="line">	<span class="built_in">max</span>(<span class="keyword">case</span> season <span class="keyword">when</span> <span class="string">&#x27;三季度&#x27;</span> <span class="keyword">then</span> count <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">&#x27;三季度&#x27;</span>,</span><br><span class="line">	<span class="built_in">max</span>(<span class="keyword">case</span> season <span class="keyword">when</span> <span class="string">&#x27;四季度&#x27;</span> <span class="keyword">then</span> count <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">&#x27;四季度&#x27;</span></span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">	t_temp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">	<span class="keyword">year</span>;</span><br></pre></td></tr></table></figure>
<p>![](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1692002570088-3338946f-42b3-4174-8910-7e749c31e950.jpeg?x-oss-process&#x3D;image%2Fresize%2Cw_1177%2Climit_0%2Finterlace%2C1%2Finterlace%2C1#averageHue&#x3D;%23f9f8f8&amp;from&#x3D;url&amp;id&#x3D;wulES&amp;originHeight&#x3D;66&amp;originWidth&#x3D;1177&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;title&#x3D;)</p>
<h1 id="第十题"><a href="#第十题" class="headerlink" title="第十题"></a>第十题</h1><p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1680403550525-8f28573a-a583-4aaa-9e91-b5dde5ffa2f3.png#averageHue&#x3D;%23909092&amp;clientId&#x3D;u170b2320-f065-4&amp;from&#x3D;paste&amp;height&#x3D;424&amp;id&#x3D;YlEzc&amp;originHeight&#x3D;424&amp;originWidth&#x3D;578&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;224946&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uce0f516b-9d95-40ed-bd7a-e9dfc0c9591&amp;title&#x3D;&amp;width&#x3D;578)</p>
<p>建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t;</span><br><span class="line"><span class="keyword">create table</span> t(</span><br><span class="line">	A <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span>(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span>(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span>(<span class="number">6</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span>(<span class="number">7</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span>(<span class="number">8</span>);</span><br><span class="line"><span class="keyword">insert into</span> t <span class="keyword">values</span>(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>



<p>答案：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a,(<span class="built_in">lag</span>(a) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> a)) <span class="keyword">as</span> per_a <span class="keyword">from</span> t;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">将以上sql语句执行结果当做临时表m，上面的表对比a可以发现规律</span></span><br><span class="line"><span class="comment">筛选条件：m.a-m.per_a &lt;&gt; 1 or m.pre_a is null </span></span><br><span class="line"><span class="comment">执行完就是左边的a表为135，右表可以先用row_number生成123</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">select</span> m.a,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> m.a)<span class="keyword">as</span> rownum <span class="keyword">from</span> (<span class="keyword">select</span> a,(<span class="built_in">lag</span>(a) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> a)) <span class="keyword">as</span> per_a <span class="keyword">from</span> t) m <span class="keyword">where</span> m.a<span class="operator">-</span>m.per_a <span class="operator">&lt;&gt;</span> <span class="number">1</span> <span class="keyword">or</span> m.per_a <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> a,(<span class="built_in">lead</span>(a) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> a)) <span class="keyword">as</span> pre_a <span class="keyword">from</span> t;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">将以上sql查询结果当做临时表n，这个规律可以借鉴上面的，后减前</span></span><br><span class="line"><span class="comment">筛选条件：n.pre_a - n.a &lt;&gt; 1 or n.pre_a is null</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">select</span> n.a,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> n.a) <span class="keyword">as</span> rownum <span class="keyword">from</span> (<span class="keyword">select</span> a,(<span class="built_in">lead</span>(a) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> a)) <span class="keyword">as</span> pre_a <span class="keyword">from</span> t) n <span class="keyword">where</span> n.pre_a <span class="operator">-</span> n.a <span class="operator">&lt;&gt;</span> <span class="number">1</span> <span class="keyword">or</span> n.pre_a <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">将以上两个最终的查询结果看做两张表：x和y </span></span><br><span class="line"><span class="comment">连接条件：x.rownum=y.rownum </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">select</span> x.a <span class="keyword">as</span> 开始数字,y.a <span class="keyword">as</span> 结束数字</span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> m.a,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> m.a)<span class="keyword">as</span> rownum <span class="keyword">from</span> (<span class="keyword">select</span> a,(<span class="built_in">lag</span>(a) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> a)) <span class="keyword">as</span> per_a <span class="keyword">from</span> t) m <span class="keyword">where</span> m.a<span class="operator">-</span>m.per_a <span class="operator">&lt;&gt;</span> <span class="number">1</span> <span class="keyword">or</span> m.per_a <span class="keyword">is</span> <span class="keyword">null</span>) x </span><br><span class="line"><span class="keyword">join</span> (<span class="keyword">select</span> n.a,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> n.a) <span class="keyword">as</span> rownum <span class="keyword">from</span> (<span class="keyword">select</span> a,(<span class="built_in">lead</span>(a) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> a)) <span class="keyword">as</span> pre_a <span class="keyword">from</span> t) n <span class="keyword">where</span> n.pre_a <span class="operator">-</span> n.a <span class="operator">&lt;&gt;</span> <span class="number">1</span> <span class="keyword">or</span> n.pre_a <span class="keyword">is</span> <span class="keyword">null</span>) y </span><br><span class="line"><span class="keyword">on</span> x.rownum<span class="operator">=</span>y.rownum;</span><br></pre></td></tr></table></figure>
<p>解答上面这个题目需要具备以下知识点：</p>
<ul>
<li>lag函数</li>
<li>lead函数</li>
<li>row_number函数</li>
</ul>
<p><strong>lag函数</strong>：获取当前行的上一行数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename,sal,(<span class="built_in">lag</span>(sal) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">asc</span>)) <span class="keyword">as</span> pre_sal <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688354808296-69cf1cf1-34e3-4b99-b4a2-2c575b0e2378.png#averageHue&#x3D;%23d8a762&amp;clientId&#x3D;ub653133f-848a-4&amp;from&#x3D;paste&amp;height&#x3D;344&amp;id&#x3D;u978c2e7e&amp;originHeight&#x3D;344&amp;originWidth&#x3D;327&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;16336&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u52f42846-9936-4b59-9c02-e28399e5d6b&amp;title&#x3D;&amp;width&#x3D;327)<br>注意：over函数用来指定“在…..范围内”，通常和lag函数联用。</p>
<p><strong>lead函数</strong>：获取当前行的下一行数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename,sal,(<span class="built_in">lead</span>(sal) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">asc</span>)) <span class="keyword">as</span> next_sal <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688355552758-57bb77a0-65d4-4717-8410-35c1f6c13e0e.png#averageHue&#x3D;%23d7a864&amp;clientId&#x3D;ub653133f-848a-4&amp;from&#x3D;paste&amp;height&#x3D;343&amp;id&#x3D;u0d08f238&amp;originHeight&#x3D;343&amp;originWidth&#x3D;329&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;16211&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u50f77934-4edb-48ad-bf11-7d04a74c054&amp;title&#x3D;&amp;width&#x3D;329)<br>注意：over函数用来指定“在…..范围内”，通常和lead函数联用。</p>
<p><strong>row_number函数</strong>：可以为查询结果集生成行号：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename,sal,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> sal) <span class="keyword">as</span> rownum <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688372778734-b8b7d759-d86d-43d5-807a-8447c8de7da4.png#averageHue&#x3D;%23d7a763&amp;clientId&#x3D;ub653133f-848a-4&amp;from&#x3D;paste&amp;height&#x3D;339&amp;id&#x3D;u33ad221d&amp;originHeight&#x3D;339&amp;originWidth&#x3D;321&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;15785&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;ue2446e9a-2f9b-477d-ac3d-9750607746e&amp;title&#x3D;&amp;width&#x3D;321)</p>
<p>利用row_number函数，将两个不相关的列拼接在一起显示：<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688372898512-55c19a9b-401d-49db-8ad3-10e64b2fc161.png#averageHue&#x3D;%23f5f4f4&amp;clientId&#x3D;ub653133f-848a-4&amp;from&#x3D;paste&amp;height&#x3D;157&amp;id&#x3D;u7722567c&amp;originHeight&#x3D;157&amp;originWidth&#x3D;320&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;6920&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;ueb29a45f-3cd8-425f-abe2-44a5d1f2562&amp;title&#x3D;&amp;width&#x3D;320)<br>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688372915619-8c9bb2e9-7023-43e7-88f1-ca17090825f0.png#averageHue&#x3D;%23f5f4f3&amp;clientId&#x3D;ub653133f-848a-4&amp;from&#x3D;paste&amp;height&#x3D;162&amp;id&#x3D;uec70c452&amp;originHeight&#x3D;162&amp;originWidth&#x3D;320&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;7053&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u1451081a-dda0-4561-a99e-c924529106b&amp;title&#x3D;&amp;width&#x3D;320)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">	x.a, y.b </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">	(<span class="keyword">select</span> a,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> a) <span class="keyword">as</span> rownum <span class="keyword">from</span> t1) x </span><br><span class="line"><span class="keyword">join</span> </span><br><span class="line">	(<span class="keyword">select</span> b,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> b) <span class="keyword">as</span> rownum <span class="keyword">from</span> t2) y </span><br><span class="line"><span class="keyword">on</span> </span><br><span class="line">	x.rownum <span class="operator">=</span> y.rownum;</span><br></pre></td></tr></table></figure>
<p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688373063344-4437fa76-e5b6-4747-b189-9c3ae2ace4c0.png#averageHue&#x3D;%23d0a25e&amp;clientId&#x3D;ub653133f-848a-4&amp;from&#x3D;paste&amp;height&#x3D;97&amp;id&#x3D;udf41357f&amp;originHeight&#x3D;97&amp;originWidth&#x3D;169&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;1520&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;u538f43c4-e174-4c86-bd55-b7ee900cf9f&amp;title&#x3D;&amp;width&#x3D;169)</p>
<p>CTE语法（公用表表达式）：Common Table Expression。创建临时表的一种语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询每个部门平均工资的工资等级</span></span><br><span class="line"><span class="comment">-- 第一种写法</span></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	t.deptno,t.avgsal,s.grade </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">	(<span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">as</span> avgsal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno) t </span><br><span class="line"><span class="keyword">join</span> </span><br><span class="line">	salgrade s </span><br><span class="line"><span class="keyword">on</span> </span><br><span class="line">	t.avgsal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第二种写法：使用CTE语法</span></span><br><span class="line"><span class="keyword">with</span> cte_exp <span class="keyword">as</span>(<span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">as</span> avgsal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno)</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">	cte_exp.deptno,cte_exp.avgsal,s.grade</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">	cte_exp</span><br><span class="line"><span class="keyword">join</span></span><br><span class="line">	salgrade s</span><br><span class="line"><span class="keyword">on</span></span><br><span class="line">	cte_exp.avgsal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br></pre></td></tr></table></figure>

<p>partition by：将数据分区，和group by区别是：group by是分组，然后和分组函数一起用。partition by分区不需要和分组函数一起使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno, empno,ename,sal,(<span class="built_in">lag</span>(sal) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> deptno <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">asc</span>)) <span class="keyword">as</span> pre_sal <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p>![image.png](.&#x2F;images&#x2F;第11章 企业真题&#x2F;1688355470071-e5e90e50-2b69-4126-bd79-a2118fb80e66.png#averageHue&#x3D;%23f7f5f1&amp;clientId&#x3D;ub653133f-848a-4&amp;from&#x3D;paste&amp;height&#x3D;346&amp;id&#x3D;u1ce2bd86&amp;originHeight&#x3D;346&amp;originWidth&#x3D;421&amp;originalType&#x3D;binary&amp;ratio&#x3D;1&amp;rotation&#x3D;0&amp;showTitle&#x3D;false&amp;size&#x3D;20420&amp;status&#x3D;done&amp;style&#x3D;shadow&amp;taskId&#x3D;uf20a1c61-b9cb-47d4-a110-070aa47ecc4&amp;title&#x3D;&amp;width&#x3D;421)</p>
<p>MySQL 8.0及以上版本中支持如下常用的窗口函数：</p>
<ol>
<li>ROW_NUMBER()：排名函数，返回当前结果集中每个行的行号；</li>
<li>RANK()：排名函数，计算分组结果中的排名，相同的行排名相同且没有空缺，下一个行排名跳过空缺；</li>
<li>DENSE_RANK()：排名函数，计算分组结果中的排名，相同的行排名相同，排名连续，没有空缺；</li>
<li>NTILE()：将分组结果等分为指定的组数，计算每组的大小；</li>
<li>LAG()：返回分组内前一行的值；</li>
<li>LEAD()：返回分组内后一行的值；</li>
<li>FIRST_VALUE()：返回分组内第一个值；</li>
<li>LAST_VALUE()：返回分组内最后一个值；</li>
<li>AVG()、SUM()、COUNT()、MIN()、MAX()：聚合函数，可以配合OVER()进行窗口操作。</li>
</ol>
<p>需要注意的是，MySQL的窗口函数和其他DBMS中的窗口函数相比较，可能略有不同，需要根据MySQL的文档进行使用。 </p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/Shelter67">Shelter</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://localhost:4000/posts/4fe508cd.html">http://localhost:4000/posts/4fe508cd.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://localhost:4000" target="_blank">Shelter</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/sql-Java/">sql Java</a></div><div class="post-share"><div class="social-share" data-image="/img/cover/15.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/8fe47ff4.html" title="JDBC"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/13.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">JDBC</div></div><div class="info-2"><div class="info-item-1">第01章 JDBC概述什么是JDBCJDBC（Java DataBase Connectivity）就是Java数据库连接，说白了就是用Java语言来操作数据库。原来我们操作数据库是在控制台使用SQL语句来操作数据库，JDBC是用Java语言向数据库发送SQL语句。  JDBC是一套连接数据库的api，什么是APi？就是平时所说的一套类库，通常包括三项：  API字节码（String.class） API源码（String.java） API帮助文档（String类的帮助文档）  但是要注意查阅的版本要一致。 JDBC原理早期SUN公司的天才们想编写一套可以连接天下所有数据库的API，但是当他们刚刚开始时就发现这是不可完成的任务，因为各个厂商的数据库服务器差异太大了。后来SUN开始与数据库厂商们讨论，最终得出的结论是，由SUN提供一套访问数据库的规范（就是一组接口），并提供连接数据库的协议标准，然后各个数据库厂商会遵循SUN的规范提供一套访问自己公司数据库服务器的API。SUN提供的规范命名为JDBC，而各个厂商提供的，遵循了JDBC规范的，可以访问自己数据库的API被称之为驱动...</div></div></div></a><a class="pagination-related" href="/posts/14ea6df7.html" title="数据库"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">数据库</div></div><div class="info-2"><div class="info-item-1">数据库概述什么是数据库 数据库对应的英文单词是DataBase，简称DB java的端口号：8080，mysql的3306  数据库类型 关系型数据库 关系型数据库是依据关系模型来创建的数据库。所谓关系模型就是“一对一、一对多、多对多”等关系模型   非关系型数据库（NoSQL）  数据库管理系统 数据库管理系统（Database Management System，简称DBMS）是为管理数据库而设计的电脑软件系统，一般具有存储、截取、安全保障、备份等基础功能。 数据库管理系统是数据库系统的核心组成部分，主要完成对数据库的操作与管理功能，实现数据库对象的创建、数据库存储数据的查询、添加、修改与删除操作和数据库的用户管理、权限管理等。 常见的数据库管理系统有：MySQL、Oracle、DB2、MS SQL Server、SQLite、PostgreSQL、Sybase等。  什么是SQL 结构化查询语言（Structured Query Language）简称SQL，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统。 DBMS...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Shelter</div><div class="author-info-description">记录自己的成长日志</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Shelter67"><i class="fab fa-github"></i><span>没有什么star的github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Shelter67" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1830191738@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://space.bilibili.com/8416212" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #fb7299;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的小小博客！都是基于hexo框架使用，魔改了一些地方，表现得有些二次元，有个博客希望能在未来工作简历上成为加分项吧，但是弄起来还真的挺好玩的</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%A2%98"><span class="toc-number">1.</span> <span class="toc-text">第一题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">第二题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text">第三题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E9%A2%98"><span class="toc-number">4.</span> <span class="toc-text">第四题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E9%A2%98"><span class="toc-number">5.</span> <span class="toc-text">第五题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E9%A2%98"><span class="toc-number">6.</span> <span class="toc-text">第六题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E9%A2%98"><span class="toc-number">7.</span> <span class="toc-text">第七题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E9%A2%98"><span class="toc-number">8.</span> <span class="toc-text">第八题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E9%A2%98"><span class="toc-number">9.</span> <span class="toc-text">第九题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E8%A1%8C%E8%BD%AC%E5%88%97"><span class="toc-number">9.1.</span> <span class="toc-text">MySQL行转列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8case-when-group-by%E5%AE%8C%E6%88%90"><span class="toc-number">9.1.1.</span> <span class="toc-text">使用case when+group by完成</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E9%A2%98"><span class="toc-number">10.</span> <span class="toc-text">第十题</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/da77c56c.html" title="MVC架构设计模式"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/14.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MVC架构设计模式"/></a><div class="content"><a class="title" href="/posts/da77c56c.html" title="MVC架构设计模式">MVC架构设计模式</a><time datetime="2026-11-14T16:24:00.000Z" title="发表于 2026-11-15 00:24:00">2026-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e25feb6e.html" title="黑马程序员SSM"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="黑马程序员SSM"/></a><div class="content"><a class="title" href="/posts/e25feb6e.html" title="黑马程序员SSM">黑马程序员SSM</a><time datetime="2026-02-03T03:14:00.000Z" title="发表于 2026-02-03 11:14:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/eedaddf.html" title="博客笔记"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="博客笔记"/></a><div class="content"><a class="title" href="/posts/eedaddf.html" title="博客笔记">博客笔记</a><time datetime="2026-02-03T02:50:00.000Z" title="发表于 2026-02-03 10:50:00">2026-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4a17b156.html" title="Hello World"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/12.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/posts/4a17b156.html" title="Hello World">Hello World</a><time datetime="2026-01-27T19:22:37.883Z" title="发表于 2026-01-28 03:22:37">2026-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/d2dc75e3.html" title="老杜MyBatis"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/cover/3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="老杜MyBatis"/></a><div class="content"><a class="title" href="/posts/d2dc75e3.html" title="老杜MyBatis">老杜MyBatis</a><time datetime="2025-12-09T19:12:00.000Z" title="发表于 2025-12-10 03:12:00">2025-12-10</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By Shelter</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><script src="/js/tw_cn.js?v=5.5.4"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"></div><script src="https://fastly.jsdelivr.net/npm/live2d-widgets@1.0.0/dist/autoload.js"></script><div class="aplayer no-destroy" data-id="435010695" data-server="netease" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-autoplay="false" data-mutex="true" ></div><script id="canvas_nest" defer="defer" color="255,192,203" opacity="0" zIndex="-1" count="80" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/metingjs/dist/Meting.min.js"></script><div id="app-refresh" style="position: fixed; top: -2.2rem; left: 0; right: 0; z-index: 99999; padding: 0 1rem; font-size: 15px; height: 2.2rem; transition: all 0.3s ease;"><div class="app-refresh-wrap" style="display: flex; color: #fff; height: 100%; align-items: center; justify-content: center;"><label>🚀 有新内容发布啦！</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color: #fff; text-decoration: underline; cursor: pointer; margin-left: 8px;">点击刷新</span></a></div></div><script>if ('serviceWorker' in navigator) {
  // 如果当前页面受 Service Worker 控制，监听控制权变化
  if (navigator.serviceWorker.controller) {
    navigator.serviceWorker.addEventListener('controllerchange', function() {
      showNotification();
    });
  }

  // 页面加载完成后注册 sw.js
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js').catch(err => {
      console.error('PWA 注册失败:', err);
    });
  });
}

function showNotification() {
  // 优先使用主题自带的 Snackbar 弹窗
  if (window.GLOBAL_CONFIG && GLOBAL_CONFIG.Snackbar) {
    var snackbarBg = document.documentElement.getAttribute('data-theme') === 'light' ?
      GLOBAL_CONFIG.Snackbar.bgLight :
      GLOBAL_CONFIG.Snackbar.bgDark;
    
    var snackbarPos = GLOBAL_CONFIG.Snackbar.position;

    Snackbar.show({
      text: '🚀 有新文章发布啦！',
      backgroundColor: snackbarBg,
      duration: 10000, // 持续 10 秒
      pos: snackbarPos,
      actionText: '点击刷新',
      actionTextColor: '#fff',
      onActionClick: function(e) {
        location.reload();
      },
    });
  } else {
    // 如果没有 Snackbar，则显示顶部的 app-refresh 栏
    var showBg = document.documentElement.getAttribute('data-theme') === 'light' ? '#49b1f5' : '#1f1f1f';
    var appRefresh = document.getElementById('app-refresh');
    if (appRefresh) {
      appRefresh.style.cssText = 'top: 0; background: ' + showBg + ';';
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索点什么呢………" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>